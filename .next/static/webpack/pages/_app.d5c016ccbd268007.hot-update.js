"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("pages/_app",{

/***/ "./node_modules/@dfinity/agent/lib/esm/actor.js":
/*!******************************************************!*\
  !*** ./node_modules/@dfinity/agent/lib/esm/actor.js ***!
  \******************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ACTOR_METHOD_WITH_HTTP_DETAILS: function() { return /* binding */ ACTOR_METHOD_WITH_HTTP_DETAILS; },\n/* harmony export */   Actor: function() { return /* binding */ Actor; },\n/* harmony export */   ActorCallError: function() { return /* binding */ ActorCallError; },\n/* harmony export */   QueryCallRejectedError: function() { return /* binding */ QueryCallRejectedError; },\n/* harmony export */   UpdateCallRejectedError: function() { return /* binding */ UpdateCallRejectedError; },\n/* harmony export */   getManagementCanister: function() { return /* binding */ getManagementCanister; }\n/* harmony export */ });\n/* harmony import */ var buffer___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! buffer/ */ \"./node_modules/buffer/index.js\");\n/* harmony import */ var _agent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./agent */ \"./node_modules/@dfinity/agent/lib/esm/agent/index.js\");\n/* harmony import */ var _errors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./errors */ \"./node_modules/@dfinity/agent/lib/esm/errors.js\");\n/* harmony import */ var _dfinity_candid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dfinity/candid */ \"./node_modules/@dfinity/candid/lib/esm/index.js\");\n/* harmony import */ var _polling__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./polling */ \"./node_modules/@dfinity/agent/lib/esm/polling/index.js\");\n/* harmony import */ var _dfinity_principal__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dfinity/principal */ \"./node_modules/@dfinity/principal/lib/esm/index.js\");\n/* harmony import */ var _utils_buffer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./utils/buffer */ \"./node_modules/@dfinity/agent/lib/esm/utils/buffer.js\");\n/* harmony import */ var _canisters_management_idl__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./canisters/management_idl */ \"./node_modules/@dfinity/agent/lib/esm/canisters/management_idl.js\");\n\n\n\n\n\n\n\n\nclass ActorCallError extends _errors__WEBPACK_IMPORTED_MODULE_2__.AgentError {\n    constructor(canisterId, methodName, type, props) {\n        super([\n            `Call failed:`,\n            `  Canister: ${canisterId.toText()}`,\n            `  Method: ${methodName} (${type})`,\n            ...Object.getOwnPropertyNames(props).map(n => `  \"${n}\": ${JSON.stringify(props[n])}`),\n        ].join('\\n'));\n        this.canisterId = canisterId;\n        this.methodName = methodName;\n        this.type = type;\n        this.props = props;\n    }\n}\nclass QueryCallRejectedError extends ActorCallError {\n    constructor(canisterId, methodName, result) {\n        var _a;\n        super(canisterId, methodName, 'query', {\n            Status: result.status,\n            Code: (_a = _agent__WEBPACK_IMPORTED_MODULE_1__.ReplicaRejectCode[result.reject_code]) !== null && _a !== void 0 ? _a : `Unknown Code \"${result.reject_code}\"`,\n            Message: result.reject_message,\n        });\n        this.result = result;\n    }\n}\nclass UpdateCallRejectedError extends ActorCallError {\n    constructor(canisterId, methodName, requestId, response) {\n        super(canisterId, methodName, 'update', Object.assign({ 'Request ID': (0,_utils_buffer__WEBPACK_IMPORTED_MODULE_6__.toHex)(requestId) }, (response.body\n            ? Object.assign(Object.assign({}, (response.body.error_code\n                ? {\n                    'Error code': response.body.error_code,\n                }\n                : {})), { 'Reject code': String(response.body.reject_code), 'Reject message': response.body.reject_message }) : {\n            'HTTP status code': response.status.toString(),\n            'HTTP status text': response.statusText,\n        })));\n        this.requestId = requestId;\n        this.response = response;\n    }\n}\nconst metadataSymbol = Symbol.for('ic-agent-metadata');\n/**\n * An actor base class. An actor is an object containing only functions that will\n * return a promise. These functions are derived from the IDL definition.\n */\nclass Actor {\n    constructor(metadata) {\n        this[metadataSymbol] = Object.freeze(metadata);\n    }\n    /**\n     * Get the Agent class this Actor would call, or undefined if the Actor would use\n     * the default agent (global.ic.agent).\n     * @param actor The actor to get the agent of.\n     */\n    static agentOf(actor) {\n        return actor[metadataSymbol].config.agent;\n    }\n    /**\n     * Get the interface of an actor, in the form of an instance of a Service.\n     * @param actor The actor to get the interface of.\n     */\n    static interfaceOf(actor) {\n        return actor[metadataSymbol].service;\n    }\n    static canisterIdOf(actor) {\n        return _dfinity_principal__WEBPACK_IMPORTED_MODULE_5__.Principal.from(actor[metadataSymbol].config.canisterId);\n    }\n    static async install(fields, config) {\n        const mode = fields.mode === undefined ? { install: null } : fields.mode;\n        // Need to transform the arg into a number array.\n        const arg = fields.arg ? [...new Uint8Array(fields.arg)] : [];\n        // Same for module.\n        const wasmModule = [...new Uint8Array(fields.module)];\n        const canisterId = typeof config.canisterId === 'string'\n            ? _dfinity_principal__WEBPACK_IMPORTED_MODULE_5__.Principal.fromText(config.canisterId)\n            : config.canisterId;\n        await getManagementCanister(config).install_code({\n            mode,\n            arg,\n            wasm_module: wasmModule,\n            canister_id: canisterId,\n            sender_canister_version: [],\n        });\n    }\n    static async createCanister(config, settings) {\n        function settingsToCanisterSettings(settings) {\n            return [\n                {\n                    controllers: settings.controllers ? [settings.controllers] : [],\n                    compute_allocation: settings.compute_allocation ? [settings.compute_allocation] : [],\n                    freezing_threshold: settings.freezing_threshold ? [settings.freezing_threshold] : [],\n                    memory_allocation: settings.memory_allocation ? [settings.memory_allocation] : [],\n                    reserved_cycles_limit: [],\n                    log_visibility: [],\n                    wasm_memory_limit: [],\n                },\n            ];\n        }\n        const { canister_id: canisterId } = await getManagementCanister(config || {}).provisional_create_canister_with_cycles({\n            amount: [],\n            settings: settingsToCanisterSettings(settings || {}),\n            specified_id: [],\n            sender_canister_version: [],\n        });\n        return canisterId;\n    }\n    static async createAndInstallCanister(interfaceFactory, fields, config) {\n        const canisterId = await this.createCanister(config);\n        await this.install(Object.assign({}, fields), Object.assign(Object.assign({}, config), { canisterId }));\n        return this.createActor(interfaceFactory, Object.assign(Object.assign({}, config), { canisterId }));\n    }\n    static createActorClass(interfaceFactory, options) {\n        const service = interfaceFactory({ IDL: _dfinity_candid__WEBPACK_IMPORTED_MODULE_3__.IDL });\n        class CanisterActor extends Actor {\n            constructor(config) {\n                if (!config.canisterId)\n                    throw new _errors__WEBPACK_IMPORTED_MODULE_2__.AgentError(`Canister ID is required, but received ${typeof config.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);\n                const canisterId = typeof config.canisterId === 'string'\n                    ? _dfinity_principal__WEBPACK_IMPORTED_MODULE_5__.Principal.fromText(config.canisterId)\n                    : config.canisterId;\n                super({\n                    config: Object.assign(Object.assign(Object.assign({}, DEFAULT_ACTOR_CONFIG), config), { canisterId }),\n                    service,\n                });\n                for (const [methodName, func] of service._fields) {\n                    if (options === null || options === void 0 ? void 0 : options.httpDetails) {\n                        func.annotations.push(ACTOR_METHOD_WITH_HTTP_DETAILS);\n                    }\n                    this[methodName] = _createActorMethod(this, methodName, func, config.blsVerify);\n                }\n            }\n        }\n        return CanisterActor;\n    }\n    static createActor(interfaceFactory, configuration) {\n        if (!configuration.canisterId) {\n            throw new _errors__WEBPACK_IMPORTED_MODULE_2__.AgentError(`Canister ID is required, but received ${typeof configuration.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);\n        }\n        return new (this.createActorClass(interfaceFactory))(configuration);\n    }\n    static createActorWithHttpDetails(interfaceFactory, configuration) {\n        return new (this.createActorClass(interfaceFactory, { httpDetails: true }))(configuration);\n    }\n}\n// IDL functions can have multiple return values, so decoding always\n// produces an array. Ensure that functions with single or zero return\n// values behave as expected.\nfunction decodeReturnValue(types, msg) {\n    const returnValues = _dfinity_candid__WEBPACK_IMPORTED_MODULE_3__.IDL.decode(types, buffer___WEBPACK_IMPORTED_MODULE_0__.Buffer.from(msg));\n    switch (returnValues.length) {\n        case 0:\n            return undefined;\n        case 1:\n            return returnValues[0];\n        default:\n            return returnValues;\n    }\n}\nconst DEFAULT_ACTOR_CONFIG = {\n    pollingStrategyFactory: _polling__WEBPACK_IMPORTED_MODULE_4__.strategy.defaultStrategy,\n};\nconst ACTOR_METHOD_WITH_HTTP_DETAILS = 'http-details';\nfunction _createActorMethod(actor, methodName, func, blsVerify) {\n    let caller;\n    if (func.annotations.includes('query') || func.annotations.includes('composite_query')) {\n        caller = async (options, ...args) => {\n            var _a, _b;\n            // First, if there's a config transformation, call it.\n            options = Object.assign(Object.assign({}, options), (_b = (_a = actor[metadataSymbol].config).queryTransform) === null || _b === void 0 ? void 0 : _b.call(_a, methodName, args, Object.assign(Object.assign({}, actor[metadataSymbol].config), options)));\n            const agent = options.agent || actor[metadataSymbol].config.agent || (0,_agent__WEBPACK_IMPORTED_MODULE_1__.getDefaultAgent)();\n            const cid = _dfinity_principal__WEBPACK_IMPORTED_MODULE_5__.Principal.from(options.canisterId || actor[metadataSymbol].config.canisterId);\n            const arg = _dfinity_candid__WEBPACK_IMPORTED_MODULE_3__.IDL.encode(func.argTypes, args);\n            const result = await agent.query(cid, {\n                methodName,\n                arg,\n                effectiveCanisterId: options.effectiveCanisterId,\n            });\n            switch (result.status) {\n                case \"rejected\" /* QueryResponseStatus.Rejected */:\n                    throw new QueryCallRejectedError(cid, methodName, result);\n                case \"replied\" /* QueryResponseStatus.Replied */:\n                    return func.annotations.includes(ACTOR_METHOD_WITH_HTTP_DETAILS)\n                        ? {\n                            httpDetails: result.httpDetails,\n                            result: decodeReturnValue(func.retTypes, result.reply.arg),\n                        }\n                        : decodeReturnValue(func.retTypes, result.reply.arg);\n            }\n        };\n    }\n    else {\n        caller = async (options, ...args) => {\n            var _a, _b;\n            // First, if there's a config transformation, call it.\n            options = Object.assign(Object.assign({}, options), (_b = (_a = actor[metadataSymbol].config).callTransform) === null || _b === void 0 ? void 0 : _b.call(_a, methodName, args, Object.assign(Object.assign({}, actor[metadataSymbol].config), options)));\n            const agent = options.agent || actor[metadataSymbol].config.agent || (0,_agent__WEBPACK_IMPORTED_MODULE_1__.getDefaultAgent)();\n            const { canisterId, effectiveCanisterId, pollingStrategyFactory } = Object.assign(Object.assign(Object.assign({}, DEFAULT_ACTOR_CONFIG), actor[metadataSymbol].config), options);\n            const cid = _dfinity_principal__WEBPACK_IMPORTED_MODULE_5__.Principal.from(canisterId);\n            const ecid = effectiveCanisterId !== undefined ? _dfinity_principal__WEBPACK_IMPORTED_MODULE_5__.Principal.from(effectiveCanisterId) : cid;\n            const arg = _dfinity_candid__WEBPACK_IMPORTED_MODULE_3__.IDL.encode(func.argTypes, args);\n            const { requestId, response } = await agent.call(cid, {\n                methodName,\n                arg,\n                effectiveCanisterId: ecid,\n            });\n            if (!response.ok || response.body /* IC-1462 */) {\n                throw new UpdateCallRejectedError(cid, methodName, requestId, response);\n            }\n            const pollStrategy = pollingStrategyFactory();\n            const responseBytes = await (0,_polling__WEBPACK_IMPORTED_MODULE_4__.pollForResponse)(agent, ecid, requestId, pollStrategy, blsVerify);\n            const shouldIncludeHttpDetails = func.annotations.includes(ACTOR_METHOD_WITH_HTTP_DETAILS);\n            if (responseBytes !== undefined) {\n                return shouldIncludeHttpDetails\n                    ? {\n                        httpDetails: response,\n                        result: decodeReturnValue(func.retTypes, responseBytes),\n                    }\n                    : decodeReturnValue(func.retTypes, responseBytes);\n            }\n            else if (func.retTypes.length === 0) {\n                return shouldIncludeHttpDetails\n                    ? {\n                        httpDetails: response,\n                        result: undefined,\n                    }\n                    : undefined;\n            }\n            else {\n                throw new Error(`Call was returned undefined, but type [${func.retTypes.join(',')}].`);\n            }\n        };\n    }\n    const handler = (...args) => caller({}, ...args);\n    handler.withOptions =\n        (options) => (...args) => caller(options, ...args);\n    return handler;\n}\n/**\n * Create a management canister actor\n * @param config - a CallConfig\n */\nfunction getManagementCanister(config) {\n    function transform(_methodName, args) {\n        if (config.effectiveCanisterId) {\n            return { effectiveCanisterId: _dfinity_principal__WEBPACK_IMPORTED_MODULE_5__.Principal.from(config.effectiveCanisterId) };\n        }\n        const first = args[0];\n        let effectiveCanisterId = _dfinity_principal__WEBPACK_IMPORTED_MODULE_5__.Principal.fromHex('');\n        if (first && typeof first === 'object' && first.canister_id) {\n            effectiveCanisterId = _dfinity_principal__WEBPACK_IMPORTED_MODULE_5__.Principal.from(first.canister_id);\n        }\n        return { effectiveCanisterId };\n    }\n    return Actor.createActor(_canisters_management_idl__WEBPACK_IMPORTED_MODULE_7__[\"default\"], Object.assign(Object.assign(Object.assign({}, config), { canisterId: _dfinity_principal__WEBPACK_IMPORTED_MODULE_5__.Principal.fromHex('') }), {\n        callTransform: transform,\n        queryTransform: transform,\n    }));\n}\n//# sourceMappingURL=actor.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYWdlbnQvbGliL2VzbS9hY3Rvci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFpQztBQUM2QjtBQUN4QjtBQUNBO0FBQ2dCO0FBQ1A7QUFDUjtBQUN3QjtBQUN4RCw2QkFBNkIsK0NBQVU7QUFDOUM7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLG9CQUFvQjtBQUMvQyx5QkFBeUIsWUFBWSxHQUFHLEtBQUs7QUFDN0MsZ0VBQWdFLEVBQUUsS0FBSyx5QkFBeUI7QUFDaEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHFEQUFpQix3RUFBd0UsbUJBQW1CO0FBQ3BJO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQSxnRUFBZ0UsY0FBYyxvREFBSyxhQUFhO0FBQ2hHLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsTUFBTSxrR0FBa0c7QUFDNUg7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx5REFBUztBQUN4QjtBQUNBO0FBQ0EsbURBQW1ELGdCQUFnQjtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx5REFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGdCQUFnQiwwQkFBMEIsMENBQTBDO0FBQ3BGO0FBQ0EsK0RBQStEO0FBQy9EO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMseUNBQXlDLGFBQWEsWUFBWTtBQUM3RyxnRkFBZ0YsYUFBYSxZQUFZO0FBQ3pHO0FBQ0E7QUFDQSwyQ0FBMkMsR0FBRyxvREFBRTtBQUNoRDtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsK0NBQVUsMENBQTBDLDBCQUEwQjtBQUM1RztBQUNBLHNCQUFzQix5REFBUztBQUMvQjtBQUNBO0FBQ0Esd0VBQXdFLG9DQUFvQyxZQUFZO0FBQ3hIO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiwrQ0FBVSwwQ0FBMEMsaUNBQWlDO0FBQzNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOERBQThELG1CQUFtQjtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsZ0RBQUcsZUFBZSwyQ0FBTTtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qiw4Q0FBUTtBQUNwQztBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELHVLQUF1SztBQUMzTixpRkFBaUYsdURBQWU7QUFDaEcsd0JBQXdCLHlEQUFTO0FBQ2pDLHdCQUF3QixnREFBRztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELHNLQUFzSztBQUMxTixpRkFBaUYsdURBQWU7QUFDaEcsb0JBQW9CLDBEQUEwRCw4Q0FBOEM7QUFDNUgsd0JBQXdCLHlEQUFTO0FBQ2pDLDZEQUE2RCx5REFBUztBQUN0RSx3QkFBd0IsZ0RBQUc7QUFDM0Isb0JBQW9CLHNCQUFzQjtBQUMxQztBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MseURBQWU7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEVBQTBFLHdCQUF3QjtBQUNsRztBQUNBO0FBQ0E7QUFDQSwwQ0FBMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBLHFCQUFxQixxQkFBcUIseURBQVM7QUFDbkQ7QUFDQTtBQUNBLGtDQUFrQyx5REFBUztBQUMzQztBQUNBLGtDQUFrQyx5REFBUztBQUMzQztBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLDZCQUE2QixpRUFBcUIsOENBQThDLGFBQWEsWUFBWSx5REFBUyxjQUFjO0FBQ2hKO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYWdlbnQvbGliL2VzbS9hY3Rvci5qcz8zYWNkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJ1ZmZlciB9IGZyb20gJ2J1ZmZlci8nO1xuaW1wb3J0IHsgZ2V0RGVmYXVsdEFnZW50LCBSZXBsaWNhUmVqZWN0Q29kZSwgfSBmcm9tICcuL2FnZW50JztcbmltcG9ydCB7IEFnZW50RXJyb3IgfSBmcm9tICcuL2Vycm9ycyc7XG5pbXBvcnQgeyBJREwgfSBmcm9tICdAZGZpbml0eS9jYW5kaWQnO1xuaW1wb3J0IHsgcG9sbEZvclJlc3BvbnNlLCBzdHJhdGVneSB9IGZyb20gJy4vcG9sbGluZyc7XG5pbXBvcnQgeyBQcmluY2lwYWwgfSBmcm9tICdAZGZpbml0eS9wcmluY2lwYWwnO1xuaW1wb3J0IHsgdG9IZXggfSBmcm9tICcuL3V0aWxzL2J1ZmZlcic7XG5pbXBvcnQgbWFuYWdlbWVudENhbmlzdGVySWRsIGZyb20gJy4vY2FuaXN0ZXJzL21hbmFnZW1lbnRfaWRsJztcbmV4cG9ydCBjbGFzcyBBY3RvckNhbGxFcnJvciBleHRlbmRzIEFnZW50RXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKGNhbmlzdGVySWQsIG1ldGhvZE5hbWUsIHR5cGUsIHByb3BzKSB7XG4gICAgICAgIHN1cGVyKFtcbiAgICAgICAgICAgIGBDYWxsIGZhaWxlZDpgLFxuICAgICAgICAgICAgYCAgQ2FuaXN0ZXI6ICR7Y2FuaXN0ZXJJZC50b1RleHQoKX1gLFxuICAgICAgICAgICAgYCAgTWV0aG9kOiAke21ldGhvZE5hbWV9ICgke3R5cGV9KWAsXG4gICAgICAgICAgICAuLi5PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhwcm9wcykubWFwKG4gPT4gYCAgXCIke259XCI6ICR7SlNPTi5zdHJpbmdpZnkocHJvcHNbbl0pfWApLFxuICAgICAgICBdLmpvaW4oJ1xcbicpKTtcbiAgICAgICAgdGhpcy5jYW5pc3RlcklkID0gY2FuaXN0ZXJJZDtcbiAgICAgICAgdGhpcy5tZXRob2ROYW1lID0gbWV0aG9kTmFtZTtcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgdGhpcy5wcm9wcyA9IHByb3BzO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBRdWVyeUNhbGxSZWplY3RlZEVycm9yIGV4dGVuZHMgQWN0b3JDYWxsRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKGNhbmlzdGVySWQsIG1ldGhvZE5hbWUsIHJlc3VsdCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHN1cGVyKGNhbmlzdGVySWQsIG1ldGhvZE5hbWUsICdxdWVyeScsIHtcbiAgICAgICAgICAgIFN0YXR1czogcmVzdWx0LnN0YXR1cyxcbiAgICAgICAgICAgIENvZGU6IChfYSA9IFJlcGxpY2FSZWplY3RDb2RlW3Jlc3VsdC5yZWplY3RfY29kZV0pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGBVbmtub3duIENvZGUgXCIke3Jlc3VsdC5yZWplY3RfY29kZX1cImAsXG4gICAgICAgICAgICBNZXNzYWdlOiByZXN1bHQucmVqZWN0X21lc3NhZ2UsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnJlc3VsdCA9IHJlc3VsdDtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgVXBkYXRlQ2FsbFJlamVjdGVkRXJyb3IgZXh0ZW5kcyBBY3RvckNhbGxFcnJvciB7XG4gICAgY29uc3RydWN0b3IoY2FuaXN0ZXJJZCwgbWV0aG9kTmFtZSwgcmVxdWVzdElkLCByZXNwb25zZSkge1xuICAgICAgICBzdXBlcihjYW5pc3RlcklkLCBtZXRob2ROYW1lLCAndXBkYXRlJywgT2JqZWN0LmFzc2lnbih7ICdSZXF1ZXN0IElEJzogdG9IZXgocmVxdWVzdElkKSB9LCAocmVzcG9uc2UuYm9keVxuICAgICAgICAgICAgPyBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIChyZXNwb25zZS5ib2R5LmVycm9yX2NvZGVcbiAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgJ0Vycm9yIGNvZGUnOiByZXNwb25zZS5ib2R5LmVycm9yX2NvZGUsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIDoge30pKSwgeyAnUmVqZWN0IGNvZGUnOiBTdHJpbmcocmVzcG9uc2UuYm9keS5yZWplY3RfY29kZSksICdSZWplY3QgbWVzc2FnZSc6IHJlc3BvbnNlLmJvZHkucmVqZWN0X21lc3NhZ2UgfSkgOiB7XG4gICAgICAgICAgICAnSFRUUCBzdGF0dXMgY29kZSc6IHJlc3BvbnNlLnN0YXR1cy50b1N0cmluZygpLFxuICAgICAgICAgICAgJ0hUVFAgc3RhdHVzIHRleHQnOiByZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICB9KSkpO1xuICAgICAgICB0aGlzLnJlcXVlc3RJZCA9IHJlcXVlc3RJZDtcbiAgICAgICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIH1cbn1cbmNvbnN0IG1ldGFkYXRhU3ltYm9sID0gU3ltYm9sLmZvcignaWMtYWdlbnQtbWV0YWRhdGEnKTtcbi8qKlxuICogQW4gYWN0b3IgYmFzZSBjbGFzcy4gQW4gYWN0b3IgaXMgYW4gb2JqZWN0IGNvbnRhaW5pbmcgb25seSBmdW5jdGlvbnMgdGhhdCB3aWxsXG4gKiByZXR1cm4gYSBwcm9taXNlLiBUaGVzZSBmdW5jdGlvbnMgYXJlIGRlcml2ZWQgZnJvbSB0aGUgSURMIGRlZmluaXRpb24uXG4gKi9cbmV4cG9ydCBjbGFzcyBBY3RvciB7XG4gICAgY29uc3RydWN0b3IobWV0YWRhdGEpIHtcbiAgICAgICAgdGhpc1ttZXRhZGF0YVN5bWJvbF0gPSBPYmplY3QuZnJlZXplKG1ldGFkYXRhKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBBZ2VudCBjbGFzcyB0aGlzIEFjdG9yIHdvdWxkIGNhbGwsIG9yIHVuZGVmaW5lZCBpZiB0aGUgQWN0b3Igd291bGQgdXNlXG4gICAgICogdGhlIGRlZmF1bHQgYWdlbnQgKGdsb2JhbC5pYy5hZ2VudCkuXG4gICAgICogQHBhcmFtIGFjdG9yIFRoZSBhY3RvciB0byBnZXQgdGhlIGFnZW50IG9mLlxuICAgICAqL1xuICAgIHN0YXRpYyBhZ2VudE9mKGFjdG9yKSB7XG4gICAgICAgIHJldHVybiBhY3RvclttZXRhZGF0YVN5bWJvbF0uY29uZmlnLmFnZW50O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGludGVyZmFjZSBvZiBhbiBhY3RvciwgaW4gdGhlIGZvcm0gb2YgYW4gaW5zdGFuY2Ugb2YgYSBTZXJ2aWNlLlxuICAgICAqIEBwYXJhbSBhY3RvciBUaGUgYWN0b3IgdG8gZ2V0IHRoZSBpbnRlcmZhY2Ugb2YuXG4gICAgICovXG4gICAgc3RhdGljIGludGVyZmFjZU9mKGFjdG9yKSB7XG4gICAgICAgIHJldHVybiBhY3RvclttZXRhZGF0YVN5bWJvbF0uc2VydmljZTtcbiAgICB9XG4gICAgc3RhdGljIGNhbmlzdGVySWRPZihhY3Rvcikge1xuICAgICAgICByZXR1cm4gUHJpbmNpcGFsLmZyb20oYWN0b3JbbWV0YWRhdGFTeW1ib2xdLmNvbmZpZy5jYW5pc3RlcklkKTtcbiAgICB9XG4gICAgc3RhdGljIGFzeW5jIGluc3RhbGwoZmllbGRzLCBjb25maWcpIHtcbiAgICAgICAgY29uc3QgbW9kZSA9IGZpZWxkcy5tb2RlID09PSB1bmRlZmluZWQgPyB7IGluc3RhbGw6IG51bGwgfSA6IGZpZWxkcy5tb2RlO1xuICAgICAgICAvLyBOZWVkIHRvIHRyYW5zZm9ybSB0aGUgYXJnIGludG8gYSBudW1iZXIgYXJyYXkuXG4gICAgICAgIGNvbnN0IGFyZyA9IGZpZWxkcy5hcmcgPyBbLi4ubmV3IFVpbnQ4QXJyYXkoZmllbGRzLmFyZyldIDogW107XG4gICAgICAgIC8vIFNhbWUgZm9yIG1vZHVsZS5cbiAgICAgICAgY29uc3Qgd2FzbU1vZHVsZSA9IFsuLi5uZXcgVWludDhBcnJheShmaWVsZHMubW9kdWxlKV07XG4gICAgICAgIGNvbnN0IGNhbmlzdGVySWQgPSB0eXBlb2YgY29uZmlnLmNhbmlzdGVySWQgPT09ICdzdHJpbmcnXG4gICAgICAgICAgICA/IFByaW5jaXBhbC5mcm9tVGV4dChjb25maWcuY2FuaXN0ZXJJZClcbiAgICAgICAgICAgIDogY29uZmlnLmNhbmlzdGVySWQ7XG4gICAgICAgIGF3YWl0IGdldE1hbmFnZW1lbnRDYW5pc3Rlcihjb25maWcpLmluc3RhbGxfY29kZSh7XG4gICAgICAgICAgICBtb2RlLFxuICAgICAgICAgICAgYXJnLFxuICAgICAgICAgICAgd2FzbV9tb2R1bGU6IHdhc21Nb2R1bGUsXG4gICAgICAgICAgICBjYW5pc3Rlcl9pZDogY2FuaXN0ZXJJZCxcbiAgICAgICAgICAgIHNlbmRlcl9jYW5pc3Rlcl92ZXJzaW9uOiBbXSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHN0YXRpYyBhc3luYyBjcmVhdGVDYW5pc3Rlcihjb25maWcsIHNldHRpbmdzKSB7XG4gICAgICAgIGZ1bmN0aW9uIHNldHRpbmdzVG9DYW5pc3RlclNldHRpbmdzKHNldHRpbmdzKSB7XG4gICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcnM6IHNldHRpbmdzLmNvbnRyb2xsZXJzID8gW3NldHRpbmdzLmNvbnRyb2xsZXJzXSA6IFtdLFxuICAgICAgICAgICAgICAgICAgICBjb21wdXRlX2FsbG9jYXRpb246IHNldHRpbmdzLmNvbXB1dGVfYWxsb2NhdGlvbiA/IFtzZXR0aW5ncy5jb21wdXRlX2FsbG9jYXRpb25dIDogW10sXG4gICAgICAgICAgICAgICAgICAgIGZyZWV6aW5nX3RocmVzaG9sZDogc2V0dGluZ3MuZnJlZXppbmdfdGhyZXNob2xkID8gW3NldHRpbmdzLmZyZWV6aW5nX3RocmVzaG9sZF0gOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgbWVtb3J5X2FsbG9jYXRpb246IHNldHRpbmdzLm1lbW9yeV9hbGxvY2F0aW9uID8gW3NldHRpbmdzLm1lbW9yeV9hbGxvY2F0aW9uXSA6IFtdLFxuICAgICAgICAgICAgICAgICAgICByZXNlcnZlZF9jeWNsZXNfbGltaXQ6IFtdLFxuICAgICAgICAgICAgICAgICAgICBsb2dfdmlzaWJpbGl0eTogW10sXG4gICAgICAgICAgICAgICAgICAgIHdhc21fbWVtb3J5X2xpbWl0OiBbXSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IGNhbmlzdGVyX2lkOiBjYW5pc3RlcklkIH0gPSBhd2FpdCBnZXRNYW5hZ2VtZW50Q2FuaXN0ZXIoY29uZmlnIHx8IHt9KS5wcm92aXNpb25hbF9jcmVhdGVfY2FuaXN0ZXJfd2l0aF9jeWNsZXMoe1xuICAgICAgICAgICAgYW1vdW50OiBbXSxcbiAgICAgICAgICAgIHNldHRpbmdzOiBzZXR0aW5nc1RvQ2FuaXN0ZXJTZXR0aW5ncyhzZXR0aW5ncyB8fCB7fSksXG4gICAgICAgICAgICBzcGVjaWZpZWRfaWQ6IFtdLFxuICAgICAgICAgICAgc2VuZGVyX2NhbmlzdGVyX3ZlcnNpb246IFtdLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGNhbmlzdGVySWQ7XG4gICAgfVxuICAgIHN0YXRpYyBhc3luYyBjcmVhdGVBbmRJbnN0YWxsQ2FuaXN0ZXIoaW50ZXJmYWNlRmFjdG9yeSwgZmllbGRzLCBjb25maWcpIHtcbiAgICAgICAgY29uc3QgY2FuaXN0ZXJJZCA9IGF3YWl0IHRoaXMuY3JlYXRlQ2FuaXN0ZXIoY29uZmlnKTtcbiAgICAgICAgYXdhaXQgdGhpcy5pbnN0YWxsKE9iamVjdC5hc3NpZ24oe30sIGZpZWxkcyksIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgY29uZmlnKSwgeyBjYW5pc3RlcklkIH0pKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQWN0b3IoaW50ZXJmYWNlRmFjdG9yeSwgT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBjb25maWcpLCB7IGNhbmlzdGVySWQgfSkpO1xuICAgIH1cbiAgICBzdGF0aWMgY3JlYXRlQWN0b3JDbGFzcyhpbnRlcmZhY2VGYWN0b3J5LCBvcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IHNlcnZpY2UgPSBpbnRlcmZhY2VGYWN0b3J5KHsgSURMIH0pO1xuICAgICAgICBjbGFzcyBDYW5pc3RlckFjdG9yIGV4dGVuZHMgQWN0b3Ige1xuICAgICAgICAgICAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFjb25maWcuY2FuaXN0ZXJJZClcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFnZW50RXJyb3IoYENhbmlzdGVyIElEIGlzIHJlcXVpcmVkLCBidXQgcmVjZWl2ZWQgJHt0eXBlb2YgY29uZmlnLmNhbmlzdGVySWR9IGluc3RlYWQuIElmIHlvdSBhcmUgdXNpbmcgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQgZGVjbGFyYXRpb25zLCB0aGlzIG1heSBiZSBiZWNhdXNlIHlvdXIgYXBwbGljYXRpb24gaXMgbm90IHNldHRpbmcgdGhlIGNhbmlzdGVyIElEIGluIHByb2Nlc3MuZW52IGNvcnJlY3RseS5gKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjYW5pc3RlcklkID0gdHlwZW9mIGNvbmZpZy5jYW5pc3RlcklkID09PSAnc3RyaW5nJ1xuICAgICAgICAgICAgICAgICAgICA/IFByaW5jaXBhbC5mcm9tVGV4dChjb25maWcuY2FuaXN0ZXJJZClcbiAgICAgICAgICAgICAgICAgICAgOiBjb25maWcuY2FuaXN0ZXJJZDtcbiAgICAgICAgICAgICAgICBzdXBlcih7XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZzogT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQUNUT1JfQ09ORklHKSwgY29uZmlnKSwgeyBjYW5pc3RlcklkIH0pLFxuICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW21ldGhvZE5hbWUsIGZ1bmNdIG9mIHNlcnZpY2UuX2ZpZWxkcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLmh0dHBEZXRhaWxzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jLmFubm90YXRpb25zLnB1c2goQUNUT1JfTUVUSE9EX1dJVEhfSFRUUF9ERVRBSUxTKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzW21ldGhvZE5hbWVdID0gX2NyZWF0ZUFjdG9yTWV0aG9kKHRoaXMsIG1ldGhvZE5hbWUsIGZ1bmMsIGNvbmZpZy5ibHNWZXJpZnkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gQ2FuaXN0ZXJBY3RvcjtcbiAgICB9XG4gICAgc3RhdGljIGNyZWF0ZUFjdG9yKGludGVyZmFjZUZhY3RvcnksIGNvbmZpZ3VyYXRpb24pIHtcbiAgICAgICAgaWYgKCFjb25maWd1cmF0aW9uLmNhbmlzdGVySWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBZ2VudEVycm9yKGBDYW5pc3RlciBJRCBpcyByZXF1aXJlZCwgYnV0IHJlY2VpdmVkICR7dHlwZW9mIGNvbmZpZ3VyYXRpb24uY2FuaXN0ZXJJZH0gaW5zdGVhZC4gSWYgeW91IGFyZSB1c2luZyBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZCBkZWNsYXJhdGlvbnMsIHRoaXMgbWF5IGJlIGJlY2F1c2UgeW91ciBhcHBsaWNhdGlvbiBpcyBub3Qgc2V0dGluZyB0aGUgY2FuaXN0ZXIgSUQgaW4gcHJvY2Vzcy5lbnYgY29ycmVjdGx5LmApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgKHRoaXMuY3JlYXRlQWN0b3JDbGFzcyhpbnRlcmZhY2VGYWN0b3J5KSkoY29uZmlndXJhdGlvbik7XG4gICAgfVxuICAgIHN0YXRpYyBjcmVhdGVBY3RvcldpdGhIdHRwRGV0YWlscyhpbnRlcmZhY2VGYWN0b3J5LCBjb25maWd1cmF0aW9uKSB7XG4gICAgICAgIHJldHVybiBuZXcgKHRoaXMuY3JlYXRlQWN0b3JDbGFzcyhpbnRlcmZhY2VGYWN0b3J5LCB7IGh0dHBEZXRhaWxzOiB0cnVlIH0pKShjb25maWd1cmF0aW9uKTtcbiAgICB9XG59XG4vLyBJREwgZnVuY3Rpb25zIGNhbiBoYXZlIG11bHRpcGxlIHJldHVybiB2YWx1ZXMsIHNvIGRlY29kaW5nIGFsd2F5c1xuLy8gcHJvZHVjZXMgYW4gYXJyYXkuIEVuc3VyZSB0aGF0IGZ1bmN0aW9ucyB3aXRoIHNpbmdsZSBvciB6ZXJvIHJldHVyblxuLy8gdmFsdWVzIGJlaGF2ZSBhcyBleHBlY3RlZC5cbmZ1bmN0aW9uIGRlY29kZVJldHVyblZhbHVlKHR5cGVzLCBtc2cpIHtcbiAgICBjb25zdCByZXR1cm5WYWx1ZXMgPSBJREwuZGVjb2RlKHR5cGVzLCBCdWZmZXIuZnJvbShtc2cpKTtcbiAgICBzd2l0Y2ggKHJldHVyblZhbHVlcy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIHJldHVyblZhbHVlc1swXTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiByZXR1cm5WYWx1ZXM7XG4gICAgfVxufVxuY29uc3QgREVGQVVMVF9BQ1RPUl9DT05GSUcgPSB7XG4gICAgcG9sbGluZ1N0cmF0ZWd5RmFjdG9yeTogc3RyYXRlZ3kuZGVmYXVsdFN0cmF0ZWd5LFxufTtcbmV4cG9ydCBjb25zdCBBQ1RPUl9NRVRIT0RfV0lUSF9IVFRQX0RFVEFJTFMgPSAnaHR0cC1kZXRhaWxzJztcbmZ1bmN0aW9uIF9jcmVhdGVBY3Rvck1ldGhvZChhY3RvciwgbWV0aG9kTmFtZSwgZnVuYywgYmxzVmVyaWZ5KSB7XG4gICAgbGV0IGNhbGxlcjtcbiAgICBpZiAoZnVuYy5hbm5vdGF0aW9ucy5pbmNsdWRlcygncXVlcnknKSB8fCBmdW5jLmFubm90YXRpb25zLmluY2x1ZGVzKCdjb21wb3NpdGVfcXVlcnknKSkge1xuICAgICAgICBjYWxsZXIgPSBhc3luYyAob3B0aW9ucywgLi4uYXJncykgPT4ge1xuICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgIC8vIEZpcnN0LCBpZiB0aGVyZSdzIGEgY29uZmlnIHRyYW5zZm9ybWF0aW9uLCBjYWxsIGl0LlxuICAgICAgICAgICAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucyksIChfYiA9IChfYSA9IGFjdG9yW21ldGFkYXRhU3ltYm9sXS5jb25maWcpLnF1ZXJ5VHJhbnNmb3JtKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbChfYSwgbWV0aG9kTmFtZSwgYXJncywgT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBhY3RvclttZXRhZGF0YVN5bWJvbF0uY29uZmlnKSwgb3B0aW9ucykpKTtcbiAgICAgICAgICAgIGNvbnN0IGFnZW50ID0gb3B0aW9ucy5hZ2VudCB8fCBhY3RvclttZXRhZGF0YVN5bWJvbF0uY29uZmlnLmFnZW50IHx8IGdldERlZmF1bHRBZ2VudCgpO1xuICAgICAgICAgICAgY29uc3QgY2lkID0gUHJpbmNpcGFsLmZyb20ob3B0aW9ucy5jYW5pc3RlcklkIHx8IGFjdG9yW21ldGFkYXRhU3ltYm9sXS5jb25maWcuY2FuaXN0ZXJJZCk7XG4gICAgICAgICAgICBjb25zdCBhcmcgPSBJREwuZW5jb2RlKGZ1bmMuYXJnVHlwZXMsIGFyZ3MpO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYWdlbnQucXVlcnkoY2lkLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kTmFtZSxcbiAgICAgICAgICAgICAgICBhcmcsXG4gICAgICAgICAgICAgICAgZWZmZWN0aXZlQ2FuaXN0ZXJJZDogb3B0aW9ucy5lZmZlY3RpdmVDYW5pc3RlcklkLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzd2l0Y2ggKHJlc3VsdC5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwicmVqZWN0ZWRcIiAvKiBRdWVyeVJlc3BvbnNlU3RhdHVzLlJlamVjdGVkICovOlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUXVlcnlDYWxsUmVqZWN0ZWRFcnJvcihjaWQsIG1ldGhvZE5hbWUsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgY2FzZSBcInJlcGxpZWRcIiAvKiBRdWVyeVJlc3BvbnNlU3RhdHVzLlJlcGxpZWQgKi86XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jLmFubm90YXRpb25zLmluY2x1ZGVzKEFDVE9SX01FVEhPRF9XSVRIX0hUVFBfREVUQUlMUylcbiAgICAgICAgICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0dHBEZXRhaWxzOiByZXN1bHQuaHR0cERldGFpbHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiBkZWNvZGVSZXR1cm5WYWx1ZShmdW5jLnJldFR5cGVzLCByZXN1bHQucmVwbHkuYXJnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDogZGVjb2RlUmV0dXJuVmFsdWUoZnVuYy5yZXRUeXBlcywgcmVzdWx0LnJlcGx5LmFyZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjYWxsZXIgPSBhc3luYyAob3B0aW9ucywgLi4uYXJncykgPT4ge1xuICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgIC8vIEZpcnN0LCBpZiB0aGVyZSdzIGEgY29uZmlnIHRyYW5zZm9ybWF0aW9uLCBjYWxsIGl0LlxuICAgICAgICAgICAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucyksIChfYiA9IChfYSA9IGFjdG9yW21ldGFkYXRhU3ltYm9sXS5jb25maWcpLmNhbGxUcmFuc2Zvcm0pID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jYWxsKF9hLCBtZXRob2ROYW1lLCBhcmdzLCBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIGFjdG9yW21ldGFkYXRhU3ltYm9sXS5jb25maWcpLCBvcHRpb25zKSkpO1xuICAgICAgICAgICAgY29uc3QgYWdlbnQgPSBvcHRpb25zLmFnZW50IHx8IGFjdG9yW21ldGFkYXRhU3ltYm9sXS5jb25maWcuYWdlbnQgfHwgZ2V0RGVmYXVsdEFnZW50KCk7XG4gICAgICAgICAgICBjb25zdCB7IGNhbmlzdGVySWQsIGVmZmVjdGl2ZUNhbmlzdGVySWQsIHBvbGxpbmdTdHJhdGVneUZhY3RvcnkgfSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0FDVE9SX0NPTkZJRyksIGFjdG9yW21ldGFkYXRhU3ltYm9sXS5jb25maWcpLCBvcHRpb25zKTtcbiAgICAgICAgICAgIGNvbnN0IGNpZCA9IFByaW5jaXBhbC5mcm9tKGNhbmlzdGVySWQpO1xuICAgICAgICAgICAgY29uc3QgZWNpZCA9IGVmZmVjdGl2ZUNhbmlzdGVySWQgIT09IHVuZGVmaW5lZCA/IFByaW5jaXBhbC5mcm9tKGVmZmVjdGl2ZUNhbmlzdGVySWQpIDogY2lkO1xuICAgICAgICAgICAgY29uc3QgYXJnID0gSURMLmVuY29kZShmdW5jLmFyZ1R5cGVzLCBhcmdzKTtcbiAgICAgICAgICAgIGNvbnN0IHsgcmVxdWVzdElkLCByZXNwb25zZSB9ID0gYXdhaXQgYWdlbnQuY2FsbChjaWQsIHtcbiAgICAgICAgICAgICAgICBtZXRob2ROYW1lLFxuICAgICAgICAgICAgICAgIGFyZyxcbiAgICAgICAgICAgICAgICBlZmZlY3RpdmVDYW5pc3RlcklkOiBlY2lkLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rIHx8IHJlc3BvbnNlLmJvZHkgLyogSUMtMTQ2MiAqLykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBVcGRhdGVDYWxsUmVqZWN0ZWRFcnJvcihjaWQsIG1ldGhvZE5hbWUsIHJlcXVlc3RJZCwgcmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcG9sbFN0cmF0ZWd5ID0gcG9sbGluZ1N0cmF0ZWd5RmFjdG9yeSgpO1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VCeXRlcyA9IGF3YWl0IHBvbGxGb3JSZXNwb25zZShhZ2VudCwgZWNpZCwgcmVxdWVzdElkLCBwb2xsU3RyYXRlZ3ksIGJsc1ZlcmlmeSk7XG4gICAgICAgICAgICBjb25zdCBzaG91bGRJbmNsdWRlSHR0cERldGFpbHMgPSBmdW5jLmFubm90YXRpb25zLmluY2x1ZGVzKEFDVE9SX01FVEhPRF9XSVRIX0hUVFBfREVUQUlMUyk7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2VCeXRlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNob3VsZEluY2x1ZGVIdHRwRGV0YWlsc1xuICAgICAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0dHBEZXRhaWxzOiByZXNwb25zZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZGVjb2RlUmV0dXJuVmFsdWUoZnVuYy5yZXRUeXBlcywgcmVzcG9uc2VCeXRlcyksXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgOiBkZWNvZGVSZXR1cm5WYWx1ZShmdW5jLnJldFR5cGVzLCByZXNwb25zZUJ5dGVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGZ1bmMucmV0VHlwZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNob3VsZEluY2x1ZGVIdHRwRGV0YWlsc1xuICAgICAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0dHBEZXRhaWxzOiByZXNwb25zZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYWxsIHdhcyByZXR1cm5lZCB1bmRlZmluZWQsIGJ1dCB0eXBlIFske2Z1bmMucmV0VHlwZXMuam9pbignLCcpfV0uYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IGhhbmRsZXIgPSAoLi4uYXJncykgPT4gY2FsbGVyKHt9LCAuLi5hcmdzKTtcbiAgICBoYW5kbGVyLndpdGhPcHRpb25zID1cbiAgICAgICAgKG9wdGlvbnMpID0+ICguLi5hcmdzKSA9PiBjYWxsZXIob3B0aW9ucywgLi4uYXJncyk7XG4gICAgcmV0dXJuIGhhbmRsZXI7XG59XG4vKipcbiAqIENyZWF0ZSBhIG1hbmFnZW1lbnQgY2FuaXN0ZXIgYWN0b3JcbiAqIEBwYXJhbSBjb25maWcgLSBhIENhbGxDb25maWdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE1hbmFnZW1lbnRDYW5pc3Rlcihjb25maWcpIHtcbiAgICBmdW5jdGlvbiB0cmFuc2Zvcm0oX21ldGhvZE5hbWUsIGFyZ3MpIHtcbiAgICAgICAgaWYgKGNvbmZpZy5lZmZlY3RpdmVDYW5pc3RlcklkKSB7XG4gICAgICAgICAgICByZXR1cm4geyBlZmZlY3RpdmVDYW5pc3RlcklkOiBQcmluY2lwYWwuZnJvbShjb25maWcuZWZmZWN0aXZlQ2FuaXN0ZXJJZCkgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaXJzdCA9IGFyZ3NbMF07XG4gICAgICAgIGxldCBlZmZlY3RpdmVDYW5pc3RlcklkID0gUHJpbmNpcGFsLmZyb21IZXgoJycpO1xuICAgICAgICBpZiAoZmlyc3QgJiYgdHlwZW9mIGZpcnN0ID09PSAnb2JqZWN0JyAmJiBmaXJzdC5jYW5pc3Rlcl9pZCkge1xuICAgICAgICAgICAgZWZmZWN0aXZlQ2FuaXN0ZXJJZCA9IFByaW5jaXBhbC5mcm9tKGZpcnN0LmNhbmlzdGVyX2lkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBlZmZlY3RpdmVDYW5pc3RlcklkIH07XG4gICAgfVxuICAgIHJldHVybiBBY3Rvci5jcmVhdGVBY3RvcihtYW5hZ2VtZW50Q2FuaXN0ZXJJZGwsIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBjb25maWcpLCB7IGNhbmlzdGVySWQ6IFByaW5jaXBhbC5mcm9tSGV4KCcnKSB9KSwge1xuICAgICAgICBjYWxsVHJhbnNmb3JtOiB0cmFuc2Zvcm0sXG4gICAgICAgIHF1ZXJ5VHJhbnNmb3JtOiB0cmFuc2Zvcm0sXG4gICAgfSkpO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWN0b3IuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@dfinity/agent/lib/esm/actor.js\n"));

/***/ }),

/***/ "./node_modules/@dfinity/agent/lib/esm/agent/http/index.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@dfinity/agent/lib/esm/agent/http/index.js ***!
  \*****************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   HttpAgent: function() { return /* binding */ HttpAgent; },\n/* harmony export */   IC_ROOT_KEY: function() { return /* binding */ IC_ROOT_KEY; },\n/* harmony export */   IdentityInvalidError: function() { return /* binding */ IdentityInvalidError; },\n/* harmony export */   MANAGEMENT_CANISTER_ID: function() { return /* binding */ MANAGEMENT_CANISTER_ID; },\n/* harmony export */   RequestStatusResponseStatus: function() { return /* binding */ RequestStatusResponseStatus; },\n/* harmony export */   makeNonce: function() { return /* reexport safe */ _types__WEBPACK_IMPORTED_MODULE_7__.makeNonce; }\n/* harmony export */ });\n/* harmony import */ var _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dfinity/principal */ \"./node_modules/@dfinity/principal/lib/esm/index.js\");\n/* harmony import */ var _errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../errors */ \"./node_modules/@dfinity/agent/lib/esm/errors.js\");\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../auth */ \"./node_modules/@dfinity/agent/lib/esm/auth.js\");\n/* harmony import */ var _cbor__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../cbor */ \"./node_modules/@dfinity/agent/lib/esm/cbor.js\");\n/* harmony import */ var _request_id__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../request_id */ \"./node_modules/@dfinity/agent/lib/esm/request_id.js\");\n/* harmony import */ var _utils_buffer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/buffer */ \"./node_modules/@dfinity/agent/lib/esm/utils/buffer.js\");\n/* harmony import */ var _transforms__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./transforms */ \"./node_modules/@dfinity/agent/lib/esm/agent/http/transforms.js\");\n/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./types */ \"./node_modules/@dfinity/agent/lib/esm/agent/http/types.js\");\n/* harmony import */ var _errors__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./errors */ \"./node_modules/@dfinity/agent/lib/esm/agent/http/errors.js\");\n/* harmony import */ var _canisterStatus__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../canisterStatus */ \"./node_modules/@dfinity/agent/lib/esm/canisterStatus/index.js\");\n/* harmony import */ var _certificate__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../certificate */ \"./node_modules/@dfinity/agent/lib/esm/certificate.js\");\n/* harmony import */ var _noble_curves_ed25519__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @noble/curves/ed25519 */ \"./node_modules/@noble/curves/esm/ed25519.js\");\n/* harmony import */ var _utils_expirableMap__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../utils/expirableMap */ \"./node_modules/@dfinity/agent/lib/esm/utils/expirableMap.js\");\n/* harmony import */ var _public_key__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../public_key */ \"./node_modules/@dfinity/agent/lib/esm/public_key.js\");\n/* harmony import */ var _utils_leb__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../utils/leb */ \"./node_modules/@dfinity/agent/lib/esm/utils/leb.js\");\n/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../observable */ \"./node_modules/@dfinity/agent/lib/esm/observable.js\");\n/* harmony import */ var _polling_backoff__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../polling/backoff */ \"./node_modules/@dfinity/agent/lib/esm/polling/backoff.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _transforms__WEBPACK_IMPORTED_MODULE_6__) if([\"default\",\"makeNonce\",\"RequestStatusResponseStatus\",\"IC_ROOT_KEY\",\"MANAGEMENT_CANISTER_ID\",\"IdentityInvalidError\",\"HttpAgent\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _transforms__WEBPACK_IMPORTED_MODULE_6__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\nvar __classPrivateFieldSet = (undefined && undefined.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (undefined && undefined.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _HttpAgent_instances, _HttpAgent_retryTimes, _HttpAgent_backoffStrategy, _HttpAgent_waterMark, _HttpAgent_queryPipeline, _HttpAgent_updatePipeline, _HttpAgent_subnetKeys, _HttpAgent_verifyQuerySignatures, _HttpAgent_requestAndRetryQuery, _HttpAgent_requestAndRetry, _HttpAgent_verifyQueryResponse;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar RequestStatusResponseStatus;\n(function (RequestStatusResponseStatus) {\n    RequestStatusResponseStatus[\"Received\"] = \"received\";\n    RequestStatusResponseStatus[\"Processing\"] = \"processing\";\n    RequestStatusResponseStatus[\"Replied\"] = \"replied\";\n    RequestStatusResponseStatus[\"Rejected\"] = \"rejected\";\n    RequestStatusResponseStatus[\"Unknown\"] = \"unknown\";\n    RequestStatusResponseStatus[\"Done\"] = \"done\";\n})(RequestStatusResponseStatus || (RequestStatusResponseStatus = {}));\n// Default delta for ingress expiry is 5 minutes.\nconst DEFAULT_INGRESS_EXPIRY_DELTA_IN_MSECS = 5 * 60 * 1000;\n// Root public key for the IC, encoded as hex\nconst IC_ROOT_KEY = '308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814' +\n    'c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d968' +\n    '5f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484' +\n    'b01291091c5f87b98883463f98091a0baaae';\nconst MANAGEMENT_CANISTER_ID = 'aaaaa-aa';\n// IC0 domain info\nconst IC0_DOMAIN = 'ic0.app';\nconst IC0_SUB_DOMAIN = '.ic0.app';\nconst ICP0_DOMAIN = 'icp0.io';\nconst ICP0_SUB_DOMAIN = '.icp0.io';\nconst ICP_API_DOMAIN = 'icp-api.io';\nconst ICP_API_SUB_DOMAIN = '.icp-api.io';\nclass HttpDefaultFetchError extends _errors__WEBPACK_IMPORTED_MODULE_1__.AgentError {\n    constructor(message) {\n        super(message);\n        this.message = message;\n    }\n}\nclass IdentityInvalidError extends _errors__WEBPACK_IMPORTED_MODULE_1__.AgentError {\n    constructor(message) {\n        super(message);\n        this.message = message;\n    }\n}\nfunction getDefaultFetch() {\n    let defaultFetch;\n    if (typeof window !== 'undefined') {\n        // Browser context\n        if (window.fetch) {\n            defaultFetch = window.fetch.bind(window);\n        }\n        else {\n            throw new HttpDefaultFetchError('Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.');\n        }\n    }\n    else if (typeof __webpack_require__.g !== 'undefined') {\n        // Node context\n        if (__webpack_require__.g.fetch) {\n            defaultFetch = __webpack_require__.g.fetch.bind(__webpack_require__.g);\n        }\n        else {\n            throw new HttpDefaultFetchError('Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.');\n        }\n    }\n    else if (typeof self !== 'undefined') {\n        if (self.fetch) {\n            defaultFetch = self.fetch.bind(self);\n        }\n    }\n    if (defaultFetch) {\n        return defaultFetch;\n    }\n    throw new HttpDefaultFetchError('Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.');\n}\n// A HTTP agent allows users to interact with a client of the internet computer\n// using the available methods. It exposes an API that closely follows the\n// public view of the internet computer, and is not intended to be exposed\n// directly to the majority of users due to its low-level interface.\n//\n// There is a pipeline to apply transformations to the request before sending\n// it to the client. This is to decouple signature, nonce generation and\n// other computations so that this class can stay as simple as possible while\n// allowing extensions.\nclass HttpAgent {\n    constructor(options = {}) {\n        var _a;\n        _HttpAgent_instances.add(this);\n        this.rootKey = (0,_utils_buffer__WEBPACK_IMPORTED_MODULE_5__.fromHex)(IC_ROOT_KEY);\n        this._timeDiffMsecs = 0;\n        this._rootKeyFetched = false;\n        _HttpAgent_retryTimes.set(this, void 0); // Retry requests N times before erroring by default\n        _HttpAgent_backoffStrategy.set(this, void 0);\n        this._isAgent = true;\n        // The UTC time in milliseconds when the latest request was made\n        _HttpAgent_waterMark.set(this, 0);\n        this.log = new _observable__WEBPACK_IMPORTED_MODULE_14__.ObservableLog();\n        _HttpAgent_queryPipeline.set(this, []);\n        _HttpAgent_updatePipeline.set(this, []);\n        _HttpAgent_subnetKeys.set(this, new _utils_expirableMap__WEBPACK_IMPORTED_MODULE_11__.ExpirableMap({\n            expirationTime: 5 * 60 * 1000, // 5 minutes\n        }));\n        _HttpAgent_verifyQuerySignatures.set(this, true);\n        /**\n         * See https://internetcomputer.org/docs/current/references/ic-interface-spec/#http-query for details on validation\n         * @param queryResponse - The response from the query\n         * @param subnetStatus - The subnet status, including all node keys\n         * @returns ApiQueryResponse\n         */\n        _HttpAgent_verifyQueryResponse.set(this, (queryResponse, subnetStatus) => {\n            if (__classPrivateFieldGet(this, _HttpAgent_verifyQuerySignatures, \"f\") === false) {\n                // This should not be called if the user has disabled verification\n                return queryResponse;\n            }\n            if (!subnetStatus) {\n                throw new _certificate__WEBPACK_IMPORTED_MODULE_10__.CertificateVerificationError('Invalid signature from replica signed query: no matching node key found.');\n            }\n            const { status, signatures = [], requestId } = queryResponse;\n            const domainSeparator = new TextEncoder().encode('\\x0Bic-response');\n            for (const sig of signatures) {\n                const { timestamp, identity } = sig;\n                const nodeId = _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__.Principal.fromUint8Array(identity).toText();\n                let hash;\n                // Hash is constructed differently depending on the status\n                if (status === 'replied') {\n                    const { reply } = queryResponse;\n                    hash = (0,_request_id__WEBPACK_IMPORTED_MODULE_4__.hashOfMap)({\n                        status: status,\n                        reply: reply,\n                        timestamp: BigInt(timestamp),\n                        request_id: requestId,\n                    });\n                }\n                else if (status === 'rejected') {\n                    const { reject_code, reject_message, error_code } = queryResponse;\n                    hash = (0,_request_id__WEBPACK_IMPORTED_MODULE_4__.hashOfMap)({\n                        status: status,\n                        reject_code: reject_code,\n                        reject_message: reject_message,\n                        error_code: error_code,\n                        timestamp: BigInt(timestamp),\n                        request_id: requestId,\n                    });\n                }\n                else {\n                    throw new Error(`Unknown status: ${status}`);\n                }\n                const separatorWithHash = (0,_utils_buffer__WEBPACK_IMPORTED_MODULE_5__.concat)(domainSeparator, new Uint8Array(hash));\n                // FIX: check for match without verifying N times\n                const pubKey = subnetStatus === null || subnetStatus === void 0 ? void 0 : subnetStatus.nodeKeys.get(nodeId);\n                if (!pubKey) {\n                    throw new _certificate__WEBPACK_IMPORTED_MODULE_10__.CertificateVerificationError('Invalid signature from replica signed query: no matching node key found.');\n                }\n                const rawKey = _public_key__WEBPACK_IMPORTED_MODULE_12__.Ed25519PublicKey.fromDer(pubKey).rawKey;\n                const valid = _noble_curves_ed25519__WEBPACK_IMPORTED_MODULE_16__.ed25519.verify(sig.signature, new Uint8Array(separatorWithHash), new Uint8Array(rawKey));\n                if (valid)\n                    return queryResponse;\n                throw new _certificate__WEBPACK_IMPORTED_MODULE_10__.CertificateVerificationError(`Invalid signature from replica ${nodeId} signed query.`);\n            }\n            return queryResponse;\n        });\n        if (options.source) {\n            if (!(options.source instanceof HttpAgent)) {\n                throw new Error(\"An Agent's source can only be another HttpAgent\");\n            }\n            this._identity = options.source._identity;\n            this._fetch = options.source._fetch;\n            this._host = options.source._host;\n            this._credentials = options.source._credentials;\n        }\n        else {\n            this._fetch = options.fetch || getDefaultFetch() || fetch.bind(__webpack_require__.g);\n            this._fetchOptions = options.fetchOptions;\n            this._callOptions = options.callOptions;\n        }\n        if (options.host !== undefined) {\n            if (!options.host.match(/^[a-z]+:/) && typeof window !== 'undefined') {\n                this._host = new URL(window.location.protocol + '//' + options.host);\n            }\n            else {\n                this._host = new URL(options.host);\n            }\n        }\n        else if (options.source !== undefined) {\n            // Safe to ignore here.\n            this._host = options.source._host;\n        }\n        else {\n            const location = typeof window !== 'undefined' ? window.location : undefined;\n            if (!location) {\n                this._host = new URL('https://icp-api.io');\n                this.log.warn('Could not infer host from window.location, defaulting to mainnet gateway of https://icp-api.io. Please provide a host to the HttpAgent constructor to avoid this warning.');\n            }\n            // Mainnet, local, and remote environments will have the api route available\n            const knownHosts = ['ic0.app', 'icp0.io', '127.0.0.1', 'localhost'];\n            const remoteHosts = ['.github.dev', '.gitpod.io'];\n            const hostname = location === null || location === void 0 ? void 0 : location.hostname;\n            let knownHost;\n            if (hostname && typeof hostname === 'string') {\n                if (remoteHosts.some(host => hostname.endsWith(host))) {\n                    knownHost = hostname;\n                }\n                else {\n                    knownHost = knownHosts.find(host => hostname.endsWith(host));\n                }\n            }\n            if (location && knownHost) {\n                // If the user is on a boundary-node provided host, we can use the same host for the agent\n                this._host = new URL(`${location.protocol}//${knownHost}${location.port ? ':' + location.port : ''}`);\n            }\n            else {\n                this._host = new URL('https://icp-api.io');\n                this.log.warn('Could not infer host from window.location, defaulting to mainnet gateway of https://icp-api.io. Please provide a host to the HttpAgent constructor to avoid this warning.');\n            }\n        }\n        if (options.verifyQuerySignatures !== undefined) {\n            __classPrivateFieldSet(this, _HttpAgent_verifyQuerySignatures, options.verifyQuerySignatures, \"f\");\n        }\n        // Default is 3\n        __classPrivateFieldSet(this, _HttpAgent_retryTimes, (_a = options.retryTimes) !== null && _a !== void 0 ? _a : 3, \"f\");\n        // Delay strategy for retries. Default is exponential backoff\n        const defaultBackoffFactory = () => new _polling_backoff__WEBPACK_IMPORTED_MODULE_15__.ExponentialBackoff({\n            maxIterations: __classPrivateFieldGet(this, _HttpAgent_retryTimes, \"f\"),\n        });\n        __classPrivateFieldSet(this, _HttpAgent_backoffStrategy, options.backoffStrategy || defaultBackoffFactory, \"f\");\n        // Rewrite to avoid redirects\n        if (this._host.hostname.endsWith(IC0_SUB_DOMAIN)) {\n            this._host.hostname = IC0_DOMAIN;\n        }\n        else if (this._host.hostname.endsWith(ICP0_SUB_DOMAIN)) {\n            this._host.hostname = ICP0_DOMAIN;\n        }\n        else if (this._host.hostname.endsWith(ICP_API_SUB_DOMAIN)) {\n            this._host.hostname = ICP_API_DOMAIN;\n        }\n        if (options.credentials) {\n            const { name, password } = options.credentials;\n            this._credentials = `${name}${password ? ':' + password : ''}`;\n        }\n        this._identity = Promise.resolve(options.identity || new _auth__WEBPACK_IMPORTED_MODULE_2__.AnonymousIdentity());\n        // Add a nonce transform to ensure calls are unique\n        this.addTransform('update', (0,_transforms__WEBPACK_IMPORTED_MODULE_6__.makeNonceTransform)(_types__WEBPACK_IMPORTED_MODULE_7__.makeNonce));\n        if (options.useQueryNonces) {\n            this.addTransform('query', (0,_transforms__WEBPACK_IMPORTED_MODULE_6__.makeNonceTransform)(_types__WEBPACK_IMPORTED_MODULE_7__.makeNonce));\n        }\n        if (options.logToConsole) {\n            this.log.subscribe(log => {\n                if (log.level === 'error') {\n                    console.error(log.message);\n                }\n                else if (log.level === 'warn') {\n                    console.warn(log.message);\n                }\n                else {\n                    console.log(log.message);\n                }\n            });\n        }\n    }\n    get waterMark() {\n        return __classPrivateFieldGet(this, _HttpAgent_waterMark, \"f\");\n    }\n    isLocal() {\n        const hostname = this._host.hostname;\n        return hostname === '127.0.0.1' || hostname.endsWith('127.0.0.1');\n    }\n    addTransform(type, fn, priority = fn.priority || 0) {\n        if (type === 'update') {\n            // Keep the pipeline sorted at all time, by priority.\n            const i = __classPrivateFieldGet(this, _HttpAgent_updatePipeline, \"f\").findIndex(x => (x.priority || 0) < priority);\n            __classPrivateFieldGet(this, _HttpAgent_updatePipeline, \"f\").splice(i >= 0 ? i : __classPrivateFieldGet(this, _HttpAgent_updatePipeline, \"f\").length, 0, Object.assign(fn, { priority }));\n        }\n        else if (type === 'query') {\n            // Keep the pipeline sorted at all time, by priority.\n            const i = __classPrivateFieldGet(this, _HttpAgent_queryPipeline, \"f\").findIndex(x => (x.priority || 0) < priority);\n            __classPrivateFieldGet(this, _HttpAgent_queryPipeline, \"f\").splice(i >= 0 ? i : __classPrivateFieldGet(this, _HttpAgent_queryPipeline, \"f\").length, 0, Object.assign(fn, { priority }));\n        }\n    }\n    async getPrincipal() {\n        if (!this._identity) {\n            throw new IdentityInvalidError(\"This identity has expired due this application's security policy. Please refresh your authentication.\");\n        }\n        return (await this._identity).getPrincipal();\n    }\n    async call(canisterId, options, identity) {\n        const id = await (identity !== undefined ? await identity : await this._identity);\n        if (!id) {\n            throw new IdentityInvalidError(\"This identity has expired due this application's security policy. Please refresh your authentication.\");\n        }\n        const canister = _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__.Principal.from(canisterId);\n        const ecid = options.effectiveCanisterId\n            ? _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__.Principal.from(options.effectiveCanisterId)\n            : canister;\n        const sender = id.getPrincipal() || _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__.Principal.anonymous();\n        let ingress_expiry = new _transforms__WEBPACK_IMPORTED_MODULE_6__.Expiry(DEFAULT_INGRESS_EXPIRY_DELTA_IN_MSECS);\n        // If the value is off by more than 30 seconds, reconcile system time with the network\n        if (Math.abs(this._timeDiffMsecs) > 1000 * 30) {\n            ingress_expiry = new _transforms__WEBPACK_IMPORTED_MODULE_6__.Expiry(DEFAULT_INGRESS_EXPIRY_DELTA_IN_MSECS + this._timeDiffMsecs);\n        }\n        const submit = {\n            request_type: _types__WEBPACK_IMPORTED_MODULE_7__.SubmitRequestType.Call,\n            canister_id: canister,\n            method_name: options.methodName,\n            arg: options.arg,\n            sender,\n            ingress_expiry,\n        };\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        let transformedRequest = (await this._transform({\n            request: {\n                body: null,\n                method: 'POST',\n                headers: Object.assign({ 'Content-Type': 'application/cbor' }, (this._credentials ? { Authorization: 'Basic ' + btoa(this._credentials) } : {})),\n            },\n            endpoint: \"call\" /* Endpoint.Call */,\n            body: submit,\n        }));\n        // Apply transform for identity.\n        transformedRequest = await id.transformRequest(transformedRequest);\n        const body = _cbor__WEBPACK_IMPORTED_MODULE_3__.encode(transformedRequest.body);\n        this.log.print(`fetching \"/api/v2/canister/${ecid.toText()}/call\" with request:`, transformedRequest);\n        // Run both in parallel. The fetch is quite expensive, so we have plenty of time to\n        // calculate the requestId locally.\n        const backoff = __classPrivateFieldGet(this, _HttpAgent_backoffStrategy, \"f\").call(this);\n        const request = __classPrivateFieldGet(this, _HttpAgent_instances, \"m\", _HttpAgent_requestAndRetry).call(this, {\n            request: () => this._fetch('' + new URL(`/api/v2/canister/${ecid.toText()}/call`, this._host), Object.assign(Object.assign(Object.assign({}, this._callOptions), transformedRequest.request), { body })),\n            backoff,\n            tries: 0,\n        });\n        const [response, requestId] = await Promise.all([request, (0,_request_id__WEBPACK_IMPORTED_MODULE_4__.requestIdOf)(submit)]);\n        const responseBuffer = await response.arrayBuffer();\n        const responseBody = (response.status === 200 && responseBuffer.byteLength > 0 ? _cbor__WEBPACK_IMPORTED_MODULE_3__.decode(responseBuffer) : null);\n        return {\n            requestId,\n            response: {\n                ok: response.ok,\n                status: response.status,\n                statusText: response.statusText,\n                body: responseBody,\n                headers: (0,_transforms__WEBPACK_IMPORTED_MODULE_6__.httpHeadersTransform)(response.headers),\n            },\n        };\n    }\n    async query(canisterId, fields, identity) {\n        const backoff = __classPrivateFieldGet(this, _HttpAgent_backoffStrategy, \"f\").call(this);\n        const ecid = fields.effectiveCanisterId\n            ? _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__.Principal.from(fields.effectiveCanisterId)\n            : _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__.Principal.from(canisterId);\n        this.log.print(`ecid ${ecid.toString()}`);\n        this.log.print(`canisterId ${canisterId.toString()}`);\n        const makeQuery = async () => {\n            const id = await (identity !== undefined ? await identity : await this._identity);\n            if (!id) {\n                throw new IdentityInvalidError(\"This identity has expired due this application's security policy. Please refresh your authentication.\");\n            }\n            const canister = _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__.Principal.from(canisterId);\n            const sender = (id === null || id === void 0 ? void 0 : id.getPrincipal()) || _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__.Principal.anonymous();\n            const request = {\n                request_type: \"query\" /* ReadRequestType.Query */,\n                canister_id: canister,\n                method_name: fields.methodName,\n                arg: fields.arg,\n                sender,\n                ingress_expiry: new _transforms__WEBPACK_IMPORTED_MODULE_6__.Expiry(DEFAULT_INGRESS_EXPIRY_DELTA_IN_MSECS),\n            };\n            const requestId = await (0,_request_id__WEBPACK_IMPORTED_MODULE_4__.requestIdOf)(request);\n            // TODO: remove this any. This can be a Signed or UnSigned request.\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            let transformedRequest = await this._transform({\n                request: {\n                    method: 'POST',\n                    headers: Object.assign({ 'Content-Type': 'application/cbor' }, (this._credentials ? { Authorization: 'Basic ' + btoa(this._credentials) } : {})),\n                },\n                endpoint: \"read\" /* Endpoint.Query */,\n                body: request,\n            });\n            // Apply transform for identity.\n            transformedRequest = (await (id === null || id === void 0 ? void 0 : id.transformRequest(transformedRequest)));\n            const body = _cbor__WEBPACK_IMPORTED_MODULE_3__.encode(transformedRequest.body);\n            const args = {\n                canister: canister.toText(),\n                ecid,\n                transformedRequest,\n                body,\n                requestId,\n                backoff,\n                tries: 0,\n            };\n            return await __classPrivateFieldGet(this, _HttpAgent_instances, \"m\", _HttpAgent_requestAndRetryQuery).call(this, args);\n        };\n        const getSubnetStatus = async () => {\n            if (!__classPrivateFieldGet(this, _HttpAgent_verifyQuerySignatures, \"f\")) {\n                return undefined;\n            }\n            const subnetStatus = __classPrivateFieldGet(this, _HttpAgent_subnetKeys, \"f\").get(ecid.toString());\n            if (subnetStatus) {\n                return subnetStatus;\n            }\n            await this.fetchSubnetKeys(ecid.toString());\n            return __classPrivateFieldGet(this, _HttpAgent_subnetKeys, \"f\").get(ecid.toString());\n        };\n        // Attempt to make the query i=retryTimes times\n        // Make query and fetch subnet keys in parallel\n        const [query, subnetStatus] = await Promise.all([makeQuery(), getSubnetStatus()]);\n        this.log.print('Query response:', query);\n        // Skip verification if the user has disabled it\n        if (!__classPrivateFieldGet(this, _HttpAgent_verifyQuerySignatures, \"f\")) {\n            return query;\n        }\n        try {\n            return __classPrivateFieldGet(this, _HttpAgent_verifyQueryResponse, \"f\").call(this, query, subnetStatus);\n        }\n        catch (_) {\n            // In case the node signatures have changed, refresh the subnet keys and try again\n            this.log.warn('Query response verification failed. Retrying with fresh subnet keys.');\n            __classPrivateFieldGet(this, _HttpAgent_subnetKeys, \"f\").delete(canisterId.toString());\n            await this.fetchSubnetKeys(ecid.toString());\n            const updatedSubnetStatus = __classPrivateFieldGet(this, _HttpAgent_subnetKeys, \"f\").get(canisterId.toString());\n            if (!updatedSubnetStatus) {\n                throw new _certificate__WEBPACK_IMPORTED_MODULE_10__.CertificateVerificationError('Invalid signature from replica signed query: no matching node key found.');\n            }\n            return __classPrivateFieldGet(this, _HttpAgent_verifyQueryResponse, \"f\").call(this, query, updatedSubnetStatus);\n        }\n    }\n    async createReadStateRequest(fields, identity) {\n        const id = await (identity !== undefined ? await identity : await this._identity);\n        if (!id) {\n            throw new IdentityInvalidError(\"This identity has expired due this application's security policy. Please refresh your authentication.\");\n        }\n        const sender = (id === null || id === void 0 ? void 0 : id.getPrincipal()) || _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__.Principal.anonymous();\n        // TODO: remove this any. This can be a Signed or UnSigned request.\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const transformedRequest = await this._transform({\n            request: {\n                method: 'POST',\n                headers: Object.assign({ 'Content-Type': 'application/cbor' }, (this._credentials ? { Authorization: 'Basic ' + btoa(this._credentials) } : {})),\n            },\n            endpoint: \"read_state\" /* Endpoint.ReadState */,\n            body: {\n                request_type: \"read_state\" /* ReadRequestType.ReadState */,\n                paths: fields.paths,\n                sender,\n                ingress_expiry: new _transforms__WEBPACK_IMPORTED_MODULE_6__.Expiry(DEFAULT_INGRESS_EXPIRY_DELTA_IN_MSECS),\n            },\n        });\n        // Apply transform for identity.\n        return id === null || id === void 0 ? void 0 : id.transformRequest(transformedRequest);\n    }\n    async readState(canisterId, fields, identity, \n    // eslint-disable-next-line\n    request) {\n        const canister = typeof canisterId === 'string' ? _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__.Principal.fromText(canisterId) : canisterId;\n        const transformedRequest = request !== null && request !== void 0 ? request : (await this.createReadStateRequest(fields, identity));\n        const body = _cbor__WEBPACK_IMPORTED_MODULE_3__.encode(transformedRequest.body);\n        this.log.print(`fetching \"/api/v2/canister/${canister}/read_state\" with request:`, transformedRequest);\n        // TODO - https://dfinity.atlassian.net/browse/SDK-1092\n        const backoff = __classPrivateFieldGet(this, _HttpAgent_backoffStrategy, \"f\").call(this);\n        const response = await __classPrivateFieldGet(this, _HttpAgent_instances, \"m\", _HttpAgent_requestAndRetry).call(this, {\n            request: () => this._fetch('' + new URL(`/api/v2/canister/${canister.toString()}/read_state`, this._host), Object.assign(Object.assign(Object.assign({}, this._fetchOptions), transformedRequest.request), { body })),\n            backoff,\n            tries: 0,\n        });\n        if (!response.ok) {\n            throw new Error(`Server returned an error:\\n` +\n                `  Code: ${response.status} (${response.statusText})\\n` +\n                `  Body: ${await response.text()}\\n`);\n        }\n        const decodedResponse = _cbor__WEBPACK_IMPORTED_MODULE_3__.decode(await response.arrayBuffer());\n        this.log.print('Read state response:', decodedResponse);\n        const parsedTime = await this.parseTimeFromResponse(decodedResponse);\n        if (parsedTime > 0) {\n            this.log.print('Read state response time:', parsedTime);\n            __classPrivateFieldSet(this, _HttpAgent_waterMark, parsedTime, \"f\");\n        }\n        return decodedResponse;\n    }\n    async parseTimeFromResponse(response) {\n        let tree;\n        if (response.certificate) {\n            const decoded = _cbor__WEBPACK_IMPORTED_MODULE_3__.decode(response.certificate);\n            if (decoded && 'tree' in decoded) {\n                tree = decoded.tree;\n            }\n            else {\n                throw new Error('Could not decode time from response');\n            }\n            const timeLookup = (0,_certificate__WEBPACK_IMPORTED_MODULE_10__.lookup_path)(['time'], tree);\n            if (timeLookup.status !== _certificate__WEBPACK_IMPORTED_MODULE_10__.LookupStatus.Found) {\n                throw new Error('Time was not found in the response or was not in its expected format.');\n            }\n            if (!(timeLookup.value instanceof ArrayBuffer) && !ArrayBuffer.isView(timeLookup)) {\n                throw new Error('Time was not found in the response or was not in its expected format.');\n            }\n            const date = (0,_utils_leb__WEBPACK_IMPORTED_MODULE_13__.decodeTime)((0,_utils_buffer__WEBPACK_IMPORTED_MODULE_5__.bufFromBufLike)(timeLookup.value));\n            this.log.print('Time from response:', date);\n            this.log.print('Time from response in milliseconds:', Number(date));\n            return Number(date);\n        }\n        else {\n            this.log.warn('No certificate found in response');\n        }\n        return 0;\n    }\n    /**\n     * Allows agent to sync its time with the network. Can be called during intialization or mid-lifecycle if the device's clock has drifted away from the network time. This is necessary to set the Expiry for a request\n     * @param {Principal} canisterId - Pass a canister ID if you need to sync the time with a particular replica. Uses the management canister by default\n     */\n    async syncTime(canisterId) {\n        const CanisterStatus = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! ../../canisterStatus */ \"./node_modules/@dfinity/agent/lib/esm/canisterStatus/index.js\"));\n        const callTime = Date.now();\n        try {\n            if (!canisterId) {\n                this.log.print('Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai');\n            }\n            const status = await CanisterStatus.request({\n                // Fall back with canisterId of the ICP Ledger\n                canisterId: canisterId !== null && canisterId !== void 0 ? canisterId : _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__.Principal.from('ryjl3-tyaaa-aaaaa-aaaba-cai'),\n                agent: this,\n                paths: ['time'],\n            });\n            const replicaTime = status.get('time');\n            if (replicaTime) {\n                this._timeDiffMsecs = Number(replicaTime) - Number(callTime);\n            }\n        }\n        catch (error) {\n            this.log.error('Caught exception while attempting to sync time', error);\n        }\n    }\n    async status() {\n        const headers = this._credentials\n            ? {\n                Authorization: 'Basic ' + btoa(this._credentials),\n            }\n            : {};\n        this.log.print(`fetching \"/api/v2/status\"`);\n        const backoff = __classPrivateFieldGet(this, _HttpAgent_backoffStrategy, \"f\").call(this);\n        const response = await __classPrivateFieldGet(this, _HttpAgent_instances, \"m\", _HttpAgent_requestAndRetry).call(this, {\n            backoff,\n            request: () => this._fetch('' + new URL(`/api/v2/status`, this._host), Object.assign({ headers }, this._fetchOptions)),\n            tries: 0,\n        });\n        return _cbor__WEBPACK_IMPORTED_MODULE_3__.decode(await response.arrayBuffer());\n    }\n    async fetchRootKey() {\n        if (!this._rootKeyFetched) {\n            // Hex-encoded version of the replica root key\n            this.rootKey = (await this.status()).root_key;\n            this._rootKeyFetched = true;\n        }\n        return this.rootKey;\n    }\n    invalidateIdentity() {\n        this._identity = null;\n    }\n    replaceIdentity(identity) {\n        this._identity = Promise.resolve(identity);\n    }\n    async fetchSubnetKeys(canisterId) {\n        const effectiveCanisterId = _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__.Principal.from(canisterId);\n        const response = await (0,_canisterStatus__WEBPACK_IMPORTED_MODULE_9__.request)({\n            canisterId: effectiveCanisterId,\n            paths: ['subnet'],\n            agent: this,\n        });\n        const subnetResponse = response.get('subnet');\n        if (subnetResponse && typeof subnetResponse === 'object' && 'nodeKeys' in subnetResponse) {\n            __classPrivateFieldGet(this, _HttpAgent_subnetKeys, \"f\").set(effectiveCanisterId.toText(), subnetResponse);\n            return subnetResponse;\n        }\n        // If the subnet status is not returned, return undefined\n        return undefined;\n    }\n    _transform(request) {\n        let p = Promise.resolve(request);\n        if (request.endpoint === \"call\" /* Endpoint.Call */) {\n            for (const fn of __classPrivateFieldGet(this, _HttpAgent_updatePipeline, \"f\")) {\n                p = p.then(r => fn(r).then(r2 => r2 || r));\n            }\n        }\n        else {\n            for (const fn of __classPrivateFieldGet(this, _HttpAgent_queryPipeline, \"f\")) {\n                p = p.then(r => fn(r).then(r2 => r2 || r));\n            }\n        }\n        return p;\n    }\n}\n_HttpAgent_retryTimes = new WeakMap(), _HttpAgent_backoffStrategy = new WeakMap(), _HttpAgent_waterMark = new WeakMap(), _HttpAgent_queryPipeline = new WeakMap(), _HttpAgent_updatePipeline = new WeakMap(), _HttpAgent_subnetKeys = new WeakMap(), _HttpAgent_verifyQuerySignatures = new WeakMap(), _HttpAgent_verifyQueryResponse = new WeakMap(), _HttpAgent_instances = new WeakSet(), _HttpAgent_requestAndRetryQuery = async function _HttpAgent_requestAndRetryQuery(args) {\n    var _a, _b;\n    const { ecid, transformedRequest, body, requestId, backoff, tries } = args;\n    const delay = tries === 0 ? 0 : backoff.next();\n    this.log.print(`fetching \"/api/v2/canister/${ecid.toString()}/query\" with tries:`, {\n        tries,\n        backoff,\n        delay,\n    });\n    // If delay is null, the backoff strategy is exhausted due to a maximum number of retries, duration, or other reason\n    if (delay === null) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_1__.AgentError(`Timestamp failed to pass the watermark after retrying the configured ${__classPrivateFieldGet(this, _HttpAgent_retryTimes, \"f\")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);\n    }\n    if (delay > 0) {\n        await new Promise(resolve => setTimeout(resolve, delay));\n    }\n    let response;\n    // Make the request and retry if it throws an error\n    try {\n        this.log.print(`fetching \"/api/v2/canister/${ecid.toString()}/query\" with request:`, transformedRequest);\n        const fetchResponse = await this._fetch('' + new URL(`/api/v2/canister/${ecid.toString()}/query`, this._host), Object.assign(Object.assign(Object.assign({}, this._fetchOptions), transformedRequest.request), { body }));\n        if (fetchResponse.status === 200) {\n            const queryResponse = _cbor__WEBPACK_IMPORTED_MODULE_3__.decode(await fetchResponse.arrayBuffer());\n            response = Object.assign(Object.assign({}, queryResponse), { httpDetails: {\n                    ok: fetchResponse.ok,\n                    status: fetchResponse.status,\n                    statusText: fetchResponse.statusText,\n                    headers: (0,_transforms__WEBPACK_IMPORTED_MODULE_6__.httpHeadersTransform)(fetchResponse.headers),\n                }, requestId });\n        }\n        else {\n            throw new _errors__WEBPACK_IMPORTED_MODULE_8__.AgentHTTPResponseError(`Gateway returned an error:\\n` +\n                `  Code: ${fetchResponse.status} (${fetchResponse.statusText})\\n` +\n                `  Body: ${await fetchResponse.text()}\\n`, {\n                ok: fetchResponse.ok,\n                status: fetchResponse.status,\n                statusText: fetchResponse.statusText,\n                headers: (0,_transforms__WEBPACK_IMPORTED_MODULE_6__.httpHeadersTransform)(fetchResponse.headers),\n            });\n        }\n    }\n    catch (error) {\n        if (tries < __classPrivateFieldGet(this, _HttpAgent_retryTimes, \"f\")) {\n            this.log.warn(`Caught exception while attempting to make query:\\n` +\n                `  ${error}\\n` +\n                `  Retrying query.`);\n            return await __classPrivateFieldGet(this, _HttpAgent_instances, \"m\", _HttpAgent_requestAndRetryQuery).call(this, Object.assign(Object.assign({}, args), { tries: tries + 1 }));\n        }\n        throw error;\n    }\n    const timestamp = (_b = (_a = response.signatures) === null || _a === void 0 ? void 0 : _a[0]) === null || _b === void 0 ? void 0 : _b.timestamp;\n    // Skip watermark verification if the user has set verifyQuerySignatures to false\n    if (!__classPrivateFieldGet(this, _HttpAgent_verifyQuerySignatures, \"f\")) {\n        return response;\n    }\n    if (!timestamp) {\n        throw new Error('Timestamp not found in query response. This suggests a malformed or malicious response.');\n    }\n    // Convert the timestamp to milliseconds\n    const timeStampInMs = Number(BigInt(timestamp) / BigInt(1000000));\n    this.log.print('watermark and timestamp', {\n        waterMark: this.waterMark,\n        timestamp: timeStampInMs,\n    });\n    // If the timestamp is less than the watermark, retry the request up to the retry limit\n    if (Number(this.waterMark) > timeStampInMs) {\n        const error = new _errors__WEBPACK_IMPORTED_MODULE_1__.AgentError('Timestamp is below the watermark. Retrying query.');\n        this.log.error('Timestamp is below', error, {\n            timestamp,\n            waterMark: this.waterMark,\n        });\n        if (tries < __classPrivateFieldGet(this, _HttpAgent_retryTimes, \"f\")) {\n            return await __classPrivateFieldGet(this, _HttpAgent_instances, \"m\", _HttpAgent_requestAndRetryQuery).call(this, Object.assign(Object.assign({}, args), { tries: tries + 1 }));\n        }\n        {\n            throw new _errors__WEBPACK_IMPORTED_MODULE_1__.AgentError(`Timestamp failed to pass the watermark after retrying the configured ${__classPrivateFieldGet(this, _HttpAgent_retryTimes, \"f\")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);\n        }\n    }\n    return response;\n}, _HttpAgent_requestAndRetry = async function _HttpAgent_requestAndRetry(args) {\n    const { request, backoff, tries } = args;\n    const delay = tries === 0 ? 0 : backoff.next();\n    // If delay is null, the backoff strategy is exhausted due to a maximum number of retries, duration, or other reason\n    if (delay === null) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_1__.AgentError(`Timestamp failed to pass the watermark after retrying the configured ${__classPrivateFieldGet(this, _HttpAgent_retryTimes, \"f\")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);\n    }\n    if (delay > 0) {\n        await new Promise(resolve => setTimeout(resolve, delay));\n    }\n    let response;\n    try {\n        response = await request();\n    }\n    catch (error) {\n        if (__classPrivateFieldGet(this, _HttpAgent_retryTimes, \"f\") > tries) {\n            this.log.warn(`Caught exception while attempting to make request:\\n` +\n                `  ${error}\\n` +\n                `  Retrying request.`);\n            // Delay the request by the configured backoff strategy\n            return await __classPrivateFieldGet(this, _HttpAgent_instances, \"m\", _HttpAgent_requestAndRetry).call(this, { request, backoff, tries: tries + 1 });\n        }\n        throw error;\n    }\n    if (response.ok) {\n        return response;\n    }\n    const responseText = await response.clone().text();\n    const errorMessage = `Server returned an error:\\n` +\n        `  Code: ${response.status} (${response.statusText})\\n` +\n        `  Body: ${responseText}\\n`;\n    if (tries < __classPrivateFieldGet(this, _HttpAgent_retryTimes, \"f\")) {\n        return await __classPrivateFieldGet(this, _HttpAgent_instances, \"m\", _HttpAgent_requestAndRetry).call(this, { request, backoff, tries: tries + 1 });\n    }\n    throw new _errors__WEBPACK_IMPORTED_MODULE_8__.AgentHTTPResponseError(errorMessage, {\n        ok: response.ok,\n        status: response.status,\n        statusText: response.statusText,\n        headers: (0,_transforms__WEBPACK_IMPORTED_MODULE_6__.httpHeadersTransform)(response.headers),\n    });\n};\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYWdlbnQvbGliL2VzbS9hZ2VudC9odHRwL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsOEJBQThCLFNBQUksSUFBSSxTQUFJO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsU0FBSSxJQUFJLFNBQUk7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUMrQztBQUNMO0FBQ0s7QUFDWjtBQUN1QjtBQUNXO0FBQ1c7QUFDeEI7QUFDTjtBQUNIO0FBQzhDO0FBQzdDO0FBQ1E7QUFDSjtBQUNQO0FBQ0k7QUFDVTtBQUM5QjtBQUNPO0FBQzdCO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGtFQUFrRTtBQUNuRTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsK0NBQVU7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLG1DQUFtQywrQ0FBVTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixxQkFBTTtBQUMxQjtBQUNBLFlBQVkscUJBQU07QUFDbEIsMkJBQTJCLHFCQUFNLFlBQVkscUJBQU07QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBLHVCQUF1QixzREFBTztBQUM5QjtBQUNBO0FBQ0EsaURBQWlEO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHVEQUFhO0FBQ3BDO0FBQ0E7QUFDQSw0Q0FBNEMsOERBQVk7QUFDeEQ7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsdUVBQTRCO0FBQ3REO0FBQ0Esb0JBQW9CLHFDQUFxQztBQUN6RDtBQUNBO0FBQ0Esd0JBQXdCLHNCQUFzQjtBQUM5QywrQkFBK0IseURBQVM7QUFDeEM7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLFFBQVE7QUFDcEMsMkJBQTJCLHNEQUFTO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSw0QkFBNEIsMENBQTBDO0FBQ3RFLDJCQUEyQixzREFBUztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHVEQUF1RCxPQUFPO0FBQzlEO0FBQ0EsMENBQTBDLHFEQUFNO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qix1RUFBNEI7QUFDMUQ7QUFDQSwrQkFBK0IsMERBQWdCO0FBQy9DLDhCQUE4QiwyREFBTztBQUNyQztBQUNBO0FBQ0EsMEJBQTBCLHVFQUE0QixtQ0FBbUMsUUFBUTtBQUNqRztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFLHFCQUFNO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxrQkFBa0IsSUFBSSxVQUFVLEVBQUUseUNBQXlDO0FBQ25IO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxpRUFBa0I7QUFDbEU7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGlCQUFpQjtBQUNyQyxtQ0FBbUMsS0FBSyxFQUFFLCtCQUErQjtBQUN6RTtBQUNBLGlFQUFpRSxvREFBaUI7QUFDbEY7QUFDQSxvQ0FBb0MsK0RBQWtCLENBQUMsNkNBQVM7QUFDaEU7QUFDQSx1Q0FBdUMsK0RBQWtCLENBQUMsNkNBQVM7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUxBQXlMLFVBQVU7QUFDbk07QUFDQTtBQUNBO0FBQ0E7QUFDQSx1TEFBdUwsVUFBVTtBQUNqTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qix5REFBUztBQUNsQztBQUNBLGNBQWMseURBQVM7QUFDdkI7QUFDQSw0Q0FBNEMseURBQVM7QUFDckQsaUNBQWlDLCtDQUFNO0FBQ3ZDO0FBQ0E7QUFDQSxpQ0FBaUMsK0NBQU07QUFDdkM7QUFDQTtBQUNBLDBCQUEwQixxREFBaUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxvQ0FBb0MseUJBQXlCLG9EQUFvRCxJQUFJO0FBQzlKLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxxQkFBcUIseUNBQVc7QUFDaEMscURBQXFELGNBQWM7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3RUFBd0UsY0FBYyxpRUFBaUUscURBQXFELE1BQU07QUFDbE47QUFDQTtBQUNBLFNBQVM7QUFDVCxrRUFBa0Usd0RBQVc7QUFDN0U7QUFDQSx5RkFBeUYseUNBQVc7QUFDcEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsaUVBQW9CO0FBQzdDLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx5REFBUztBQUN2QixjQUFjLHlEQUFTO0FBQ3ZCLCtCQUErQixnQkFBZ0I7QUFDL0MscUNBQXFDLHNCQUFzQjtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHlEQUFTO0FBQ3RDLDBGQUEwRix5REFBUztBQUNuRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsK0NBQU07QUFDMUM7QUFDQSxvQ0FBb0Msd0RBQVc7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxvQ0FBb0MseUJBQXlCLG9EQUFvRCxJQUFJO0FBQ2xLLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSx5QkFBeUIseUNBQVc7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsdUVBQTRCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNGQUFzRix5REFBUztBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLG9DQUFvQyx5QkFBeUIsb0RBQW9ELElBQUk7QUFDOUosYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsK0NBQU07QUFDMUMsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQseURBQVM7QUFDbkU7QUFDQSxxQkFBcUIseUNBQVc7QUFDaEMscURBQXFELFNBQVM7QUFDOUQ7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFLG9CQUFvQix1RUFBdUUsc0RBQXNELE1BQU07QUFDL047QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsMkJBQTJCLGlCQUFpQixHQUFHLG9CQUFvQjtBQUNuRSwyQkFBMkIsc0JBQXNCO0FBQ2pEO0FBQ0EsZ0NBQWdDLHlDQUFXO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIseUNBQVc7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLDBEQUFXO0FBQzFDLHNDQUFzQyx1REFBWTtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVEQUFVLENBQUMsNkRBQWM7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsV0FBVztBQUMxQjtBQUNBO0FBQ0EscUNBQXFDLGlMQUE4QjtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdGQUF3Rix5REFBUztBQUNqRztBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUdBQW1HLFNBQVM7QUFDNUc7QUFDQSxTQUFTO0FBQ1QsZUFBZSx5Q0FBVztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyx5REFBUztBQUM3QywrQkFBK0Isd0RBQU87QUFDdEM7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSw0REFBNEQ7QUFDeEU7QUFDQSxpREFBaUQsZ0JBQWdCO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esa0JBQWtCLCtDQUFVLHlFQUF5RSwwREFBMEQ7QUFDL0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQsZ0JBQWdCO0FBQ3JFLGlGQUFpRixnQkFBZ0Isa0VBQWtFLHNEQUFzRCxNQUFNO0FBQy9OO0FBQ0Esa0NBQWtDLHlDQUFXO0FBQzdDLHFEQUFxRCxvQkFBb0I7QUFDekU7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLGlFQUFvQjtBQUNqRCxpQkFBaUIsYUFBYTtBQUM5QjtBQUNBO0FBQ0Esc0JBQXNCLDJEQUFzQjtBQUM1QywyQkFBMkIsc0JBQXNCLEdBQUcseUJBQXlCO0FBQzdFLDJCQUEyQiwyQkFBMkI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLGlFQUFvQjtBQUM3QyxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixNQUFNO0FBQzNCO0FBQ0EsMkpBQTJKLFdBQVcsa0JBQWtCO0FBQ3hMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSwwQkFBMEIsK0NBQVU7QUFDcEM7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsMkpBQTJKLFdBQVcsa0JBQWtCO0FBQ3hMO0FBQ0E7QUFDQSxzQkFBc0IsK0NBQVUseUVBQXlFLDBEQUEwRDtBQUNuSztBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsWUFBWSwwQkFBMEI7QUFDdEM7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLCtDQUFVLHlFQUF5RSwwREFBMEQ7QUFDL0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixNQUFNO0FBQzNCO0FBQ0E7QUFDQSwwSEFBMEgsb0NBQW9DO0FBQzlKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsaUJBQWlCLEdBQUcsb0JBQW9CO0FBQzNELG1CQUFtQixhQUFhO0FBQ2hDO0FBQ0Esc0hBQXNILG9DQUFvQztBQUMxSjtBQUNBLGNBQWMsMkRBQXNCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixpRUFBb0I7QUFDckMsS0FBSztBQUNMO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL0BkZmluaXR5L2FnZW50L2xpYi9lc20vYWdlbnQvaHR0cC9pbmRleC5qcz82ZWM0Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0ID0gKHRoaXMgJiYgdGhpcy5fX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KSB8fCBmdW5jdGlvbiAocmVjZWl2ZXIsIHN0YXRlLCB2YWx1ZSwga2luZCwgZikge1xuICAgIGlmIChraW5kID09PSBcIm1cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgbWV0aG9kIGlzIG5vdCB3cml0YWJsZVwiKTtcbiAgICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBzZXR0ZXJcIik7XG4gICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3Qgd3JpdGUgcHJpdmF0ZSBtZW1iZXIgdG8gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcbiAgICByZXR1cm4gKGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyLCB2YWx1ZSkgOiBmID8gZi52YWx1ZSA9IHZhbHVlIDogc3RhdGUuc2V0KHJlY2VpdmVyLCB2YWx1ZSkpLCB2YWx1ZTtcbn07XG52YXIgX19jbGFzc1ByaXZhdGVGaWVsZEdldCA9ICh0aGlzICYmIHRoaXMuX19jbGFzc1ByaXZhdGVGaWVsZEdldCkgfHwgZnVuY3Rpb24gKHJlY2VpdmVyLCBzdGF0ZSwga2luZCwgZikge1xuICAgIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIGdldHRlclwiKTtcbiAgICBpZiAodHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciAhPT0gc3RhdGUgfHwgIWYgOiAhc3RhdGUuaGFzKHJlY2VpdmVyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCByZWFkIHByaXZhdGUgbWVtYmVyIGZyb20gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcbiAgICByZXR1cm4ga2luZCA9PT0gXCJtXCIgPyBmIDoga2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIpIDogZiA/IGYudmFsdWUgOiBzdGF0ZS5nZXQocmVjZWl2ZXIpO1xufTtcbnZhciBfSHR0cEFnZW50X2luc3RhbmNlcywgX0h0dHBBZ2VudF9yZXRyeVRpbWVzLCBfSHR0cEFnZW50X2JhY2tvZmZTdHJhdGVneSwgX0h0dHBBZ2VudF93YXRlck1hcmssIF9IdHRwQWdlbnRfcXVlcnlQaXBlbGluZSwgX0h0dHBBZ2VudF91cGRhdGVQaXBlbGluZSwgX0h0dHBBZ2VudF9zdWJuZXRLZXlzLCBfSHR0cEFnZW50X3ZlcmlmeVF1ZXJ5U2lnbmF0dXJlcywgX0h0dHBBZ2VudF9yZXF1ZXN0QW5kUmV0cnlRdWVyeSwgX0h0dHBBZ2VudF9yZXF1ZXN0QW5kUmV0cnksIF9IdHRwQWdlbnRfdmVyaWZ5UXVlcnlSZXNwb25zZTtcbmltcG9ydCB7IFByaW5jaXBhbCB9IGZyb20gJ0BkZmluaXR5L3ByaW5jaXBhbCc7XG5pbXBvcnQgeyBBZ2VudEVycm9yIH0gZnJvbSAnLi4vLi4vZXJyb3JzJztcbmltcG9ydCB7IEFub255bW91c0lkZW50aXR5IH0gZnJvbSAnLi4vLi4vYXV0aCc7XG5pbXBvcnQgKiBhcyBjYm9yIGZyb20gJy4uLy4uL2Nib3InO1xuaW1wb3J0IHsgaGFzaE9mTWFwLCByZXF1ZXN0SWRPZiB9IGZyb20gJy4uLy4uL3JlcXVlc3RfaWQnO1xuaW1wb3J0IHsgYnVmRnJvbUJ1Zkxpa2UsIGNvbmNhdCwgZnJvbUhleCB9IGZyb20gJy4uLy4uL3V0aWxzL2J1ZmZlcic7XG5pbXBvcnQgeyBFeHBpcnksIGh0dHBIZWFkZXJzVHJhbnNmb3JtLCBtYWtlTm9uY2VUcmFuc2Zvcm0gfSBmcm9tICcuL3RyYW5zZm9ybXMnO1xuaW1wb3J0IHsgbWFrZU5vbmNlLCBTdWJtaXRSZXF1ZXN0VHlwZSwgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IEFnZW50SFRUUFJlc3BvbnNlRXJyb3IgfSBmcm9tICcuL2Vycm9ycyc7XG5pbXBvcnQgeyByZXF1ZXN0IH0gZnJvbSAnLi4vLi4vY2FuaXN0ZXJTdGF0dXMnO1xuaW1wb3J0IHsgQ2VydGlmaWNhdGVWZXJpZmljYXRpb25FcnJvciwgTG9va3VwU3RhdHVzLCBsb29rdXBfcGF0aCwgfSBmcm9tICcuLi8uLi9jZXJ0aWZpY2F0ZSc7XG5pbXBvcnQgeyBlZDI1NTE5IH0gZnJvbSAnQG5vYmxlL2N1cnZlcy9lZDI1NTE5JztcbmltcG9ydCB7IEV4cGlyYWJsZU1hcCB9IGZyb20gJy4uLy4uL3V0aWxzL2V4cGlyYWJsZU1hcCc7XG5pbXBvcnQgeyBFZDI1NTE5UHVibGljS2V5IH0gZnJvbSAnLi4vLi4vcHVibGljX2tleSc7XG5pbXBvcnQgeyBkZWNvZGVUaW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvbGViJztcbmltcG9ydCB7IE9ic2VydmFibGVMb2cgfSBmcm9tICcuLi8uLi9vYnNlcnZhYmxlJztcbmltcG9ydCB7IEV4cG9uZW50aWFsQmFja29mZiB9IGZyb20gJy4uLy4uL3BvbGxpbmcvYmFja29mZic7XG5leHBvcnQgKiBmcm9tICcuL3RyYW5zZm9ybXMnO1xuZXhwb3J0IHsgbWFrZU5vbmNlIH0gZnJvbSAnLi90eXBlcyc7XG5leHBvcnQgdmFyIFJlcXVlc3RTdGF0dXNSZXNwb25zZVN0YXR1cztcbihmdW5jdGlvbiAoUmVxdWVzdFN0YXR1c1Jlc3BvbnNlU3RhdHVzKSB7XG4gICAgUmVxdWVzdFN0YXR1c1Jlc3BvbnNlU3RhdHVzW1wiUmVjZWl2ZWRcIl0gPSBcInJlY2VpdmVkXCI7XG4gICAgUmVxdWVzdFN0YXR1c1Jlc3BvbnNlU3RhdHVzW1wiUHJvY2Vzc2luZ1wiXSA9IFwicHJvY2Vzc2luZ1wiO1xuICAgIFJlcXVlc3RTdGF0dXNSZXNwb25zZVN0YXR1c1tcIlJlcGxpZWRcIl0gPSBcInJlcGxpZWRcIjtcbiAgICBSZXF1ZXN0U3RhdHVzUmVzcG9uc2VTdGF0dXNbXCJSZWplY3RlZFwiXSA9IFwicmVqZWN0ZWRcIjtcbiAgICBSZXF1ZXN0U3RhdHVzUmVzcG9uc2VTdGF0dXNbXCJVbmtub3duXCJdID0gXCJ1bmtub3duXCI7XG4gICAgUmVxdWVzdFN0YXR1c1Jlc3BvbnNlU3RhdHVzW1wiRG9uZVwiXSA9IFwiZG9uZVwiO1xufSkoUmVxdWVzdFN0YXR1c1Jlc3BvbnNlU3RhdHVzIHx8IChSZXF1ZXN0U3RhdHVzUmVzcG9uc2VTdGF0dXMgPSB7fSkpO1xuLy8gRGVmYXVsdCBkZWx0YSBmb3IgaW5ncmVzcyBleHBpcnkgaXMgNSBtaW51dGVzLlxuY29uc3QgREVGQVVMVF9JTkdSRVNTX0VYUElSWV9ERUxUQV9JTl9NU0VDUyA9IDUgKiA2MCAqIDEwMDA7XG4vLyBSb290IHB1YmxpYyBrZXkgZm9yIHRoZSBJQywgZW5jb2RlZCBhcyBoZXhcbmV4cG9ydCBjb25zdCBJQ19ST09UX0tFWSA9ICczMDgxODIzMDFkMDYwZDJiMDYwMTA0MDE4MmRjN2MwNTAzMDEwMjAxMDYwYzJiMDYwMTA0MDE4MmRjN2MwNTAzMDIwMTAzNjEwMDgxNCcgK1xuICAgICdjMGU2ZWM3MWZhYjU4M2IwOGJkODEzNzNjMjU1YzNjMzcxYjJlODQ4NjNjOThhNGYxZTA4Yjc0MjM1ZDE0ZmI1ZDljMGNkNTQ2ZDk2OCcgK1xuICAgICc1ZjkxM2EwYzBiMmNjNTM0MTU4M2JmNGI0MzkyZTQ2N2RiOTZkNjViOWJiNGNiNzE3MTEyZjg0NzJlMGQ1YTRkMTQ1MDVmZmQ3NDg0JyArXG4gICAgJ2IwMTI5MTA5MWM1Zjg3Yjk4ODgzNDYzZjk4MDkxYTBiYWFhZSc7XG5leHBvcnQgY29uc3QgTUFOQUdFTUVOVF9DQU5JU1RFUl9JRCA9ICdhYWFhYS1hYSc7XG4vLyBJQzAgZG9tYWluIGluZm9cbmNvbnN0IElDMF9ET01BSU4gPSAnaWMwLmFwcCc7XG5jb25zdCBJQzBfU1VCX0RPTUFJTiA9ICcuaWMwLmFwcCc7XG5jb25zdCBJQ1AwX0RPTUFJTiA9ICdpY3AwLmlvJztcbmNvbnN0IElDUDBfU1VCX0RPTUFJTiA9ICcuaWNwMC5pbyc7XG5jb25zdCBJQ1BfQVBJX0RPTUFJTiA9ICdpY3AtYXBpLmlvJztcbmNvbnN0IElDUF9BUElfU1VCX0RPTUFJTiA9ICcuaWNwLWFwaS5pbyc7XG5jbGFzcyBIdHRwRGVmYXVsdEZldGNoRXJyb3IgZXh0ZW5kcyBBZ2VudEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlKSB7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBJZGVudGl0eUludmFsaWRFcnJvciBleHRlbmRzIEFnZW50RXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0RGVmYXVsdEZldGNoKCkge1xuICAgIGxldCBkZWZhdWx0RmV0Y2g7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIC8vIEJyb3dzZXIgY29udGV4dFxuICAgICAgICBpZiAod2luZG93LmZldGNoKSB7XG4gICAgICAgICAgICBkZWZhdWx0RmV0Y2ggPSB3aW5kb3cuZmV0Y2guYmluZCh3aW5kb3cpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEh0dHBEZWZhdWx0RmV0Y2hFcnJvcignRmV0Y2ggaW1wbGVtZW50YXRpb24gd2FzIG5vdCBhdmFpbGFibGUuIFlvdSBhcHBlYXIgdG8gYmUgaW4gYSBicm93c2VyIGNvbnRleHQsIGJ1dCB3aW5kb3cuZmV0Y2ggd2FzIG5vdCBwcmVzZW50LicpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIC8vIE5vZGUgY29udGV4dFxuICAgICAgICBpZiAoZ2xvYmFsLmZldGNoKSB7XG4gICAgICAgICAgICBkZWZhdWx0RmV0Y2ggPSBnbG9iYWwuZmV0Y2guYmluZChnbG9iYWwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEh0dHBEZWZhdWx0RmV0Y2hFcnJvcignRmV0Y2ggaW1wbGVtZW50YXRpb24gd2FzIG5vdCBhdmFpbGFibGUuIFlvdSBhcHBlYXIgdG8gYmUgaW4gYSBOb2RlLmpzIGNvbnRleHQsIGJ1dCBnbG9iYWwuZmV0Y2ggd2FzIG5vdCBhdmFpbGFibGUuJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGlmIChzZWxmLmZldGNoKSB7XG4gICAgICAgICAgICBkZWZhdWx0RmV0Y2ggPSBzZWxmLmZldGNoLmJpbmQoc2VsZik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGRlZmF1bHRGZXRjaCkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdEZldGNoO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgSHR0cERlZmF1bHRGZXRjaEVycm9yKCdGZXRjaCBpbXBsZW1lbnRhdGlvbiB3YXMgbm90IGF2YWlsYWJsZS4gUGxlYXNlIHByb3ZpZGUgZmV0Y2ggdG8gdGhlIEh0dHBBZ2VudCBjb25zdHJ1Y3Rvciwgb3IgZW5zdXJlIGl0IGlzIGF2YWlsYWJsZSBpbiB0aGUgd2luZG93IG9yIGdsb2JhbCBjb250ZXh0LicpO1xufVxuLy8gQSBIVFRQIGFnZW50IGFsbG93cyB1c2VycyB0byBpbnRlcmFjdCB3aXRoIGEgY2xpZW50IG9mIHRoZSBpbnRlcm5ldCBjb21wdXRlclxuLy8gdXNpbmcgdGhlIGF2YWlsYWJsZSBtZXRob2RzLiBJdCBleHBvc2VzIGFuIEFQSSB0aGF0IGNsb3NlbHkgZm9sbG93cyB0aGVcbi8vIHB1YmxpYyB2aWV3IG9mIHRoZSBpbnRlcm5ldCBjb21wdXRlciwgYW5kIGlzIG5vdCBpbnRlbmRlZCB0byBiZSBleHBvc2VkXG4vLyBkaXJlY3RseSB0byB0aGUgbWFqb3JpdHkgb2YgdXNlcnMgZHVlIHRvIGl0cyBsb3ctbGV2ZWwgaW50ZXJmYWNlLlxuLy9cbi8vIFRoZXJlIGlzIGEgcGlwZWxpbmUgdG8gYXBwbHkgdHJhbnNmb3JtYXRpb25zIHRvIHRoZSByZXF1ZXN0IGJlZm9yZSBzZW5kaW5nXG4vLyBpdCB0byB0aGUgY2xpZW50LiBUaGlzIGlzIHRvIGRlY291cGxlIHNpZ25hdHVyZSwgbm9uY2UgZ2VuZXJhdGlvbiBhbmRcbi8vIG90aGVyIGNvbXB1dGF0aW9ucyBzbyB0aGF0IHRoaXMgY2xhc3MgY2FuIHN0YXkgYXMgc2ltcGxlIGFzIHBvc3NpYmxlIHdoaWxlXG4vLyBhbGxvd2luZyBleHRlbnNpb25zLlxuZXhwb3J0IGNsYXNzIEh0dHBBZ2VudCB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucyA9IHt9KSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgX0h0dHBBZ2VudF9pbnN0YW5jZXMuYWRkKHRoaXMpO1xuICAgICAgICB0aGlzLnJvb3RLZXkgPSBmcm9tSGV4KElDX1JPT1RfS0VZKTtcbiAgICAgICAgdGhpcy5fdGltZURpZmZNc2VjcyA9IDA7XG4gICAgICAgIHRoaXMuX3Jvb3RLZXlGZXRjaGVkID0gZmFsc2U7XG4gICAgICAgIF9IdHRwQWdlbnRfcmV0cnlUaW1lcy5zZXQodGhpcywgdm9pZCAwKTsgLy8gUmV0cnkgcmVxdWVzdHMgTiB0aW1lcyBiZWZvcmUgZXJyb3JpbmcgYnkgZGVmYXVsdFxuICAgICAgICBfSHR0cEFnZW50X2JhY2tvZmZTdHJhdGVneS5zZXQodGhpcywgdm9pZCAwKTtcbiAgICAgICAgdGhpcy5faXNBZ2VudCA9IHRydWU7XG4gICAgICAgIC8vIFRoZSBVVEMgdGltZSBpbiBtaWxsaXNlY29uZHMgd2hlbiB0aGUgbGF0ZXN0IHJlcXVlc3Qgd2FzIG1hZGVcbiAgICAgICAgX0h0dHBBZ2VudF93YXRlck1hcmsuc2V0KHRoaXMsIDApO1xuICAgICAgICB0aGlzLmxvZyA9IG5ldyBPYnNlcnZhYmxlTG9nKCk7XG4gICAgICAgIF9IdHRwQWdlbnRfcXVlcnlQaXBlbGluZS5zZXQodGhpcywgW10pO1xuICAgICAgICBfSHR0cEFnZW50X3VwZGF0ZVBpcGVsaW5lLnNldCh0aGlzLCBbXSk7XG4gICAgICAgIF9IdHRwQWdlbnRfc3VibmV0S2V5cy5zZXQodGhpcywgbmV3IEV4cGlyYWJsZU1hcCh7XG4gICAgICAgICAgICBleHBpcmF0aW9uVGltZTogNSAqIDYwICogMTAwMCwgLy8gNSBtaW51dGVzXG4gICAgICAgIH0pKTtcbiAgICAgICAgX0h0dHBBZ2VudF92ZXJpZnlRdWVyeVNpZ25hdHVyZXMuc2V0KHRoaXMsIHRydWUpO1xuICAgICAgICAvKipcbiAgICAgICAgICogU2VlIGh0dHBzOi8vaW50ZXJuZXRjb21wdXRlci5vcmcvZG9jcy9jdXJyZW50L3JlZmVyZW5jZXMvaWMtaW50ZXJmYWNlLXNwZWMvI2h0dHAtcXVlcnkgZm9yIGRldGFpbHMgb24gdmFsaWRhdGlvblxuICAgICAgICAgKiBAcGFyYW0gcXVlcnlSZXNwb25zZSAtIFRoZSByZXNwb25zZSBmcm9tIHRoZSBxdWVyeVxuICAgICAgICAgKiBAcGFyYW0gc3VibmV0U3RhdHVzIC0gVGhlIHN1Ym5ldCBzdGF0dXMsIGluY2x1ZGluZyBhbGwgbm9kZSBrZXlzXG4gICAgICAgICAqIEByZXR1cm5zIEFwaVF1ZXJ5UmVzcG9uc2VcbiAgICAgICAgICovXG4gICAgICAgIF9IdHRwQWdlbnRfdmVyaWZ5UXVlcnlSZXNwb25zZS5zZXQodGhpcywgKHF1ZXJ5UmVzcG9uc2UsIHN1Ym5ldFN0YXR1cykgPT4ge1xuICAgICAgICAgICAgaWYgKF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF92ZXJpZnlRdWVyeVNpZ25hdHVyZXMsIFwiZlwiKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIHNob3VsZCBub3QgYmUgY2FsbGVkIGlmIHRoZSB1c2VyIGhhcyBkaXNhYmxlZCB2ZXJpZmljYXRpb25cbiAgICAgICAgICAgICAgICByZXR1cm4gcXVlcnlSZXNwb25zZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghc3VibmV0U3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IENlcnRpZmljYXRlVmVyaWZpY2F0aW9uRXJyb3IoJ0ludmFsaWQgc2lnbmF0dXJlIGZyb20gcmVwbGljYSBzaWduZWQgcXVlcnk6IG5vIG1hdGNoaW5nIG5vZGUga2V5IGZvdW5kLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgeyBzdGF0dXMsIHNpZ25hdHVyZXMgPSBbXSwgcmVxdWVzdElkIH0gPSBxdWVyeVJlc3BvbnNlO1xuICAgICAgICAgICAgY29uc3QgZG9tYWluU2VwYXJhdG9yID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKCdcXHgwQmljLXJlc3BvbnNlJyk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHNpZyBvZiBzaWduYXR1cmVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyB0aW1lc3RhbXAsIGlkZW50aXR5IH0gPSBzaWc7XG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZUlkID0gUHJpbmNpcGFsLmZyb21VaW50OEFycmF5KGlkZW50aXR5KS50b1RleHQoKTtcbiAgICAgICAgICAgICAgICBsZXQgaGFzaDtcbiAgICAgICAgICAgICAgICAvLyBIYXNoIGlzIGNvbnN0cnVjdGVkIGRpZmZlcmVudGx5IGRlcGVuZGluZyBvbiB0aGUgc3RhdHVzXG4gICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gJ3JlcGxpZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgcmVwbHkgfSA9IHF1ZXJ5UmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgICAgIGhhc2ggPSBoYXNoT2ZNYXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBzdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXBseTogcmVwbHksXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IEJpZ0ludCh0aW1lc3RhbXApLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdF9pZDogcmVxdWVzdElkLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoc3RhdHVzID09PSAncmVqZWN0ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgcmVqZWN0X2NvZGUsIHJlamVjdF9tZXNzYWdlLCBlcnJvcl9jb2RlIH0gPSBxdWVyeVJlc3BvbnNlO1xuICAgICAgICAgICAgICAgICAgICBoYXNoID0gaGFzaE9mTWFwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0X2NvZGU6IHJlamVjdF9jb2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0X21lc3NhZ2U6IHJlamVjdF9tZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfY29kZTogZXJyb3JfY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogQmlnSW50KHRpbWVzdGFtcCksXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0X2lkOiByZXF1ZXN0SWQsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHN0YXR1czogJHtzdGF0dXN9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHNlcGFyYXRvcldpdGhIYXNoID0gY29uY2F0KGRvbWFpblNlcGFyYXRvciwgbmV3IFVpbnQ4QXJyYXkoaGFzaCkpO1xuICAgICAgICAgICAgICAgIC8vIEZJWDogY2hlY2sgZm9yIG1hdGNoIHdpdGhvdXQgdmVyaWZ5aW5nIE4gdGltZXNcbiAgICAgICAgICAgICAgICBjb25zdCBwdWJLZXkgPSBzdWJuZXRTdGF0dXMgPT09IG51bGwgfHwgc3VibmV0U3RhdHVzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdWJuZXRTdGF0dXMubm9kZUtleXMuZ2V0KG5vZGVJZCk7XG4gICAgICAgICAgICAgICAgaWYgKCFwdWJLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IENlcnRpZmljYXRlVmVyaWZpY2F0aW9uRXJyb3IoJ0ludmFsaWQgc2lnbmF0dXJlIGZyb20gcmVwbGljYSBzaWduZWQgcXVlcnk6IG5vIG1hdGNoaW5nIG5vZGUga2V5IGZvdW5kLicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCByYXdLZXkgPSBFZDI1NTE5UHVibGljS2V5LmZyb21EZXIocHViS2V5KS5yYXdLZXk7XG4gICAgICAgICAgICAgICAgY29uc3QgdmFsaWQgPSBlZDI1NTE5LnZlcmlmeShzaWcuc2lnbmF0dXJlLCBuZXcgVWludDhBcnJheShzZXBhcmF0b3JXaXRoSGFzaCksIG5ldyBVaW50OEFycmF5KHJhd0tleSkpO1xuICAgICAgICAgICAgICAgIGlmICh2YWxpZClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5UmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IENlcnRpZmljYXRlVmVyaWZpY2F0aW9uRXJyb3IoYEludmFsaWQgc2lnbmF0dXJlIGZyb20gcmVwbGljYSAke25vZGVJZH0gc2lnbmVkIHF1ZXJ5LmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5UmVzcG9uc2U7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAob3B0aW9ucy5zb3VyY2UpIHtcbiAgICAgICAgICAgIGlmICghKG9wdGlvbnMuc291cmNlIGluc3RhbmNlb2YgSHR0cEFnZW50KSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFuIEFnZW50J3Mgc291cmNlIGNhbiBvbmx5IGJlIGFub3RoZXIgSHR0cEFnZW50XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5faWRlbnRpdHkgPSBvcHRpb25zLnNvdXJjZS5faWRlbnRpdHk7XG4gICAgICAgICAgICB0aGlzLl9mZXRjaCA9IG9wdGlvbnMuc291cmNlLl9mZXRjaDtcbiAgICAgICAgICAgIHRoaXMuX2hvc3QgPSBvcHRpb25zLnNvdXJjZS5faG9zdDtcbiAgICAgICAgICAgIHRoaXMuX2NyZWRlbnRpYWxzID0gb3B0aW9ucy5zb3VyY2UuX2NyZWRlbnRpYWxzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fZmV0Y2ggPSBvcHRpb25zLmZldGNoIHx8IGdldERlZmF1bHRGZXRjaCgpIHx8IGZldGNoLmJpbmQoZ2xvYmFsKTtcbiAgICAgICAgICAgIHRoaXMuX2ZldGNoT3B0aW9ucyA9IG9wdGlvbnMuZmV0Y2hPcHRpb25zO1xuICAgICAgICAgICAgdGhpcy5fY2FsbE9wdGlvbnMgPSBvcHRpb25zLmNhbGxPcHRpb25zO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmhvc3QgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKCFvcHRpb25zLmhvc3QubWF0Y2goL15bYS16XSs6LykgJiYgdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9ob3N0ID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgKyAnLy8nICsgb3B0aW9ucy5ob3N0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2hvc3QgPSBuZXcgVVJMKG9wdGlvbnMuaG9zdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3B0aW9ucy5zb3VyY2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy8gU2FmZSB0byBpZ25vcmUgaGVyZS5cbiAgICAgICAgICAgIHRoaXMuX2hvc3QgPSBvcHRpb25zLnNvdXJjZS5faG9zdDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGxvY2F0aW9uID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cubG9jYXRpb24gOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICBpZiAoIWxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faG9zdCA9IG5ldyBVUkwoJ2h0dHBzOi8vaWNwLWFwaS5pbycpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9nLndhcm4oJ0NvdWxkIG5vdCBpbmZlciBob3N0IGZyb20gd2luZG93LmxvY2F0aW9uLCBkZWZhdWx0aW5nIHRvIG1haW5uZXQgZ2F0ZXdheSBvZiBodHRwczovL2ljcC1hcGkuaW8uIFBsZWFzZSBwcm92aWRlIGEgaG9zdCB0byB0aGUgSHR0cEFnZW50IGNvbnN0cnVjdG9yIHRvIGF2b2lkIHRoaXMgd2FybmluZy4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIE1haW5uZXQsIGxvY2FsLCBhbmQgcmVtb3RlIGVudmlyb25tZW50cyB3aWxsIGhhdmUgdGhlIGFwaSByb3V0ZSBhdmFpbGFibGVcbiAgICAgICAgICAgIGNvbnN0IGtub3duSG9zdHMgPSBbJ2ljMC5hcHAnLCAnaWNwMC5pbycsICcxMjcuMC4wLjEnLCAnbG9jYWxob3N0J107XG4gICAgICAgICAgICBjb25zdCByZW1vdGVIb3N0cyA9IFsnLmdpdGh1Yi5kZXYnLCAnLmdpdHBvZC5pbyddO1xuICAgICAgICAgICAgY29uc3QgaG9zdG5hbWUgPSBsb2NhdGlvbiA9PT0gbnVsbCB8fCBsb2NhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogbG9jYXRpb24uaG9zdG5hbWU7XG4gICAgICAgICAgICBsZXQga25vd25Ib3N0O1xuICAgICAgICAgICAgaWYgKGhvc3RuYW1lICYmIHR5cGVvZiBob3N0bmFtZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVtb3RlSG9zdHMuc29tZShob3N0ID0+IGhvc3RuYW1lLmVuZHNXaXRoKGhvc3QpKSkge1xuICAgICAgICAgICAgICAgICAgICBrbm93bkhvc3QgPSBob3N0bmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGtub3duSG9zdCA9IGtub3duSG9zdHMuZmluZChob3N0ID0+IGhvc3RuYW1lLmVuZHNXaXRoKGhvc3QpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobG9jYXRpb24gJiYga25vd25Ib3N0KSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIHVzZXIgaXMgb24gYSBib3VuZGFyeS1ub2RlIHByb3ZpZGVkIGhvc3QsIHdlIGNhbiB1c2UgdGhlIHNhbWUgaG9zdCBmb3IgdGhlIGFnZW50XG4gICAgICAgICAgICAgICAgdGhpcy5faG9zdCA9IG5ldyBVUkwoYCR7bG9jYXRpb24ucHJvdG9jb2x9Ly8ke2tub3duSG9zdH0ke2xvY2F0aW9uLnBvcnQgPyAnOicgKyBsb2NhdGlvbi5wb3J0IDogJyd9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9ob3N0ID0gbmV3IFVSTCgnaHR0cHM6Ly9pY3AtYXBpLmlvJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2cud2FybignQ291bGQgbm90IGluZmVyIGhvc3QgZnJvbSB3aW5kb3cubG9jYXRpb24sIGRlZmF1bHRpbmcgdG8gbWFpbm5ldCBnYXRld2F5IG9mIGh0dHBzOi8vaWNwLWFwaS5pby4gUGxlYXNlIHByb3ZpZGUgYSBob3N0IHRvIHRoZSBIdHRwQWdlbnQgY29uc3RydWN0b3IgdG8gYXZvaWQgdGhpcyB3YXJuaW5nLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLnZlcmlmeVF1ZXJ5U2lnbmF0dXJlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9IdHRwQWdlbnRfdmVyaWZ5UXVlcnlTaWduYXR1cmVzLCBvcHRpb25zLnZlcmlmeVF1ZXJ5U2lnbmF0dXJlcywgXCJmXCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIERlZmF1bHQgaXMgM1xuICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9IdHRwQWdlbnRfcmV0cnlUaW1lcywgKF9hID0gb3B0aW9ucy5yZXRyeVRpbWVzKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAzLCBcImZcIik7XG4gICAgICAgIC8vIERlbGF5IHN0cmF0ZWd5IGZvciByZXRyaWVzLiBEZWZhdWx0IGlzIGV4cG9uZW50aWFsIGJhY2tvZmZcbiAgICAgICAgY29uc3QgZGVmYXVsdEJhY2tvZmZGYWN0b3J5ID0gKCkgPT4gbmV3IEV4cG9uZW50aWFsQmFja29mZih7XG4gICAgICAgICAgICBtYXhJdGVyYXRpb25zOiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9IdHRwQWdlbnRfcmV0cnlUaW1lcywgXCJmXCIpLFxuICAgICAgICB9KTtcbiAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfSHR0cEFnZW50X2JhY2tvZmZTdHJhdGVneSwgb3B0aW9ucy5iYWNrb2ZmU3RyYXRlZ3kgfHwgZGVmYXVsdEJhY2tvZmZGYWN0b3J5LCBcImZcIik7XG4gICAgICAgIC8vIFJld3JpdGUgdG8gYXZvaWQgcmVkaXJlY3RzXG4gICAgICAgIGlmICh0aGlzLl9ob3N0Lmhvc3RuYW1lLmVuZHNXaXRoKElDMF9TVUJfRE9NQUlOKSkge1xuICAgICAgICAgICAgdGhpcy5faG9zdC5ob3N0bmFtZSA9IElDMF9ET01BSU47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5faG9zdC5ob3N0bmFtZS5lbmRzV2l0aChJQ1AwX1NVQl9ET01BSU4pKSB7XG4gICAgICAgICAgICB0aGlzLl9ob3N0Lmhvc3RuYW1lID0gSUNQMF9ET01BSU47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5faG9zdC5ob3N0bmFtZS5lbmRzV2l0aChJQ1BfQVBJX1NVQl9ET01BSU4pKSB7XG4gICAgICAgICAgICB0aGlzLl9ob3N0Lmhvc3RuYW1lID0gSUNQX0FQSV9ET01BSU47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMuY3JlZGVudGlhbHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgbmFtZSwgcGFzc3dvcmQgfSA9IG9wdGlvbnMuY3JlZGVudGlhbHM7XG4gICAgICAgICAgICB0aGlzLl9jcmVkZW50aWFscyA9IGAke25hbWV9JHtwYXNzd29yZCA/ICc6JyArIHBhc3N3b3JkIDogJyd9YDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pZGVudGl0eSA9IFByb21pc2UucmVzb2x2ZShvcHRpb25zLmlkZW50aXR5IHx8IG5ldyBBbm9ueW1vdXNJZGVudGl0eSgpKTtcbiAgICAgICAgLy8gQWRkIGEgbm9uY2UgdHJhbnNmb3JtIHRvIGVuc3VyZSBjYWxscyBhcmUgdW5pcXVlXG4gICAgICAgIHRoaXMuYWRkVHJhbnNmb3JtKCd1cGRhdGUnLCBtYWtlTm9uY2VUcmFuc2Zvcm0obWFrZU5vbmNlKSk7XG4gICAgICAgIGlmIChvcHRpb25zLnVzZVF1ZXJ5Tm9uY2VzKSB7XG4gICAgICAgICAgICB0aGlzLmFkZFRyYW5zZm9ybSgncXVlcnknLCBtYWtlTm9uY2VUcmFuc2Zvcm0obWFrZU5vbmNlKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMubG9nVG9Db25zb2xlKSB7XG4gICAgICAgICAgICB0aGlzLmxvZy5zdWJzY3JpYmUobG9nID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobG9nLmxldmVsID09PSAnZXJyb3InKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IobG9nLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChsb2cubGV2ZWwgPT09ICd3YXJuJykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4obG9nLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobG9nLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCB3YXRlck1hcmsoKSB7XG4gICAgICAgIHJldHVybiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9IdHRwQWdlbnRfd2F0ZXJNYXJrLCBcImZcIik7XG4gICAgfVxuICAgIGlzTG9jYWwoKSB7XG4gICAgICAgIGNvbnN0IGhvc3RuYW1lID0gdGhpcy5faG9zdC5ob3N0bmFtZTtcbiAgICAgICAgcmV0dXJuIGhvc3RuYW1lID09PSAnMTI3LjAuMC4xJyB8fCBob3N0bmFtZS5lbmRzV2l0aCgnMTI3LjAuMC4xJyk7XG4gICAgfVxuICAgIGFkZFRyYW5zZm9ybSh0eXBlLCBmbiwgcHJpb3JpdHkgPSBmbi5wcmlvcml0eSB8fCAwKSB7XG4gICAgICAgIGlmICh0eXBlID09PSAndXBkYXRlJykge1xuICAgICAgICAgICAgLy8gS2VlcCB0aGUgcGlwZWxpbmUgc29ydGVkIGF0IGFsbCB0aW1lLCBieSBwcmlvcml0eS5cbiAgICAgICAgICAgIGNvbnN0IGkgPSBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9IdHRwQWdlbnRfdXBkYXRlUGlwZWxpbmUsIFwiZlwiKS5maW5kSW5kZXgoeCA9PiAoeC5wcmlvcml0eSB8fCAwKSA8IHByaW9yaXR5KTtcbiAgICAgICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF91cGRhdGVQaXBlbGluZSwgXCJmXCIpLnNwbGljZShpID49IDAgPyBpIDogX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfSHR0cEFnZW50X3VwZGF0ZVBpcGVsaW5lLCBcImZcIikubGVuZ3RoLCAwLCBPYmplY3QuYXNzaWduKGZuLCB7IHByaW9yaXR5IH0pKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlID09PSAncXVlcnknKSB7XG4gICAgICAgICAgICAvLyBLZWVwIHRoZSBwaXBlbGluZSBzb3J0ZWQgYXQgYWxsIHRpbWUsIGJ5IHByaW9yaXR5LlxuICAgICAgICAgICAgY29uc3QgaSA9IF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF9xdWVyeVBpcGVsaW5lLCBcImZcIikuZmluZEluZGV4KHggPT4gKHgucHJpb3JpdHkgfHwgMCkgPCBwcmlvcml0eSk7XG4gICAgICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9IdHRwQWdlbnRfcXVlcnlQaXBlbGluZSwgXCJmXCIpLnNwbGljZShpID49IDAgPyBpIDogX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfSHR0cEFnZW50X3F1ZXJ5UGlwZWxpbmUsIFwiZlwiKS5sZW5ndGgsIDAsIE9iamVjdC5hc3NpZ24oZm4sIHsgcHJpb3JpdHkgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIGdldFByaW5jaXBhbCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9pZGVudGl0eSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IElkZW50aXR5SW52YWxpZEVycm9yKFwiVGhpcyBpZGVudGl0eSBoYXMgZXhwaXJlZCBkdWUgdGhpcyBhcHBsaWNhdGlvbidzIHNlY3VyaXR5IHBvbGljeS4gUGxlYXNlIHJlZnJlc2ggeW91ciBhdXRoZW50aWNhdGlvbi5cIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChhd2FpdCB0aGlzLl9pZGVudGl0eSkuZ2V0UHJpbmNpcGFsKCk7XG4gICAgfVxuICAgIGFzeW5jIGNhbGwoY2FuaXN0ZXJJZCwgb3B0aW9ucywgaWRlbnRpdHkpIHtcbiAgICAgICAgY29uc3QgaWQgPSBhd2FpdCAoaWRlbnRpdHkgIT09IHVuZGVmaW5lZCA/IGF3YWl0IGlkZW50aXR5IDogYXdhaXQgdGhpcy5faWRlbnRpdHkpO1xuICAgICAgICBpZiAoIWlkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSWRlbnRpdHlJbnZhbGlkRXJyb3IoXCJUaGlzIGlkZW50aXR5IGhhcyBleHBpcmVkIGR1ZSB0aGlzIGFwcGxpY2F0aW9uJ3Mgc2VjdXJpdHkgcG9saWN5LiBQbGVhc2UgcmVmcmVzaCB5b3VyIGF1dGhlbnRpY2F0aW9uLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjYW5pc3RlciA9IFByaW5jaXBhbC5mcm9tKGNhbmlzdGVySWQpO1xuICAgICAgICBjb25zdCBlY2lkID0gb3B0aW9ucy5lZmZlY3RpdmVDYW5pc3RlcklkXG4gICAgICAgICAgICA/IFByaW5jaXBhbC5mcm9tKG9wdGlvbnMuZWZmZWN0aXZlQ2FuaXN0ZXJJZClcbiAgICAgICAgICAgIDogY2FuaXN0ZXI7XG4gICAgICAgIGNvbnN0IHNlbmRlciA9IGlkLmdldFByaW5jaXBhbCgpIHx8IFByaW5jaXBhbC5hbm9ueW1vdXMoKTtcbiAgICAgICAgbGV0IGluZ3Jlc3NfZXhwaXJ5ID0gbmV3IEV4cGlyeShERUZBVUxUX0lOR1JFU1NfRVhQSVJZX0RFTFRBX0lOX01TRUNTKTtcbiAgICAgICAgLy8gSWYgdGhlIHZhbHVlIGlzIG9mZiBieSBtb3JlIHRoYW4gMzAgc2Vjb25kcywgcmVjb25jaWxlIHN5c3RlbSB0aW1lIHdpdGggdGhlIG5ldHdvcmtcbiAgICAgICAgaWYgKE1hdGguYWJzKHRoaXMuX3RpbWVEaWZmTXNlY3MpID4gMTAwMCAqIDMwKSB7XG4gICAgICAgICAgICBpbmdyZXNzX2V4cGlyeSA9IG5ldyBFeHBpcnkoREVGQVVMVF9JTkdSRVNTX0VYUElSWV9ERUxUQV9JTl9NU0VDUyArIHRoaXMuX3RpbWVEaWZmTXNlY3MpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN1Ym1pdCA9IHtcbiAgICAgICAgICAgIHJlcXVlc3RfdHlwZTogU3VibWl0UmVxdWVzdFR5cGUuQ2FsbCxcbiAgICAgICAgICAgIGNhbmlzdGVyX2lkOiBjYW5pc3RlcixcbiAgICAgICAgICAgIG1ldGhvZF9uYW1lOiBvcHRpb25zLm1ldGhvZE5hbWUsXG4gICAgICAgICAgICBhcmc6IG9wdGlvbnMuYXJnLFxuICAgICAgICAgICAgc2VuZGVyLFxuICAgICAgICAgICAgaW5ncmVzc19leHBpcnksXG4gICAgICAgIH07XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIGxldCB0cmFuc2Zvcm1lZFJlcXVlc3QgPSAoYXdhaXQgdGhpcy5fdHJhbnNmb3JtKHtcbiAgICAgICAgICAgIHJlcXVlc3Q6IHtcbiAgICAgICAgICAgICAgICBib2R5OiBudWxsLFxuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IE9iamVjdC5hc3NpZ24oeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2Nib3InIH0sICh0aGlzLl9jcmVkZW50aWFscyA/IHsgQXV0aG9yaXphdGlvbjogJ0Jhc2ljICcgKyBidG9hKHRoaXMuX2NyZWRlbnRpYWxzKSB9IDoge30pKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbmRwb2ludDogXCJjYWxsXCIgLyogRW5kcG9pbnQuQ2FsbCAqLyxcbiAgICAgICAgICAgIGJvZHk6IHN1Ym1pdCxcbiAgICAgICAgfSkpO1xuICAgICAgICAvLyBBcHBseSB0cmFuc2Zvcm0gZm9yIGlkZW50aXR5LlxuICAgICAgICB0cmFuc2Zvcm1lZFJlcXVlc3QgPSBhd2FpdCBpZC50cmFuc2Zvcm1SZXF1ZXN0KHRyYW5zZm9ybWVkUmVxdWVzdCk7XG4gICAgICAgIGNvbnN0IGJvZHkgPSBjYm9yLmVuY29kZSh0cmFuc2Zvcm1lZFJlcXVlc3QuYm9keSk7XG4gICAgICAgIHRoaXMubG9nLnByaW50KGBmZXRjaGluZyBcIi9hcGkvdjIvY2FuaXN0ZXIvJHtlY2lkLnRvVGV4dCgpfS9jYWxsXCIgd2l0aCByZXF1ZXN0OmAsIHRyYW5zZm9ybWVkUmVxdWVzdCk7XG4gICAgICAgIC8vIFJ1biBib3RoIGluIHBhcmFsbGVsLiBUaGUgZmV0Y2ggaXMgcXVpdGUgZXhwZW5zaXZlLCBzbyB3ZSBoYXZlIHBsZW50eSBvZiB0aW1lIHRvXG4gICAgICAgIC8vIGNhbGN1bGF0ZSB0aGUgcmVxdWVzdElkIGxvY2FsbHkuXG4gICAgICAgIGNvbnN0IGJhY2tvZmYgPSBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9IdHRwQWdlbnRfYmFja29mZlN0cmF0ZWd5LCBcImZcIikuY2FsbCh0aGlzKTtcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF9pbnN0YW5jZXMsIFwibVwiLCBfSHR0cEFnZW50X3JlcXVlc3RBbmRSZXRyeSkuY2FsbCh0aGlzLCB7XG4gICAgICAgICAgICByZXF1ZXN0OiAoKSA9PiB0aGlzLl9mZXRjaCgnJyArIG5ldyBVUkwoYC9hcGkvdjIvY2FuaXN0ZXIvJHtlY2lkLnRvVGV4dCgpfS9jYWxsYCwgdGhpcy5faG9zdCksIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB0aGlzLl9jYWxsT3B0aW9ucyksIHRyYW5zZm9ybWVkUmVxdWVzdC5yZXF1ZXN0KSwgeyBib2R5IH0pKSxcbiAgICAgICAgICAgIGJhY2tvZmYsXG4gICAgICAgICAgICB0cmllczogMCxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IFtyZXNwb25zZSwgcmVxdWVzdElkXSA9IGF3YWl0IFByb21pc2UuYWxsKFtyZXF1ZXN0LCByZXF1ZXN0SWRPZihzdWJtaXQpXSk7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlQnVmZmVyID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2VCb2R5ID0gKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwICYmIHJlc3BvbnNlQnVmZmVyLmJ5dGVMZW5ndGggPiAwID8gY2Jvci5kZWNvZGUocmVzcG9uc2VCdWZmZXIpIDogbnVsbCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXF1ZXN0SWQsXG4gICAgICAgICAgICByZXNwb25zZToge1xuICAgICAgICAgICAgICAgIG9rOiByZXNwb25zZS5vayxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OiByZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICAgICAgICAgIGJvZHk6IHJlc3BvbnNlQm9keSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiBodHRwSGVhZGVyc1RyYW5zZm9ybShyZXNwb25zZS5oZWFkZXJzKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgfVxuICAgIGFzeW5jIHF1ZXJ5KGNhbmlzdGVySWQsIGZpZWxkcywgaWRlbnRpdHkpIHtcbiAgICAgICAgY29uc3QgYmFja29mZiA9IF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF9iYWNrb2ZmU3RyYXRlZ3ksIFwiZlwiKS5jYWxsKHRoaXMpO1xuICAgICAgICBjb25zdCBlY2lkID0gZmllbGRzLmVmZmVjdGl2ZUNhbmlzdGVySWRcbiAgICAgICAgICAgID8gUHJpbmNpcGFsLmZyb20oZmllbGRzLmVmZmVjdGl2ZUNhbmlzdGVySWQpXG4gICAgICAgICAgICA6IFByaW5jaXBhbC5mcm9tKGNhbmlzdGVySWQpO1xuICAgICAgICB0aGlzLmxvZy5wcmludChgZWNpZCAke2VjaWQudG9TdHJpbmcoKX1gKTtcbiAgICAgICAgdGhpcy5sb2cucHJpbnQoYGNhbmlzdGVySWQgJHtjYW5pc3RlcklkLnRvU3RyaW5nKCl9YCk7XG4gICAgICAgIGNvbnN0IG1ha2VRdWVyeSA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gYXdhaXQgKGlkZW50aXR5ICE9PSB1bmRlZmluZWQgPyBhd2FpdCBpZGVudGl0eSA6IGF3YWl0IHRoaXMuX2lkZW50aXR5KTtcbiAgICAgICAgICAgIGlmICghaWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWRlbnRpdHlJbnZhbGlkRXJyb3IoXCJUaGlzIGlkZW50aXR5IGhhcyBleHBpcmVkIGR1ZSB0aGlzIGFwcGxpY2F0aW9uJ3Mgc2VjdXJpdHkgcG9saWN5LiBQbGVhc2UgcmVmcmVzaCB5b3VyIGF1dGhlbnRpY2F0aW9uLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGNhbmlzdGVyID0gUHJpbmNpcGFsLmZyb20oY2FuaXN0ZXJJZCk7XG4gICAgICAgICAgICBjb25zdCBzZW5kZXIgPSAoaWQgPT09IG51bGwgfHwgaWQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGlkLmdldFByaW5jaXBhbCgpKSB8fCBQcmluY2lwYWwuYW5vbnltb3VzKCk7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHJlcXVlc3RfdHlwZTogXCJxdWVyeVwiIC8qIFJlYWRSZXF1ZXN0VHlwZS5RdWVyeSAqLyxcbiAgICAgICAgICAgICAgICBjYW5pc3Rlcl9pZDogY2FuaXN0ZXIsXG4gICAgICAgICAgICAgICAgbWV0aG9kX25hbWU6IGZpZWxkcy5tZXRob2ROYW1lLFxuICAgICAgICAgICAgICAgIGFyZzogZmllbGRzLmFyZyxcbiAgICAgICAgICAgICAgICBzZW5kZXIsXG4gICAgICAgICAgICAgICAgaW5ncmVzc19leHBpcnk6IG5ldyBFeHBpcnkoREVGQVVMVF9JTkdSRVNTX0VYUElSWV9ERUxUQV9JTl9NU0VDUyksXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdElkID0gYXdhaXQgcmVxdWVzdElkT2YocmVxdWVzdCk7XG4gICAgICAgICAgICAvLyBUT0RPOiByZW1vdmUgdGhpcyBhbnkuIFRoaXMgY2FuIGJlIGEgU2lnbmVkIG9yIFVuU2lnbmVkIHJlcXVlc3QuXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgbGV0IHRyYW5zZm9ybWVkUmVxdWVzdCA9IGF3YWl0IHRoaXMuX3RyYW5zZm9ybSh7XG4gICAgICAgICAgICAgICAgcmVxdWVzdDoge1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogT2JqZWN0LmFzc2lnbih7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vY2JvcicgfSwgKHRoaXMuX2NyZWRlbnRpYWxzID8geyBBdXRob3JpemF0aW9uOiAnQmFzaWMgJyArIGJ0b2EodGhpcy5fY3JlZGVudGlhbHMpIH0gOiB7fSkpLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZW5kcG9pbnQ6IFwicmVhZFwiIC8qIEVuZHBvaW50LlF1ZXJ5ICovLFxuICAgICAgICAgICAgICAgIGJvZHk6IHJlcXVlc3QsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIEFwcGx5IHRyYW5zZm9ybSBmb3IgaWRlbnRpdHkuXG4gICAgICAgICAgICB0cmFuc2Zvcm1lZFJlcXVlc3QgPSAoYXdhaXQgKGlkID09PSBudWxsIHx8IGlkID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpZC50cmFuc2Zvcm1SZXF1ZXN0KHRyYW5zZm9ybWVkUmVxdWVzdCkpKTtcbiAgICAgICAgICAgIGNvbnN0IGJvZHkgPSBjYm9yLmVuY29kZSh0cmFuc2Zvcm1lZFJlcXVlc3QuYm9keSk7XG4gICAgICAgICAgICBjb25zdCBhcmdzID0ge1xuICAgICAgICAgICAgICAgIGNhbmlzdGVyOiBjYW5pc3Rlci50b1RleHQoKSxcbiAgICAgICAgICAgICAgICBlY2lkLFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybWVkUmVxdWVzdCxcbiAgICAgICAgICAgICAgICBib2R5LFxuICAgICAgICAgICAgICAgIHJlcXVlc3RJZCxcbiAgICAgICAgICAgICAgICBiYWNrb2ZmLFxuICAgICAgICAgICAgICAgIHRyaWVzOiAwLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9IdHRwQWdlbnRfaW5zdGFuY2VzLCBcIm1cIiwgX0h0dHBBZ2VudF9yZXF1ZXN0QW5kUmV0cnlRdWVyeSkuY2FsbCh0aGlzLCBhcmdzKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZ2V0U3VibmV0U3RhdHVzID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9IdHRwQWdlbnRfdmVyaWZ5UXVlcnlTaWduYXR1cmVzLCBcImZcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgc3VibmV0U3RhdHVzID0gX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfSHR0cEFnZW50X3N1Ym5ldEtleXMsIFwiZlwiKS5nZXQoZWNpZC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIGlmIChzdWJuZXRTdGF0dXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VibmV0U3RhdHVzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5mZXRjaFN1Ym5ldEtleXMoZWNpZC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIHJldHVybiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9IdHRwQWdlbnRfc3VibmV0S2V5cywgXCJmXCIpLmdldChlY2lkLnRvU3RyaW5nKCkpO1xuICAgICAgICB9O1xuICAgICAgICAvLyBBdHRlbXB0IHRvIG1ha2UgdGhlIHF1ZXJ5IGk9cmV0cnlUaW1lcyB0aW1lc1xuICAgICAgICAvLyBNYWtlIHF1ZXJ5IGFuZCBmZXRjaCBzdWJuZXQga2V5cyBpbiBwYXJhbGxlbFxuICAgICAgICBjb25zdCBbcXVlcnksIHN1Ym5ldFN0YXR1c10gPSBhd2FpdCBQcm9taXNlLmFsbChbbWFrZVF1ZXJ5KCksIGdldFN1Ym5ldFN0YXR1cygpXSk7XG4gICAgICAgIHRoaXMubG9nLnByaW50KCdRdWVyeSByZXNwb25zZTonLCBxdWVyeSk7XG4gICAgICAgIC8vIFNraXAgdmVyaWZpY2F0aW9uIGlmIHRoZSB1c2VyIGhhcyBkaXNhYmxlZCBpdFxuICAgICAgICBpZiAoIV9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF92ZXJpZnlRdWVyeVNpZ25hdHVyZXMsIFwiZlwiKSkge1xuICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5O1xuICAgICAgICB9XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfSHR0cEFnZW50X3ZlcmlmeVF1ZXJ5UmVzcG9uc2UsIFwiZlwiKS5jYWxsKHRoaXMsIHF1ZXJ5LCBzdWJuZXRTdGF0dXMpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChfKSB7XG4gICAgICAgICAgICAvLyBJbiBjYXNlIHRoZSBub2RlIHNpZ25hdHVyZXMgaGF2ZSBjaGFuZ2VkLCByZWZyZXNoIHRoZSBzdWJuZXQga2V5cyBhbmQgdHJ5IGFnYWluXG4gICAgICAgICAgICB0aGlzLmxvZy53YXJuKCdRdWVyeSByZXNwb25zZSB2ZXJpZmljYXRpb24gZmFpbGVkLiBSZXRyeWluZyB3aXRoIGZyZXNoIHN1Ym5ldCBrZXlzLicpO1xuICAgICAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfSHR0cEFnZW50X3N1Ym5ldEtleXMsIFwiZlwiKS5kZWxldGUoY2FuaXN0ZXJJZC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZmV0Y2hTdWJuZXRLZXlzKGVjaWQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkU3VibmV0U3RhdHVzID0gX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfSHR0cEFnZW50X3N1Ym5ldEtleXMsIFwiZlwiKS5nZXQoY2FuaXN0ZXJJZC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIGlmICghdXBkYXRlZFN1Ym5ldFN0YXR1cykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBDZXJ0aWZpY2F0ZVZlcmlmaWNhdGlvbkVycm9yKCdJbnZhbGlkIHNpZ25hdHVyZSBmcm9tIHJlcGxpY2Egc2lnbmVkIHF1ZXJ5OiBubyBtYXRjaGluZyBub2RlIGtleSBmb3VuZC4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9IdHRwQWdlbnRfdmVyaWZ5UXVlcnlSZXNwb25zZSwgXCJmXCIpLmNhbGwodGhpcywgcXVlcnksIHVwZGF0ZWRTdWJuZXRTdGF0dXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIGNyZWF0ZVJlYWRTdGF0ZVJlcXVlc3QoZmllbGRzLCBpZGVudGl0eSkge1xuICAgICAgICBjb25zdCBpZCA9IGF3YWl0IChpZGVudGl0eSAhPT0gdW5kZWZpbmVkID8gYXdhaXQgaWRlbnRpdHkgOiBhd2FpdCB0aGlzLl9pZGVudGl0eSk7XG4gICAgICAgIGlmICghaWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJZGVudGl0eUludmFsaWRFcnJvcihcIlRoaXMgaWRlbnRpdHkgaGFzIGV4cGlyZWQgZHVlIHRoaXMgYXBwbGljYXRpb24ncyBzZWN1cml0eSBwb2xpY3kuIFBsZWFzZSByZWZyZXNoIHlvdXIgYXV0aGVudGljYXRpb24uXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNlbmRlciA9IChpZCA9PT0gbnVsbCB8fCBpZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogaWQuZ2V0UHJpbmNpcGFsKCkpIHx8IFByaW5jaXBhbC5hbm9ueW1vdXMoKTtcbiAgICAgICAgLy8gVE9ETzogcmVtb3ZlIHRoaXMgYW55LiBUaGlzIGNhbiBiZSBhIFNpZ25lZCBvciBVblNpZ25lZCByZXF1ZXN0LlxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICBjb25zdCB0cmFuc2Zvcm1lZFJlcXVlc3QgPSBhd2FpdCB0aGlzLl90cmFuc2Zvcm0oe1xuICAgICAgICAgICAgcmVxdWVzdDoge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IE9iamVjdC5hc3NpZ24oeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2Nib3InIH0sICh0aGlzLl9jcmVkZW50aWFscyA/IHsgQXV0aG9yaXphdGlvbjogJ0Jhc2ljICcgKyBidG9hKHRoaXMuX2NyZWRlbnRpYWxzKSB9IDoge30pKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbmRwb2ludDogXCJyZWFkX3N0YXRlXCIgLyogRW5kcG9pbnQuUmVhZFN0YXRlICovLFxuICAgICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgICAgIHJlcXVlc3RfdHlwZTogXCJyZWFkX3N0YXRlXCIgLyogUmVhZFJlcXVlc3RUeXBlLlJlYWRTdGF0ZSAqLyxcbiAgICAgICAgICAgICAgICBwYXRoczogZmllbGRzLnBhdGhzLFxuICAgICAgICAgICAgICAgIHNlbmRlcixcbiAgICAgICAgICAgICAgICBpbmdyZXNzX2V4cGlyeTogbmV3IEV4cGlyeShERUZBVUxUX0lOR1JFU1NfRVhQSVJZX0RFTFRBX0lOX01TRUNTKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICAvLyBBcHBseSB0cmFuc2Zvcm0gZm9yIGlkZW50aXR5LlxuICAgICAgICByZXR1cm4gaWQgPT09IG51bGwgfHwgaWQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGlkLnRyYW5zZm9ybVJlcXVlc3QodHJhbnNmb3JtZWRSZXF1ZXN0KTtcbiAgICB9XG4gICAgYXN5bmMgcmVhZFN0YXRlKGNhbmlzdGVySWQsIGZpZWxkcywgaWRlbnRpdHksIFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgIHJlcXVlc3QpIHtcbiAgICAgICAgY29uc3QgY2FuaXN0ZXIgPSB0eXBlb2YgY2FuaXN0ZXJJZCA9PT0gJ3N0cmluZycgPyBQcmluY2lwYWwuZnJvbVRleHQoY2FuaXN0ZXJJZCkgOiBjYW5pc3RlcklkO1xuICAgICAgICBjb25zdCB0cmFuc2Zvcm1lZFJlcXVlc3QgPSByZXF1ZXN0ICE9PSBudWxsICYmIHJlcXVlc3QgIT09IHZvaWQgMCA/IHJlcXVlc3QgOiAoYXdhaXQgdGhpcy5jcmVhdGVSZWFkU3RhdGVSZXF1ZXN0KGZpZWxkcywgaWRlbnRpdHkpKTtcbiAgICAgICAgY29uc3QgYm9keSA9IGNib3IuZW5jb2RlKHRyYW5zZm9ybWVkUmVxdWVzdC5ib2R5KTtcbiAgICAgICAgdGhpcy5sb2cucHJpbnQoYGZldGNoaW5nIFwiL2FwaS92Mi9jYW5pc3Rlci8ke2NhbmlzdGVyfS9yZWFkX3N0YXRlXCIgd2l0aCByZXF1ZXN0OmAsIHRyYW5zZm9ybWVkUmVxdWVzdCk7XG4gICAgICAgIC8vIFRPRE8gLSBodHRwczovL2RmaW5pdHkuYXRsYXNzaWFuLm5ldC9icm93c2UvU0RLLTEwOTJcbiAgICAgICAgY29uc3QgYmFja29mZiA9IF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF9iYWNrb2ZmU3RyYXRlZ3ksIFwiZlwiKS5jYWxsKHRoaXMpO1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF9pbnN0YW5jZXMsIFwibVwiLCBfSHR0cEFnZW50X3JlcXVlc3RBbmRSZXRyeSkuY2FsbCh0aGlzLCB7XG4gICAgICAgICAgICByZXF1ZXN0OiAoKSA9PiB0aGlzLl9mZXRjaCgnJyArIG5ldyBVUkwoYC9hcGkvdjIvY2FuaXN0ZXIvJHtjYW5pc3Rlci50b1N0cmluZygpfS9yZWFkX3N0YXRlYCwgdGhpcy5faG9zdCksIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB0aGlzLl9mZXRjaE9wdGlvbnMpLCB0cmFuc2Zvcm1lZFJlcXVlc3QucmVxdWVzdCksIHsgYm9keSB9KSksXG4gICAgICAgICAgICBiYWNrb2ZmLFxuICAgICAgICAgICAgdHJpZXM6IDAsXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNlcnZlciByZXR1cm5lZCBhbiBlcnJvcjpcXG5gICtcbiAgICAgICAgICAgICAgICBgICBDb2RlOiAke3Jlc3BvbnNlLnN0YXR1c30gKCR7cmVzcG9uc2Uuc3RhdHVzVGV4dH0pXFxuYCArXG4gICAgICAgICAgICAgICAgYCAgQm9keTogJHthd2FpdCByZXNwb25zZS50ZXh0KCl9XFxuYCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGVjb2RlZFJlc3BvbnNlID0gY2Jvci5kZWNvZGUoYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKSk7XG4gICAgICAgIHRoaXMubG9nLnByaW50KCdSZWFkIHN0YXRlIHJlc3BvbnNlOicsIGRlY29kZWRSZXNwb25zZSk7XG4gICAgICAgIGNvbnN0IHBhcnNlZFRpbWUgPSBhd2FpdCB0aGlzLnBhcnNlVGltZUZyb21SZXNwb25zZShkZWNvZGVkUmVzcG9uc2UpO1xuICAgICAgICBpZiAocGFyc2VkVGltZSA+IDApIHtcbiAgICAgICAgICAgIHRoaXMubG9nLnByaW50KCdSZWFkIHN0YXRlIHJlc3BvbnNlIHRpbWU6JywgcGFyc2VkVGltZSk7XG4gICAgICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9IdHRwQWdlbnRfd2F0ZXJNYXJrLCBwYXJzZWRUaW1lLCBcImZcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlY29kZWRSZXNwb25zZTtcbiAgICB9XG4gICAgYXN5bmMgcGFyc2VUaW1lRnJvbVJlc3BvbnNlKHJlc3BvbnNlKSB7XG4gICAgICAgIGxldCB0cmVlO1xuICAgICAgICBpZiAocmVzcG9uc2UuY2VydGlmaWNhdGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlY29kZWQgPSBjYm9yLmRlY29kZShyZXNwb25zZS5jZXJ0aWZpY2F0ZSk7XG4gICAgICAgICAgICBpZiAoZGVjb2RlZCAmJiAndHJlZScgaW4gZGVjb2RlZCkge1xuICAgICAgICAgICAgICAgIHRyZWUgPSBkZWNvZGVkLnRyZWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBkZWNvZGUgdGltZSBmcm9tIHJlc3BvbnNlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB0aW1lTG9va3VwID0gbG9va3VwX3BhdGgoWyd0aW1lJ10sIHRyZWUpO1xuICAgICAgICAgICAgaWYgKHRpbWVMb29rdXAuc3RhdHVzICE9PSBMb29rdXBTdGF0dXMuRm91bmQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RpbWUgd2FzIG5vdCBmb3VuZCBpbiB0aGUgcmVzcG9uc2Ugb3Igd2FzIG5vdCBpbiBpdHMgZXhwZWN0ZWQgZm9ybWF0LicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEodGltZUxvb2t1cC52YWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSAmJiAhQXJyYXlCdWZmZXIuaXNWaWV3KHRpbWVMb29rdXApKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaW1lIHdhcyBub3QgZm91bmQgaW4gdGhlIHJlc3BvbnNlIG9yIHdhcyBub3QgaW4gaXRzIGV4cGVjdGVkIGZvcm1hdC4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBkZWNvZGVUaW1lKGJ1ZkZyb21CdWZMaWtlKHRpbWVMb29rdXAudmFsdWUpKTtcbiAgICAgICAgICAgIHRoaXMubG9nLnByaW50KCdUaW1lIGZyb20gcmVzcG9uc2U6JywgZGF0ZSk7XG4gICAgICAgICAgICB0aGlzLmxvZy5wcmludCgnVGltZSBmcm9tIHJlc3BvbnNlIGluIG1pbGxpc2Vjb25kczonLCBOdW1iZXIoZGF0ZSkpO1xuICAgICAgICAgICAgcmV0dXJuIE51bWJlcihkYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubG9nLndhcm4oJ05vIGNlcnRpZmljYXRlIGZvdW5kIGluIHJlc3BvbnNlJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFsbG93cyBhZ2VudCB0byBzeW5jIGl0cyB0aW1lIHdpdGggdGhlIG5ldHdvcmsuIENhbiBiZSBjYWxsZWQgZHVyaW5nIGludGlhbGl6YXRpb24gb3IgbWlkLWxpZmVjeWNsZSBpZiB0aGUgZGV2aWNlJ3MgY2xvY2sgaGFzIGRyaWZ0ZWQgYXdheSBmcm9tIHRoZSBuZXR3b3JrIHRpbWUuIFRoaXMgaXMgbmVjZXNzYXJ5IHRvIHNldCB0aGUgRXhwaXJ5IGZvciBhIHJlcXVlc3RcbiAgICAgKiBAcGFyYW0ge1ByaW5jaXBhbH0gY2FuaXN0ZXJJZCAtIFBhc3MgYSBjYW5pc3RlciBJRCBpZiB5b3UgbmVlZCB0byBzeW5jIHRoZSB0aW1lIHdpdGggYSBwYXJ0aWN1bGFyIHJlcGxpY2EuIFVzZXMgdGhlIG1hbmFnZW1lbnQgY2FuaXN0ZXIgYnkgZGVmYXVsdFxuICAgICAqL1xuICAgIGFzeW5jIHN5bmNUaW1lKGNhbmlzdGVySWQpIHtcbiAgICAgICAgY29uc3QgQ2FuaXN0ZXJTdGF0dXMgPSBhd2FpdCBpbXBvcnQoJy4uLy4uL2NhbmlzdGVyU3RhdHVzJyk7XG4gICAgICAgIGNvbnN0IGNhbGxUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICghY2FuaXN0ZXJJZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nLnByaW50KCdTeW5jaW5nIHRpbWUgd2l0aCB0aGUgSUMuIE5vIGNhbmlzdGVySWQgcHJvdmlkZWQsIHNvIGZhbGxpbmcgYmFjayB0byByeWpsMy10eWFhYS1hYWFhYS1hYWFiYS1jYWknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHN0YXR1cyA9IGF3YWl0IENhbmlzdGVyU3RhdHVzLnJlcXVlc3Qoe1xuICAgICAgICAgICAgICAgIC8vIEZhbGwgYmFjayB3aXRoIGNhbmlzdGVySWQgb2YgdGhlIElDUCBMZWRnZXJcbiAgICAgICAgICAgICAgICBjYW5pc3RlcklkOiBjYW5pc3RlcklkICE9PSBudWxsICYmIGNhbmlzdGVySWQgIT09IHZvaWQgMCA/IGNhbmlzdGVySWQgOiBQcmluY2lwYWwuZnJvbSgncnlqbDMtdHlhYWEtYWFhYWEtYWFhYmEtY2FpJyksXG4gICAgICAgICAgICAgICAgYWdlbnQ6IHRoaXMsXG4gICAgICAgICAgICAgICAgcGF0aHM6IFsndGltZSddLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCByZXBsaWNhVGltZSA9IHN0YXR1cy5nZXQoJ3RpbWUnKTtcbiAgICAgICAgICAgIGlmIChyZXBsaWNhVGltZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVEaWZmTXNlY3MgPSBOdW1iZXIocmVwbGljYVRpbWUpIC0gTnVtYmVyKGNhbGxUaW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMubG9nLmVycm9yKCdDYXVnaHQgZXhjZXB0aW9uIHdoaWxlIGF0dGVtcHRpbmcgdG8gc3luYyB0aW1lJywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIHN0YXR1cygpIHtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHRoaXMuX2NyZWRlbnRpYWxzXG4gICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAnQmFzaWMgJyArIGJ0b2EodGhpcy5fY3JlZGVudGlhbHMpLFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgOiB7fTtcbiAgICAgICAgdGhpcy5sb2cucHJpbnQoYGZldGNoaW5nIFwiL2FwaS92Mi9zdGF0dXNcImApO1xuICAgICAgICBjb25zdCBiYWNrb2ZmID0gX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfSHR0cEFnZW50X2JhY2tvZmZTdHJhdGVneSwgXCJmXCIpLmNhbGwodGhpcyk7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfSHR0cEFnZW50X2luc3RhbmNlcywgXCJtXCIsIF9IdHRwQWdlbnRfcmVxdWVzdEFuZFJldHJ5KS5jYWxsKHRoaXMsIHtcbiAgICAgICAgICAgIGJhY2tvZmYsXG4gICAgICAgICAgICByZXF1ZXN0OiAoKSA9PiB0aGlzLl9mZXRjaCgnJyArIG5ldyBVUkwoYC9hcGkvdjIvc3RhdHVzYCwgdGhpcy5faG9zdCksIE9iamVjdC5hc3NpZ24oeyBoZWFkZXJzIH0sIHRoaXMuX2ZldGNoT3B0aW9ucykpLFxuICAgICAgICAgICAgdHJpZXM6IDAsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2Jvci5kZWNvZGUoYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKSk7XG4gICAgfVxuICAgIGFzeW5jIGZldGNoUm9vdEtleSgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9yb290S2V5RmV0Y2hlZCkge1xuICAgICAgICAgICAgLy8gSGV4LWVuY29kZWQgdmVyc2lvbiBvZiB0aGUgcmVwbGljYSByb290IGtleVxuICAgICAgICAgICAgdGhpcy5yb290S2V5ID0gKGF3YWl0IHRoaXMuc3RhdHVzKCkpLnJvb3Rfa2V5O1xuICAgICAgICAgICAgdGhpcy5fcm9vdEtleUZldGNoZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3RLZXk7XG4gICAgfVxuICAgIGludmFsaWRhdGVJZGVudGl0eSgpIHtcbiAgICAgICAgdGhpcy5faWRlbnRpdHkgPSBudWxsO1xuICAgIH1cbiAgICByZXBsYWNlSWRlbnRpdHkoaWRlbnRpdHkpIHtcbiAgICAgICAgdGhpcy5faWRlbnRpdHkgPSBQcm9taXNlLnJlc29sdmUoaWRlbnRpdHkpO1xuICAgIH1cbiAgICBhc3luYyBmZXRjaFN1Ym5ldEtleXMoY2FuaXN0ZXJJZCkge1xuICAgICAgICBjb25zdCBlZmZlY3RpdmVDYW5pc3RlcklkID0gUHJpbmNpcGFsLmZyb20oY2FuaXN0ZXJJZCk7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgICAgICBjYW5pc3RlcklkOiBlZmZlY3RpdmVDYW5pc3RlcklkLFxuICAgICAgICAgICAgcGF0aHM6IFsnc3VibmV0J10sXG4gICAgICAgICAgICBhZ2VudDogdGhpcyxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHN1Ym5ldFJlc3BvbnNlID0gcmVzcG9uc2UuZ2V0KCdzdWJuZXQnKTtcbiAgICAgICAgaWYgKHN1Ym5ldFJlc3BvbnNlICYmIHR5cGVvZiBzdWJuZXRSZXNwb25zZSA9PT0gJ29iamVjdCcgJiYgJ25vZGVLZXlzJyBpbiBzdWJuZXRSZXNwb25zZSkge1xuICAgICAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfSHR0cEFnZW50X3N1Ym5ldEtleXMsIFwiZlwiKS5zZXQoZWZmZWN0aXZlQ2FuaXN0ZXJJZC50b1RleHQoKSwgc3VibmV0UmVzcG9uc2UpO1xuICAgICAgICAgICAgcmV0dXJuIHN1Ym5ldFJlc3BvbnNlO1xuICAgICAgICB9XG4gICAgICAgIC8vIElmIHRoZSBzdWJuZXQgc3RhdHVzIGlzIG5vdCByZXR1cm5lZCwgcmV0dXJuIHVuZGVmaW5lZFxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBfdHJhbnNmb3JtKHJlcXVlc3QpIHtcbiAgICAgICAgbGV0IHAgPSBQcm9taXNlLnJlc29sdmUocmVxdWVzdCk7XG4gICAgICAgIGlmIChyZXF1ZXN0LmVuZHBvaW50ID09PSBcImNhbGxcIiAvKiBFbmRwb2ludC5DYWxsICovKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGZuIG9mIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF91cGRhdGVQaXBlbGluZSwgXCJmXCIpKSB7XG4gICAgICAgICAgICAgICAgcCA9IHAudGhlbihyID0+IGZuKHIpLnRoZW4ocjIgPT4gcjIgfHwgcikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yIChjb25zdCBmbiBvZiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9IdHRwQWdlbnRfcXVlcnlQaXBlbGluZSwgXCJmXCIpKSB7XG4gICAgICAgICAgICAgICAgcCA9IHAudGhlbihyID0+IGZuKHIpLnRoZW4ocjIgPT4gcjIgfHwgcikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwO1xuICAgIH1cbn1cbl9IdHRwQWdlbnRfcmV0cnlUaW1lcyA9IG5ldyBXZWFrTWFwKCksIF9IdHRwQWdlbnRfYmFja29mZlN0cmF0ZWd5ID0gbmV3IFdlYWtNYXAoKSwgX0h0dHBBZ2VudF93YXRlck1hcmsgPSBuZXcgV2Vha01hcCgpLCBfSHR0cEFnZW50X3F1ZXJ5UGlwZWxpbmUgPSBuZXcgV2Vha01hcCgpLCBfSHR0cEFnZW50X3VwZGF0ZVBpcGVsaW5lID0gbmV3IFdlYWtNYXAoKSwgX0h0dHBBZ2VudF9zdWJuZXRLZXlzID0gbmV3IFdlYWtNYXAoKSwgX0h0dHBBZ2VudF92ZXJpZnlRdWVyeVNpZ25hdHVyZXMgPSBuZXcgV2Vha01hcCgpLCBfSHR0cEFnZW50X3ZlcmlmeVF1ZXJ5UmVzcG9uc2UgPSBuZXcgV2Vha01hcCgpLCBfSHR0cEFnZW50X2luc3RhbmNlcyA9IG5ldyBXZWFrU2V0KCksIF9IdHRwQWdlbnRfcmVxdWVzdEFuZFJldHJ5UXVlcnkgPSBhc3luYyBmdW5jdGlvbiBfSHR0cEFnZW50X3JlcXVlc3RBbmRSZXRyeVF1ZXJ5KGFyZ3MpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IHsgZWNpZCwgdHJhbnNmb3JtZWRSZXF1ZXN0LCBib2R5LCByZXF1ZXN0SWQsIGJhY2tvZmYsIHRyaWVzIH0gPSBhcmdzO1xuICAgIGNvbnN0IGRlbGF5ID0gdHJpZXMgPT09IDAgPyAwIDogYmFja29mZi5uZXh0KCk7XG4gICAgdGhpcy5sb2cucHJpbnQoYGZldGNoaW5nIFwiL2FwaS92Mi9jYW5pc3Rlci8ke2VjaWQudG9TdHJpbmcoKX0vcXVlcnlcIiB3aXRoIHRyaWVzOmAsIHtcbiAgICAgICAgdHJpZXMsXG4gICAgICAgIGJhY2tvZmYsXG4gICAgICAgIGRlbGF5LFxuICAgIH0pO1xuICAgIC8vIElmIGRlbGF5IGlzIG51bGwsIHRoZSBiYWNrb2ZmIHN0cmF0ZWd5IGlzIGV4aGF1c3RlZCBkdWUgdG8gYSBtYXhpbXVtIG51bWJlciBvZiByZXRyaWVzLCBkdXJhdGlvbiwgb3Igb3RoZXIgcmVhc29uXG4gICAgaWYgKGRlbGF5ID09PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBBZ2VudEVycm9yKGBUaW1lc3RhbXAgZmFpbGVkIHRvIHBhc3MgdGhlIHdhdGVybWFyayBhZnRlciByZXRyeWluZyB0aGUgY29uZmlndXJlZCAke19fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF9yZXRyeVRpbWVzLCBcImZcIil9IHRpbWVzLiBXZSBjYW5ub3QgZ3VhcmFudGVlIHRoZSBpbnRlZ3JpdHkgb2YgdGhlIHJlc3BvbnNlIHNpbmNlIGl0IGNvdWxkIGJlIGEgcmVwbGF5IGF0dGFjay5gKTtcbiAgICB9XG4gICAgaWYgKGRlbGF5ID4gMCkge1xuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcbiAgICB9XG4gICAgbGV0IHJlc3BvbnNlO1xuICAgIC8vIE1ha2UgdGhlIHJlcXVlc3QgYW5kIHJldHJ5IGlmIGl0IHRocm93cyBhbiBlcnJvclxuICAgIHRyeSB7XG4gICAgICAgIHRoaXMubG9nLnByaW50KGBmZXRjaGluZyBcIi9hcGkvdjIvY2FuaXN0ZXIvJHtlY2lkLnRvU3RyaW5nKCl9L3F1ZXJ5XCIgd2l0aCByZXF1ZXN0OmAsIHRyYW5zZm9ybWVkUmVxdWVzdCk7XG4gICAgICAgIGNvbnN0IGZldGNoUmVzcG9uc2UgPSBhd2FpdCB0aGlzLl9mZXRjaCgnJyArIG5ldyBVUkwoYC9hcGkvdjIvY2FuaXN0ZXIvJHtlY2lkLnRvU3RyaW5nKCl9L3F1ZXJ5YCwgdGhpcy5faG9zdCksIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB0aGlzLl9mZXRjaE9wdGlvbnMpLCB0cmFuc2Zvcm1lZFJlcXVlc3QucmVxdWVzdCksIHsgYm9keSB9KSk7XG4gICAgICAgIGlmIChmZXRjaFJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICBjb25zdCBxdWVyeVJlc3BvbnNlID0gY2Jvci5kZWNvZGUoYXdhaXQgZmV0Y2hSZXNwb25zZS5hcnJheUJ1ZmZlcigpKTtcbiAgICAgICAgICAgIHJlc3BvbnNlID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBxdWVyeVJlc3BvbnNlKSwgeyBodHRwRGV0YWlsczoge1xuICAgICAgICAgICAgICAgICAgICBvazogZmV0Y2hSZXNwb25zZS5vayxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBmZXRjaFJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogZmV0Y2hSZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiBodHRwSGVhZGVyc1RyYW5zZm9ybShmZXRjaFJlc3BvbnNlLmhlYWRlcnMpLFxuICAgICAgICAgICAgICAgIH0sIHJlcXVlc3RJZCB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBZ2VudEhUVFBSZXNwb25zZUVycm9yKGBHYXRld2F5IHJldHVybmVkIGFuIGVycm9yOlxcbmAgK1xuICAgICAgICAgICAgICAgIGAgIENvZGU6ICR7ZmV0Y2hSZXNwb25zZS5zdGF0dXN9ICgke2ZldGNoUmVzcG9uc2Uuc3RhdHVzVGV4dH0pXFxuYCArXG4gICAgICAgICAgICAgICAgYCAgQm9keTogJHthd2FpdCBmZXRjaFJlc3BvbnNlLnRleHQoKX1cXG5gLCB7XG4gICAgICAgICAgICAgICAgb2s6IGZldGNoUmVzcG9uc2Uub2ssXG4gICAgICAgICAgICAgICAgc3RhdHVzOiBmZXRjaFJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OiBmZXRjaFJlc3BvbnNlLnN0YXR1c1RleHQsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogaHR0cEhlYWRlcnNUcmFuc2Zvcm0oZmV0Y2hSZXNwb25zZS5oZWFkZXJzKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBpZiAodHJpZXMgPCBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9IdHRwQWdlbnRfcmV0cnlUaW1lcywgXCJmXCIpKSB7XG4gICAgICAgICAgICB0aGlzLmxvZy53YXJuKGBDYXVnaHQgZXhjZXB0aW9uIHdoaWxlIGF0dGVtcHRpbmcgdG8gbWFrZSBxdWVyeTpcXG5gICtcbiAgICAgICAgICAgICAgICBgICAke2Vycm9yfVxcbmAgK1xuICAgICAgICAgICAgICAgIGAgIFJldHJ5aW5nIHF1ZXJ5LmApO1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF9pbnN0YW5jZXMsIFwibVwiLCBfSHR0cEFnZW50X3JlcXVlc3RBbmRSZXRyeVF1ZXJ5KS5jYWxsKHRoaXMsIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgYXJncyksIHsgdHJpZXM6IHRyaWVzICsgMSB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIGNvbnN0IHRpbWVzdGFtcCA9IChfYiA9IChfYSA9IHJlc3BvbnNlLnNpZ25hdHVyZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYVswXSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnRpbWVzdGFtcDtcbiAgICAvLyBTa2lwIHdhdGVybWFyayB2ZXJpZmljYXRpb24gaWYgdGhlIHVzZXIgaGFzIHNldCB2ZXJpZnlRdWVyeVNpZ25hdHVyZXMgdG8gZmFsc2VcbiAgICBpZiAoIV9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF92ZXJpZnlRdWVyeVNpZ25hdHVyZXMsIFwiZlwiKSkge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgfVxuICAgIGlmICghdGltZXN0YW1wKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGltZXN0YW1wIG5vdCBmb3VuZCBpbiBxdWVyeSByZXNwb25zZS4gVGhpcyBzdWdnZXN0cyBhIG1hbGZvcm1lZCBvciBtYWxpY2lvdXMgcmVzcG9uc2UuJyk7XG4gICAgfVxuICAgIC8vIENvbnZlcnQgdGhlIHRpbWVzdGFtcCB0byBtaWxsaXNlY29uZHNcbiAgICBjb25zdCB0aW1lU3RhbXBJbk1zID0gTnVtYmVyKEJpZ0ludCh0aW1lc3RhbXApIC8gQmlnSW50KDEwMDAwMDApKTtcbiAgICB0aGlzLmxvZy5wcmludCgnd2F0ZXJtYXJrIGFuZCB0aW1lc3RhbXAnLCB7XG4gICAgICAgIHdhdGVyTWFyazogdGhpcy53YXRlck1hcmssXG4gICAgICAgIHRpbWVzdGFtcDogdGltZVN0YW1wSW5NcyxcbiAgICB9KTtcbiAgICAvLyBJZiB0aGUgdGltZXN0YW1wIGlzIGxlc3MgdGhhbiB0aGUgd2F0ZXJtYXJrLCByZXRyeSB0aGUgcmVxdWVzdCB1cCB0byB0aGUgcmV0cnkgbGltaXRcbiAgICBpZiAoTnVtYmVyKHRoaXMud2F0ZXJNYXJrKSA+IHRpbWVTdGFtcEluTXMpIHtcbiAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgQWdlbnRFcnJvcignVGltZXN0YW1wIGlzIGJlbG93IHRoZSB3YXRlcm1hcmsuIFJldHJ5aW5nIHF1ZXJ5LicpO1xuICAgICAgICB0aGlzLmxvZy5lcnJvcignVGltZXN0YW1wIGlzIGJlbG93JywgZXJyb3IsIHtcbiAgICAgICAgICAgIHRpbWVzdGFtcCxcbiAgICAgICAgICAgIHdhdGVyTWFyazogdGhpcy53YXRlck1hcmssXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodHJpZXMgPCBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9IdHRwQWdlbnRfcmV0cnlUaW1lcywgXCJmXCIpKSB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfSHR0cEFnZW50X2luc3RhbmNlcywgXCJtXCIsIF9IdHRwQWdlbnRfcmVxdWVzdEFuZFJldHJ5UXVlcnkpLmNhbGwodGhpcywgT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBhcmdzKSwgeyB0cmllczogdHJpZXMgKyAxIH0pKTtcbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQWdlbnRFcnJvcihgVGltZXN0YW1wIGZhaWxlZCB0byBwYXNzIHRoZSB3YXRlcm1hcmsgYWZ0ZXIgcmV0cnlpbmcgdGhlIGNvbmZpZ3VyZWQgJHtfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9IdHRwQWdlbnRfcmV0cnlUaW1lcywgXCJmXCIpfSB0aW1lcy4gV2UgY2Fubm90IGd1YXJhbnRlZSB0aGUgaW50ZWdyaXR5IG9mIHRoZSByZXNwb25zZSBzaW5jZSBpdCBjb3VsZCBiZSBhIHJlcGxheSBhdHRhY2suYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3BvbnNlO1xufSwgX0h0dHBBZ2VudF9yZXF1ZXN0QW5kUmV0cnkgPSBhc3luYyBmdW5jdGlvbiBfSHR0cEFnZW50X3JlcXVlc3RBbmRSZXRyeShhcmdzKSB7XG4gICAgY29uc3QgeyByZXF1ZXN0LCBiYWNrb2ZmLCB0cmllcyB9ID0gYXJncztcbiAgICBjb25zdCBkZWxheSA9IHRyaWVzID09PSAwID8gMCA6IGJhY2tvZmYubmV4dCgpO1xuICAgIC8vIElmIGRlbGF5IGlzIG51bGwsIHRoZSBiYWNrb2ZmIHN0cmF0ZWd5IGlzIGV4aGF1c3RlZCBkdWUgdG8gYSBtYXhpbXVtIG51bWJlciBvZiByZXRyaWVzLCBkdXJhdGlvbiwgb3Igb3RoZXIgcmVhc29uXG4gICAgaWYgKGRlbGF5ID09PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBBZ2VudEVycm9yKGBUaW1lc3RhbXAgZmFpbGVkIHRvIHBhc3MgdGhlIHdhdGVybWFyayBhZnRlciByZXRyeWluZyB0aGUgY29uZmlndXJlZCAke19fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF9yZXRyeVRpbWVzLCBcImZcIil9IHRpbWVzLiBXZSBjYW5ub3QgZ3VhcmFudGVlIHRoZSBpbnRlZ3JpdHkgb2YgdGhlIHJlc3BvbnNlIHNpbmNlIGl0IGNvdWxkIGJlIGEgcmVwbGF5IGF0dGFjay5gKTtcbiAgICB9XG4gICAgaWYgKGRlbGF5ID4gMCkge1xuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcbiAgICB9XG4gICAgbGV0IHJlc3BvbnNlO1xuICAgIHRyeSB7XG4gICAgICAgIHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdCgpO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgaWYgKF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF9yZXRyeVRpbWVzLCBcImZcIikgPiB0cmllcykge1xuICAgICAgICAgICAgdGhpcy5sb2cud2FybihgQ2F1Z2h0IGV4Y2VwdGlvbiB3aGlsZSBhdHRlbXB0aW5nIHRvIG1ha2UgcmVxdWVzdDpcXG5gICtcbiAgICAgICAgICAgICAgICBgICAke2Vycm9yfVxcbmAgK1xuICAgICAgICAgICAgICAgIGAgIFJldHJ5aW5nIHJlcXVlc3QuYCk7XG4gICAgICAgICAgICAvLyBEZWxheSB0aGUgcmVxdWVzdCBieSB0aGUgY29uZmlndXJlZCBiYWNrb2ZmIHN0cmF0ZWd5XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfSHR0cEFnZW50X2luc3RhbmNlcywgXCJtXCIsIF9IdHRwQWdlbnRfcmVxdWVzdEFuZFJldHJ5KS5jYWxsKHRoaXMsIHsgcmVxdWVzdCwgYmFja29mZiwgdHJpZXM6IHRyaWVzICsgMSB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICB9XG4gICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gYXdhaXQgcmVzcG9uc2UuY2xvbmUoKS50ZXh0KCk7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gYFNlcnZlciByZXR1cm5lZCBhbiBlcnJvcjpcXG5gICtcbiAgICAgICAgYCAgQ29kZTogJHtyZXNwb25zZS5zdGF0dXN9ICgke3Jlc3BvbnNlLnN0YXR1c1RleHR9KVxcbmAgK1xuICAgICAgICBgICBCb2R5OiAke3Jlc3BvbnNlVGV4dH1cXG5gO1xuICAgIGlmICh0cmllcyA8IF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF9yZXRyeVRpbWVzLCBcImZcIikpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0h0dHBBZ2VudF9pbnN0YW5jZXMsIFwibVwiLCBfSHR0cEFnZW50X3JlcXVlc3RBbmRSZXRyeSkuY2FsbCh0aGlzLCB7IHJlcXVlc3QsIGJhY2tvZmYsIHRyaWVzOiB0cmllcyArIDEgfSk7XG4gICAgfVxuICAgIHRocm93IG5ldyBBZ2VudEhUVFBSZXNwb25zZUVycm9yKGVycm9yTWVzc2FnZSwge1xuICAgICAgICBvazogcmVzcG9uc2Uub2ssXG4gICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICBzdGF0dXNUZXh0OiByZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICBoZWFkZXJzOiBodHRwSGVhZGVyc1RyYW5zZm9ybShyZXNwb25zZS5oZWFkZXJzKSxcbiAgICB9KTtcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/@dfinity/agent/lib/esm/agent/http/index.js\n"));

/***/ }),

/***/ "./node_modules/@dfinity/agent/lib/esm/agent/http/transforms.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@dfinity/agent/lib/esm/agent/http/transforms.js ***!
  \**********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Expiry: function() { return /* binding */ Expiry; },\n/* harmony export */   httpHeadersTransform: function() { return /* binding */ httpHeadersTransform; },\n/* harmony export */   makeExpiryTransform: function() { return /* binding */ makeExpiryTransform; },\n/* harmony export */   makeNonceTransform: function() { return /* binding */ makeNonceTransform; }\n/* harmony export */ });\n/* harmony import */ var _dfinity_candid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dfinity/candid */ \"./node_modules/@dfinity/candid/lib/esm/index.js\");\n/* harmony import */ var simple_cbor__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! simple-cbor */ \"./node_modules/simple-cbor/src/index.js\");\n/* harmony import */ var simple_cbor__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(simple_cbor__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./types */ \"./node_modules/@dfinity/agent/lib/esm/agent/http/types.js\");\n\n\n\nconst NANOSECONDS_PER_MILLISECONDS = BigInt(1000000);\nconst REPLICA_PERMITTED_DRIFT_MILLISECONDS = 60 * 1000;\nclass Expiry {\n    constructor(deltaInMSec) {\n        // Use bigint because it can overflow the maximum number allowed in a double float.\n        const raw_value = BigInt(Math.floor(Date.now() + deltaInMSec - REPLICA_PERMITTED_DRIFT_MILLISECONDS)) *\n            NANOSECONDS_PER_MILLISECONDS;\n        // round down to the nearest second\n        const ingress_as_seconds = raw_value / BigInt(1000000000);\n        // round down to nearest minute\n        const ingress_as_minutes = ingress_as_seconds / BigInt(60);\n        const rounded_down_nanos = ingress_as_minutes * BigInt(60) * BigInt(1000000000);\n        this._value = rounded_down_nanos;\n    }\n    toCBOR() {\n        // TODO: change this to take the minimum amount of space (it always takes 8 bytes now).\n        return simple_cbor__WEBPACK_IMPORTED_MODULE_1__.value.u64(this._value.toString(16), 16);\n    }\n    toHash() {\n        return (0,_dfinity_candid__WEBPACK_IMPORTED_MODULE_0__.lebEncode)(this._value);\n    }\n}\n/**\n * Create a Nonce transform, which takes a function that returns a Buffer, and adds it\n * as the nonce to every call requests.\n * @param nonceFn A function that returns a buffer. By default uses a semi-random method.\n */\nfunction makeNonceTransform(nonceFn = _types__WEBPACK_IMPORTED_MODULE_2__.makeNonce) {\n    return async (request) => {\n        // Nonce needs to be inserted into the header for all requests, to enable logs to be correlated with requests.\n        const headers = request.request.headers;\n        // TODO: uncomment this when the http proxy supports it.\n        // headers.set('X-IC-Request-ID', toHex(new Uint8Array(nonce)));\n        request.request.headers = headers;\n        // Nonce only needs to be inserted into the body for async calls, to prevent replay attacks.\n        if (request.endpoint === \"call\" /* Endpoint.Call */) {\n            request.body.nonce = nonceFn();\n        }\n    };\n}\n/**\n * Create a transform that adds a delay (by default 5 minutes) to the expiry.\n *\n * @param delayInMilliseconds The delay to add to the call time, in milliseconds.\n */\nfunction makeExpiryTransform(delayInMilliseconds) {\n    return async (request) => {\n        request.body.ingress_expiry = new Expiry(delayInMilliseconds);\n    };\n}\n/**\n * Maps the default fetch headers field to the serializable HttpHeaderField.\n *\n * @param headers Fetch definition of the headers type\n * @returns array of header fields\n */\nfunction httpHeadersTransform(headers) {\n    const headerFields = [];\n    headers.forEach((value, key) => {\n        headerFields.push([key, value]);\n    });\n    return headerFields;\n}\n//# sourceMappingURL=transforms.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYWdlbnQvbGliL2VzbS9hZ2VudC9odHRwL3RyYW5zZm9ybXMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBNEM7QUFDUjtBQUNDO0FBQ3JDO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSw4Q0FBVTtBQUN6QjtBQUNBO0FBQ0EsZUFBZSwwREFBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLHNDQUFzQyw2Q0FBUztBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYWdlbnQvbGliL2VzbS9hZ2VudC9odHRwL3RyYW5zZm9ybXMuanM/MjJjZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBsZWJFbmNvZGUgfSBmcm9tICdAZGZpbml0eS9jYW5kaWQnO1xuaW1wb3J0ICogYXMgY2JvciBmcm9tICdzaW1wbGUtY2Jvcic7XG5pbXBvcnQgeyBtYWtlTm9uY2UsIH0gZnJvbSAnLi90eXBlcyc7XG5jb25zdCBOQU5PU0VDT05EU19QRVJfTUlMTElTRUNPTkRTID0gQmlnSW50KDEwMDAwMDApO1xuY29uc3QgUkVQTElDQV9QRVJNSVRURURfRFJJRlRfTUlMTElTRUNPTkRTID0gNjAgKiAxMDAwO1xuZXhwb3J0IGNsYXNzIEV4cGlyeSB7XG4gICAgY29uc3RydWN0b3IoZGVsdGFJbk1TZWMpIHtcbiAgICAgICAgLy8gVXNlIGJpZ2ludCBiZWNhdXNlIGl0IGNhbiBvdmVyZmxvdyB0aGUgbWF4aW11bSBudW1iZXIgYWxsb3dlZCBpbiBhIGRvdWJsZSBmbG9hdC5cbiAgICAgICAgY29uc3QgcmF3X3ZhbHVlID0gQmlnSW50KE1hdGguZmxvb3IoRGF0ZS5ub3coKSArIGRlbHRhSW5NU2VjIC0gUkVQTElDQV9QRVJNSVRURURfRFJJRlRfTUlMTElTRUNPTkRTKSkgKlxuICAgICAgICAgICAgTkFOT1NFQ09ORFNfUEVSX01JTExJU0VDT05EUztcbiAgICAgICAgLy8gcm91bmQgZG93biB0byB0aGUgbmVhcmVzdCBzZWNvbmRcbiAgICAgICAgY29uc3QgaW5ncmVzc19hc19zZWNvbmRzID0gcmF3X3ZhbHVlIC8gQmlnSW50KDEwMDAwMDAwMDApO1xuICAgICAgICAvLyByb3VuZCBkb3duIHRvIG5lYXJlc3QgbWludXRlXG4gICAgICAgIGNvbnN0IGluZ3Jlc3NfYXNfbWludXRlcyA9IGluZ3Jlc3NfYXNfc2Vjb25kcyAvIEJpZ0ludCg2MCk7XG4gICAgICAgIGNvbnN0IHJvdW5kZWRfZG93bl9uYW5vcyA9IGluZ3Jlc3NfYXNfbWludXRlcyAqIEJpZ0ludCg2MCkgKiBCaWdJbnQoMTAwMDAwMDAwMCk7XG4gICAgICAgIHRoaXMuX3ZhbHVlID0gcm91bmRlZF9kb3duX25hbm9zO1xuICAgIH1cbiAgICB0b0NCT1IoKSB7XG4gICAgICAgIC8vIFRPRE86IGNoYW5nZSB0aGlzIHRvIHRha2UgdGhlIG1pbmltdW0gYW1vdW50IG9mIHNwYWNlIChpdCBhbHdheXMgdGFrZXMgOCBieXRlcyBub3cpLlxuICAgICAgICByZXR1cm4gY2Jvci52YWx1ZS51NjQodGhpcy5fdmFsdWUudG9TdHJpbmcoMTYpLCAxNik7XG4gICAgfVxuICAgIHRvSGFzaCgpIHtcbiAgICAgICAgcmV0dXJuIGxlYkVuY29kZSh0aGlzLl92YWx1ZSk7XG4gICAgfVxufVxuLyoqXG4gKiBDcmVhdGUgYSBOb25jZSB0cmFuc2Zvcm0sIHdoaWNoIHRha2VzIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgQnVmZmVyLCBhbmQgYWRkcyBpdFxuICogYXMgdGhlIG5vbmNlIHRvIGV2ZXJ5IGNhbGwgcmVxdWVzdHMuXG4gKiBAcGFyYW0gbm9uY2VGbiBBIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIGJ1ZmZlci4gQnkgZGVmYXVsdCB1c2VzIGEgc2VtaS1yYW5kb20gbWV0aG9kLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFrZU5vbmNlVHJhbnNmb3JtKG5vbmNlRm4gPSBtYWtlTm9uY2UpIHtcbiAgICByZXR1cm4gYXN5bmMgKHJlcXVlc3QpID0+IHtcbiAgICAgICAgLy8gTm9uY2UgbmVlZHMgdG8gYmUgaW5zZXJ0ZWQgaW50byB0aGUgaGVhZGVyIGZvciBhbGwgcmVxdWVzdHMsIHRvIGVuYWJsZSBsb2dzIHRvIGJlIGNvcnJlbGF0ZWQgd2l0aCByZXF1ZXN0cy5cbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHJlcXVlc3QucmVxdWVzdC5oZWFkZXJzO1xuICAgICAgICAvLyBUT0RPOiB1bmNvbW1lbnQgdGhpcyB3aGVuIHRoZSBodHRwIHByb3h5IHN1cHBvcnRzIGl0LlxuICAgICAgICAvLyBoZWFkZXJzLnNldCgnWC1JQy1SZXF1ZXN0LUlEJywgdG9IZXgobmV3IFVpbnQ4QXJyYXkobm9uY2UpKSk7XG4gICAgICAgIHJlcXVlc3QucmVxdWVzdC5oZWFkZXJzID0gaGVhZGVycztcbiAgICAgICAgLy8gTm9uY2Ugb25seSBuZWVkcyB0byBiZSBpbnNlcnRlZCBpbnRvIHRoZSBib2R5IGZvciBhc3luYyBjYWxscywgdG8gcHJldmVudCByZXBsYXkgYXR0YWNrcy5cbiAgICAgICAgaWYgKHJlcXVlc3QuZW5kcG9pbnQgPT09IFwiY2FsbFwiIC8qIEVuZHBvaW50LkNhbGwgKi8pIHtcbiAgICAgICAgICAgIHJlcXVlc3QuYm9keS5ub25jZSA9IG5vbmNlRm4oKTtcbiAgICAgICAgfVxuICAgIH07XG59XG4vKipcbiAqIENyZWF0ZSBhIHRyYW5zZm9ybSB0aGF0IGFkZHMgYSBkZWxheSAoYnkgZGVmYXVsdCA1IG1pbnV0ZXMpIHRvIHRoZSBleHBpcnkuXG4gKlxuICogQHBhcmFtIGRlbGF5SW5NaWxsaXNlY29uZHMgVGhlIGRlbGF5IHRvIGFkZCB0byB0aGUgY2FsbCB0aW1lLCBpbiBtaWxsaXNlY29uZHMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYWtlRXhwaXJ5VHJhbnNmb3JtKGRlbGF5SW5NaWxsaXNlY29uZHMpIHtcbiAgICByZXR1cm4gYXN5bmMgKHJlcXVlc3QpID0+IHtcbiAgICAgICAgcmVxdWVzdC5ib2R5LmluZ3Jlc3NfZXhwaXJ5ID0gbmV3IEV4cGlyeShkZWxheUluTWlsbGlzZWNvbmRzKTtcbiAgICB9O1xufVxuLyoqXG4gKiBNYXBzIHRoZSBkZWZhdWx0IGZldGNoIGhlYWRlcnMgZmllbGQgdG8gdGhlIHNlcmlhbGl6YWJsZSBIdHRwSGVhZGVyRmllbGQuXG4gKlxuICogQHBhcmFtIGhlYWRlcnMgRmV0Y2ggZGVmaW5pdGlvbiBvZiB0aGUgaGVhZGVycyB0eXBlXG4gKiBAcmV0dXJucyBhcnJheSBvZiBoZWFkZXIgZmllbGRzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBodHRwSGVhZGVyc1RyYW5zZm9ybShoZWFkZXJzKSB7XG4gICAgY29uc3QgaGVhZGVyRmllbGRzID0gW107XG4gICAgaGVhZGVycy5mb3JFYWNoKCh2YWx1ZSwga2V5KSA9PiB7XG4gICAgICAgIGhlYWRlckZpZWxkcy5wdXNoKFtrZXksIHZhbHVlXSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGhlYWRlckZpZWxkcztcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRyYW5zZm9ybXMuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@dfinity/agent/lib/esm/agent/http/transforms.js\n"));

/***/ }),

/***/ "./node_modules/@dfinity/agent/lib/esm/canisters/management_idl.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@dfinity/agent/lib/esm/canisters/management_idl.js ***!
  \*************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/*\n * This file is generated from the candid for asset management.\n * didc version: 0.4.0\n */\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\n/* harmony default export */ __webpack_exports__[\"default\"] = (({ IDL }) => {\n    const bitcoin_network = IDL.Variant({\n        mainnet: IDL.Null,\n        testnet: IDL.Null,\n    });\n    const bitcoin_address = IDL.Text;\n    const bitcoin_get_balance_args = IDL.Record({\n        network: bitcoin_network,\n        address: bitcoin_address,\n        min_confirmations: IDL.Opt(IDL.Nat32),\n    });\n    const satoshi = IDL.Nat64;\n    const bitcoin_get_balance_result = satoshi;\n    const bitcoin_get_current_fee_percentiles_args = IDL.Record({\n        network: bitcoin_network,\n    });\n    const millisatoshi_per_byte = IDL.Nat64;\n    const bitcoin_get_current_fee_percentiles_result = IDL.Vec(millisatoshi_per_byte);\n    const bitcoin_get_utxos_args = IDL.Record({\n        network: bitcoin_network,\n        filter: IDL.Opt(IDL.Variant({\n            page: IDL.Vec(IDL.Nat8),\n            min_confirmations: IDL.Nat32,\n        })),\n        address: bitcoin_address,\n    });\n    const block_hash = IDL.Vec(IDL.Nat8);\n    const outpoint = IDL.Record({\n        txid: IDL.Vec(IDL.Nat8),\n        vout: IDL.Nat32,\n    });\n    const utxo = IDL.Record({\n        height: IDL.Nat32,\n        value: satoshi,\n        outpoint: outpoint,\n    });\n    const bitcoin_get_utxos_result = IDL.Record({\n        next_page: IDL.Opt(IDL.Vec(IDL.Nat8)),\n        tip_height: IDL.Nat32,\n        tip_block_hash: block_hash,\n        utxos: IDL.Vec(utxo),\n    });\n    const bitcoin_send_transaction_args = IDL.Record({\n        transaction: IDL.Vec(IDL.Nat8),\n        network: bitcoin_network,\n    });\n    const canister_id = IDL.Principal;\n    const canister_info_args = IDL.Record({\n        canister_id: canister_id,\n        num_requested_changes: IDL.Opt(IDL.Nat64),\n    });\n    const change_origin = IDL.Variant({\n        from_user: IDL.Record({ user_id: IDL.Principal }),\n        from_canister: IDL.Record({\n            canister_version: IDL.Opt(IDL.Nat64),\n            canister_id: IDL.Principal,\n        }),\n    });\n    const change_details = IDL.Variant({\n        creation: IDL.Record({ controllers: IDL.Vec(IDL.Principal) }),\n        code_deployment: IDL.Record({\n            mode: IDL.Variant({\n                reinstall: IDL.Null,\n                upgrade: IDL.Null,\n                install: IDL.Null,\n            }),\n            module_hash: IDL.Vec(IDL.Nat8),\n        }),\n        controllers_change: IDL.Record({\n            controllers: IDL.Vec(IDL.Principal),\n        }),\n        code_uninstall: IDL.Null,\n    });\n    const change = IDL.Record({\n        timestamp_nanos: IDL.Nat64,\n        canister_version: IDL.Nat64,\n        origin: change_origin,\n        details: change_details,\n    });\n    const canister_info_result = IDL.Record({\n        controllers: IDL.Vec(IDL.Principal),\n        module_hash: IDL.Opt(IDL.Vec(IDL.Nat8)),\n        recent_changes: IDL.Vec(change),\n        total_num_changes: IDL.Nat64,\n    });\n    const canister_status_args = IDL.Record({ canister_id: canister_id });\n    const log_visibility = IDL.Variant({\n        controllers: IDL.Null,\n        public: IDL.Null,\n    });\n    const definite_canister_settings = IDL.Record({\n        freezing_threshold: IDL.Nat,\n        controllers: IDL.Vec(IDL.Principal),\n        reserved_cycles_limit: IDL.Nat,\n        log_visibility: log_visibility,\n        wasm_memory_limit: IDL.Nat,\n        memory_allocation: IDL.Nat,\n        compute_allocation: IDL.Nat,\n    });\n    const canister_status_result = IDL.Record({\n        status: IDL.Variant({\n            stopped: IDL.Null,\n            stopping: IDL.Null,\n            running: IDL.Null,\n        }),\n        memory_size: IDL.Nat,\n        cycles: IDL.Nat,\n        settings: definite_canister_settings,\n        query_stats: IDL.Record({\n            response_payload_bytes_total: IDL.Nat,\n            num_instructions_total: IDL.Nat,\n            num_calls_total: IDL.Nat,\n            request_payload_bytes_total: IDL.Nat,\n        }),\n        idle_cycles_burned_per_day: IDL.Nat,\n        module_hash: IDL.Opt(IDL.Vec(IDL.Nat8)),\n        reserved_cycles: IDL.Nat,\n    });\n    const clear_chunk_store_args = IDL.Record({ canister_id: canister_id });\n    const canister_settings = IDL.Record({\n        freezing_threshold: IDL.Opt(IDL.Nat),\n        controllers: IDL.Opt(IDL.Vec(IDL.Principal)),\n        reserved_cycles_limit: IDL.Opt(IDL.Nat),\n        log_visibility: IDL.Opt(log_visibility),\n        wasm_memory_limit: IDL.Opt(IDL.Nat),\n        memory_allocation: IDL.Opt(IDL.Nat),\n        compute_allocation: IDL.Opt(IDL.Nat),\n    });\n    const create_canister_args = IDL.Record({\n        settings: IDL.Opt(canister_settings),\n        sender_canister_version: IDL.Opt(IDL.Nat64),\n    });\n    const create_canister_result = IDL.Record({ canister_id: canister_id });\n    const delete_canister_args = IDL.Record({ canister_id: canister_id });\n    const deposit_cycles_args = IDL.Record({ canister_id: canister_id });\n    const ecdsa_curve = IDL.Variant({ secp256k1: IDL.Null });\n    const ecdsa_public_key_args = IDL.Record({\n        key_id: IDL.Record({ name: IDL.Text, curve: ecdsa_curve }),\n        canister_id: IDL.Opt(canister_id),\n        derivation_path: IDL.Vec(IDL.Vec(IDL.Nat8)),\n    });\n    const ecdsa_public_key_result = IDL.Record({\n        public_key: IDL.Vec(IDL.Nat8),\n        chain_code: IDL.Vec(IDL.Nat8),\n    });\n    const fetch_canister_logs_args = IDL.Record({ canister_id: canister_id });\n    const canister_log_record = IDL.Record({\n        idx: IDL.Nat64,\n        timestamp_nanos: IDL.Nat64,\n        content: IDL.Vec(IDL.Nat8),\n    });\n    const fetch_canister_logs_result = IDL.Record({\n        canister_log_records: IDL.Vec(canister_log_record),\n    });\n    const http_header = IDL.Record({ value: IDL.Text, name: IDL.Text });\n    const http_request_result = IDL.Record({\n        status: IDL.Nat,\n        body: IDL.Vec(IDL.Nat8),\n        headers: IDL.Vec(http_header),\n    });\n    const http_request_args = IDL.Record({\n        url: IDL.Text,\n        method: IDL.Variant({\n            get: IDL.Null,\n            head: IDL.Null,\n            post: IDL.Null,\n        }),\n        max_response_bytes: IDL.Opt(IDL.Nat64),\n        body: IDL.Opt(IDL.Vec(IDL.Nat8)),\n        transform: IDL.Opt(IDL.Record({\n            function: IDL.Func([\n                IDL.Record({\n                    context: IDL.Vec(IDL.Nat8),\n                    response: http_request_result,\n                }),\n            ], [http_request_result], ['query']),\n            context: IDL.Vec(IDL.Nat8),\n        })),\n        headers: IDL.Vec(http_header),\n    });\n    const canister_install_mode = IDL.Variant({\n        reinstall: IDL.Null,\n        upgrade: IDL.Opt(IDL.Record({\n            wasm_memory_persistence: IDL.Opt(IDL.Variant({ keep: IDL.Null, replace: IDL.Null })),\n            skip_pre_upgrade: IDL.Opt(IDL.Bool),\n        })),\n        install: IDL.Null,\n    });\n    const chunk_hash = IDL.Record({ hash: IDL.Vec(IDL.Nat8) });\n    const install_chunked_code_args = IDL.Record({\n        arg: IDL.Vec(IDL.Nat8),\n        wasm_module_hash: IDL.Vec(IDL.Nat8),\n        mode: canister_install_mode,\n        chunk_hashes_list: IDL.Vec(chunk_hash),\n        target_canister: canister_id,\n        store_canister: IDL.Opt(canister_id),\n        sender_canister_version: IDL.Opt(IDL.Nat64),\n    });\n    const wasm_module = IDL.Vec(IDL.Nat8);\n    const install_code_args = IDL.Record({\n        arg: IDL.Vec(IDL.Nat8),\n        wasm_module: wasm_module,\n        mode: canister_install_mode,\n        canister_id: canister_id,\n        sender_canister_version: IDL.Opt(IDL.Nat64),\n    });\n    const node_metrics_history_args = IDL.Record({\n        start_at_timestamp_nanos: IDL.Nat64,\n        subnet_id: IDL.Principal,\n    });\n    const node_metrics = IDL.Record({\n        num_block_failures_total: IDL.Nat64,\n        node_id: IDL.Principal,\n        num_blocks_proposed_total: IDL.Nat64,\n    });\n    const node_metrics_history_result = IDL.Vec(IDL.Record({\n        timestamp_nanos: IDL.Nat64,\n        node_metrics: IDL.Vec(node_metrics),\n    }));\n    const provisional_create_canister_with_cycles_args = IDL.Record({\n        settings: IDL.Opt(canister_settings),\n        specified_id: IDL.Opt(canister_id),\n        amount: IDL.Opt(IDL.Nat),\n        sender_canister_version: IDL.Opt(IDL.Nat64),\n    });\n    const provisional_create_canister_with_cycles_result = IDL.Record({\n        canister_id: canister_id,\n    });\n    const provisional_top_up_canister_args = IDL.Record({\n        canister_id: canister_id,\n        amount: IDL.Nat,\n    });\n    const raw_rand_result = IDL.Vec(IDL.Nat8);\n    const sign_with_ecdsa_args = IDL.Record({\n        key_id: IDL.Record({ name: IDL.Text, curve: ecdsa_curve }),\n        derivation_path: IDL.Vec(IDL.Vec(IDL.Nat8)),\n        message_hash: IDL.Vec(IDL.Nat8),\n    });\n    const sign_with_ecdsa_result = IDL.Record({\n        signature: IDL.Vec(IDL.Nat8),\n    });\n    const start_canister_args = IDL.Record({ canister_id: canister_id });\n    const stop_canister_args = IDL.Record({ canister_id: canister_id });\n    const stored_chunks_args = IDL.Record({ canister_id: canister_id });\n    const stored_chunks_result = IDL.Vec(chunk_hash);\n    const uninstall_code_args = IDL.Record({\n        canister_id: canister_id,\n        sender_canister_version: IDL.Opt(IDL.Nat64),\n    });\n    const update_settings_args = IDL.Record({\n        canister_id: IDL.Principal,\n        settings: canister_settings,\n        sender_canister_version: IDL.Opt(IDL.Nat64),\n    });\n    const upload_chunk_args = IDL.Record({\n        chunk: IDL.Vec(IDL.Nat8),\n        canister_id: IDL.Principal,\n    });\n    const upload_chunk_result = chunk_hash;\n    return IDL.Service({\n        bitcoin_get_balance: IDL.Func([bitcoin_get_balance_args], [bitcoin_get_balance_result], []),\n        bitcoin_get_current_fee_percentiles: IDL.Func([bitcoin_get_current_fee_percentiles_args], [bitcoin_get_current_fee_percentiles_result], []),\n        bitcoin_get_utxos: IDL.Func([bitcoin_get_utxos_args], [bitcoin_get_utxos_result], []),\n        bitcoin_send_transaction: IDL.Func([bitcoin_send_transaction_args], [], []),\n        canister_info: IDL.Func([canister_info_args], [canister_info_result], []),\n        canister_status: IDL.Func([canister_status_args], [canister_status_result], []),\n        clear_chunk_store: IDL.Func([clear_chunk_store_args], [], []),\n        create_canister: IDL.Func([create_canister_args], [create_canister_result], []),\n        delete_canister: IDL.Func([delete_canister_args], [], []),\n        deposit_cycles: IDL.Func([deposit_cycles_args], [], []),\n        ecdsa_public_key: IDL.Func([ecdsa_public_key_args], [ecdsa_public_key_result], []),\n        fetch_canister_logs: IDL.Func([fetch_canister_logs_args], [fetch_canister_logs_result], ['query']),\n        http_request: IDL.Func([http_request_args], [http_request_result], []),\n        install_chunked_code: IDL.Func([install_chunked_code_args], [], []),\n        install_code: IDL.Func([install_code_args], [], []),\n        node_metrics_history: IDL.Func([node_metrics_history_args], [node_metrics_history_result], []),\n        provisional_create_canister_with_cycles: IDL.Func([provisional_create_canister_with_cycles_args], [provisional_create_canister_with_cycles_result], []),\n        provisional_top_up_canister: IDL.Func([provisional_top_up_canister_args], [], []),\n        raw_rand: IDL.Func([], [raw_rand_result], []),\n        sign_with_ecdsa: IDL.Func([sign_with_ecdsa_args], [sign_with_ecdsa_result], []),\n        start_canister: IDL.Func([start_canister_args], [], []),\n        stop_canister: IDL.Func([stop_canister_args], [], []),\n        stored_chunks: IDL.Func([stored_chunks_args], [stored_chunks_result], []),\n        uninstall_code: IDL.Func([uninstall_code_args], [], []),\n        update_settings: IDL.Func([update_settings_args], [], []),\n        upload_chunk: IDL.Func([upload_chunk_args], [upload_chunk_result], []),\n    });\n});\n//# sourceMappingURL=management_idl.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYWdlbnQvbGliL2VzbS9jYW5pc3RlcnMvbWFuYWdlbWVudF9pZGwuanMiLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtEQUFlLEdBQUcsS0FBSztBQUN2QjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGdDQUFnQyx3QkFBd0I7QUFDeEQ7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBLCtCQUErQixxQ0FBcUM7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCw4Q0FBOEMsMEJBQTBCO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsZ0RBQWdELDBCQUEwQjtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxnREFBZ0QsMEJBQTBCO0FBQzFFLDhDQUE4QywwQkFBMEI7QUFDeEUsNkNBQTZDLDBCQUEwQjtBQUN2RSxzQ0FBc0MscUJBQXFCO0FBQzNEO0FBQ0EsNkJBQTZCLG9DQUFvQztBQUNqRTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxrREFBa0QsMEJBQTBCO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0wscUNBQXFDLGlDQUFpQztBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsbUNBQW1DO0FBQzlGO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMLG9DQUFvQyx5QkFBeUI7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLDZCQUE2QixvQ0FBb0M7QUFDakU7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMLDZDQUE2QywwQkFBMEI7QUFDdkUsNENBQTRDLDBCQUEwQjtBQUN0RSw0Q0FBNEMsMEJBQTBCO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDLEVBQUM7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYWdlbnQvbGliL2VzbS9jYW5pc3RlcnMvbWFuYWdlbWVudF9pZGwuanM/NmQ5NyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogVGhpcyBmaWxlIGlzIGdlbmVyYXRlZCBmcm9tIHRoZSBjYW5kaWQgZm9yIGFzc2V0IG1hbmFnZW1lbnQuXG4gKiBkaWRjIHZlcnNpb246IDAuNC4wXG4gKi9cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXRzLWNvbW1lbnRcbi8vIEB0cy1pZ25vcmVcbmV4cG9ydCBkZWZhdWx0ICh7IElETCB9KSA9PiB7XG4gICAgY29uc3QgYml0Y29pbl9uZXR3b3JrID0gSURMLlZhcmlhbnQoe1xuICAgICAgICBtYWlubmV0OiBJREwuTnVsbCxcbiAgICAgICAgdGVzdG5ldDogSURMLk51bGwsXG4gICAgfSk7XG4gICAgY29uc3QgYml0Y29pbl9hZGRyZXNzID0gSURMLlRleHQ7XG4gICAgY29uc3QgYml0Y29pbl9nZXRfYmFsYW5jZV9hcmdzID0gSURMLlJlY29yZCh7XG4gICAgICAgIG5ldHdvcms6IGJpdGNvaW5fbmV0d29yayxcbiAgICAgICAgYWRkcmVzczogYml0Y29pbl9hZGRyZXNzLFxuICAgICAgICBtaW5fY29uZmlybWF0aW9uczogSURMLk9wdChJREwuTmF0MzIpLFxuICAgIH0pO1xuICAgIGNvbnN0IHNhdG9zaGkgPSBJREwuTmF0NjQ7XG4gICAgY29uc3QgYml0Y29pbl9nZXRfYmFsYW5jZV9yZXN1bHQgPSBzYXRvc2hpO1xuICAgIGNvbnN0IGJpdGNvaW5fZ2V0X2N1cnJlbnRfZmVlX3BlcmNlbnRpbGVzX2FyZ3MgPSBJREwuUmVjb3JkKHtcbiAgICAgICAgbmV0d29yazogYml0Y29pbl9uZXR3b3JrLFxuICAgIH0pO1xuICAgIGNvbnN0IG1pbGxpc2F0b3NoaV9wZXJfYnl0ZSA9IElETC5OYXQ2NDtcbiAgICBjb25zdCBiaXRjb2luX2dldF9jdXJyZW50X2ZlZV9wZXJjZW50aWxlc19yZXN1bHQgPSBJREwuVmVjKG1pbGxpc2F0b3NoaV9wZXJfYnl0ZSk7XG4gICAgY29uc3QgYml0Y29pbl9nZXRfdXR4b3NfYXJncyA9IElETC5SZWNvcmQoe1xuICAgICAgICBuZXR3b3JrOiBiaXRjb2luX25ldHdvcmssXG4gICAgICAgIGZpbHRlcjogSURMLk9wdChJREwuVmFyaWFudCh7XG4gICAgICAgICAgICBwYWdlOiBJREwuVmVjKElETC5OYXQ4KSxcbiAgICAgICAgICAgIG1pbl9jb25maXJtYXRpb25zOiBJREwuTmF0MzIsXG4gICAgICAgIH0pKSxcbiAgICAgICAgYWRkcmVzczogYml0Y29pbl9hZGRyZXNzLFxuICAgIH0pO1xuICAgIGNvbnN0IGJsb2NrX2hhc2ggPSBJREwuVmVjKElETC5OYXQ4KTtcbiAgICBjb25zdCBvdXRwb2ludCA9IElETC5SZWNvcmQoe1xuICAgICAgICB0eGlkOiBJREwuVmVjKElETC5OYXQ4KSxcbiAgICAgICAgdm91dDogSURMLk5hdDMyLFxuICAgIH0pO1xuICAgIGNvbnN0IHV0eG8gPSBJREwuUmVjb3JkKHtcbiAgICAgICAgaGVpZ2h0OiBJREwuTmF0MzIsXG4gICAgICAgIHZhbHVlOiBzYXRvc2hpLFxuICAgICAgICBvdXRwb2ludDogb3V0cG9pbnQsXG4gICAgfSk7XG4gICAgY29uc3QgYml0Y29pbl9nZXRfdXR4b3NfcmVzdWx0ID0gSURMLlJlY29yZCh7XG4gICAgICAgIG5leHRfcGFnZTogSURMLk9wdChJREwuVmVjKElETC5OYXQ4KSksXG4gICAgICAgIHRpcF9oZWlnaHQ6IElETC5OYXQzMixcbiAgICAgICAgdGlwX2Jsb2NrX2hhc2g6IGJsb2NrX2hhc2gsXG4gICAgICAgIHV0eG9zOiBJREwuVmVjKHV0eG8pLFxuICAgIH0pO1xuICAgIGNvbnN0IGJpdGNvaW5fc2VuZF90cmFuc2FjdGlvbl9hcmdzID0gSURMLlJlY29yZCh7XG4gICAgICAgIHRyYW5zYWN0aW9uOiBJREwuVmVjKElETC5OYXQ4KSxcbiAgICAgICAgbmV0d29yazogYml0Y29pbl9uZXR3b3JrLFxuICAgIH0pO1xuICAgIGNvbnN0IGNhbmlzdGVyX2lkID0gSURMLlByaW5jaXBhbDtcbiAgICBjb25zdCBjYW5pc3Rlcl9pbmZvX2FyZ3MgPSBJREwuUmVjb3JkKHtcbiAgICAgICAgY2FuaXN0ZXJfaWQ6IGNhbmlzdGVyX2lkLFxuICAgICAgICBudW1fcmVxdWVzdGVkX2NoYW5nZXM6IElETC5PcHQoSURMLk5hdDY0KSxcbiAgICB9KTtcbiAgICBjb25zdCBjaGFuZ2Vfb3JpZ2luID0gSURMLlZhcmlhbnQoe1xuICAgICAgICBmcm9tX3VzZXI6IElETC5SZWNvcmQoeyB1c2VyX2lkOiBJREwuUHJpbmNpcGFsIH0pLFxuICAgICAgICBmcm9tX2NhbmlzdGVyOiBJREwuUmVjb3JkKHtcbiAgICAgICAgICAgIGNhbmlzdGVyX3ZlcnNpb246IElETC5PcHQoSURMLk5hdDY0KSxcbiAgICAgICAgICAgIGNhbmlzdGVyX2lkOiBJREwuUHJpbmNpcGFsLFxuICAgICAgICB9KSxcbiAgICB9KTtcbiAgICBjb25zdCBjaGFuZ2VfZGV0YWlscyA9IElETC5WYXJpYW50KHtcbiAgICAgICAgY3JlYXRpb246IElETC5SZWNvcmQoeyBjb250cm9sbGVyczogSURMLlZlYyhJREwuUHJpbmNpcGFsKSB9KSxcbiAgICAgICAgY29kZV9kZXBsb3ltZW50OiBJREwuUmVjb3JkKHtcbiAgICAgICAgICAgIG1vZGU6IElETC5WYXJpYW50KHtcbiAgICAgICAgICAgICAgICByZWluc3RhbGw6IElETC5OdWxsLFxuICAgICAgICAgICAgICAgIHVwZ3JhZGU6IElETC5OdWxsLFxuICAgICAgICAgICAgICAgIGluc3RhbGw6IElETC5OdWxsLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBtb2R1bGVfaGFzaDogSURMLlZlYyhJREwuTmF0OCksXG4gICAgICAgIH0pLFxuICAgICAgICBjb250cm9sbGVyc19jaGFuZ2U6IElETC5SZWNvcmQoe1xuICAgICAgICAgICAgY29udHJvbGxlcnM6IElETC5WZWMoSURMLlByaW5jaXBhbCksXG4gICAgICAgIH0pLFxuICAgICAgICBjb2RlX3VuaW5zdGFsbDogSURMLk51bGwsXG4gICAgfSk7XG4gICAgY29uc3QgY2hhbmdlID0gSURMLlJlY29yZCh7XG4gICAgICAgIHRpbWVzdGFtcF9uYW5vczogSURMLk5hdDY0LFxuICAgICAgICBjYW5pc3Rlcl92ZXJzaW9uOiBJREwuTmF0NjQsXG4gICAgICAgIG9yaWdpbjogY2hhbmdlX29yaWdpbixcbiAgICAgICAgZGV0YWlsczogY2hhbmdlX2RldGFpbHMsXG4gICAgfSk7XG4gICAgY29uc3QgY2FuaXN0ZXJfaW5mb19yZXN1bHQgPSBJREwuUmVjb3JkKHtcbiAgICAgICAgY29udHJvbGxlcnM6IElETC5WZWMoSURMLlByaW5jaXBhbCksXG4gICAgICAgIG1vZHVsZV9oYXNoOiBJREwuT3B0KElETC5WZWMoSURMLk5hdDgpKSxcbiAgICAgICAgcmVjZW50X2NoYW5nZXM6IElETC5WZWMoY2hhbmdlKSxcbiAgICAgICAgdG90YWxfbnVtX2NoYW5nZXM6IElETC5OYXQ2NCxcbiAgICB9KTtcbiAgICBjb25zdCBjYW5pc3Rlcl9zdGF0dXNfYXJncyA9IElETC5SZWNvcmQoeyBjYW5pc3Rlcl9pZDogY2FuaXN0ZXJfaWQgfSk7XG4gICAgY29uc3QgbG9nX3Zpc2liaWxpdHkgPSBJREwuVmFyaWFudCh7XG4gICAgICAgIGNvbnRyb2xsZXJzOiBJREwuTnVsbCxcbiAgICAgICAgcHVibGljOiBJREwuTnVsbCxcbiAgICB9KTtcbiAgICBjb25zdCBkZWZpbml0ZV9jYW5pc3Rlcl9zZXR0aW5ncyA9IElETC5SZWNvcmQoe1xuICAgICAgICBmcmVlemluZ190aHJlc2hvbGQ6IElETC5OYXQsXG4gICAgICAgIGNvbnRyb2xsZXJzOiBJREwuVmVjKElETC5QcmluY2lwYWwpLFxuICAgICAgICByZXNlcnZlZF9jeWNsZXNfbGltaXQ6IElETC5OYXQsXG4gICAgICAgIGxvZ192aXNpYmlsaXR5OiBsb2dfdmlzaWJpbGl0eSxcbiAgICAgICAgd2FzbV9tZW1vcnlfbGltaXQ6IElETC5OYXQsXG4gICAgICAgIG1lbW9yeV9hbGxvY2F0aW9uOiBJREwuTmF0LFxuICAgICAgICBjb21wdXRlX2FsbG9jYXRpb246IElETC5OYXQsXG4gICAgfSk7XG4gICAgY29uc3QgY2FuaXN0ZXJfc3RhdHVzX3Jlc3VsdCA9IElETC5SZWNvcmQoe1xuICAgICAgICBzdGF0dXM6IElETC5WYXJpYW50KHtcbiAgICAgICAgICAgIHN0b3BwZWQ6IElETC5OdWxsLFxuICAgICAgICAgICAgc3RvcHBpbmc6IElETC5OdWxsLFxuICAgICAgICAgICAgcnVubmluZzogSURMLk51bGwsXG4gICAgICAgIH0pLFxuICAgICAgICBtZW1vcnlfc2l6ZTogSURMLk5hdCxcbiAgICAgICAgY3ljbGVzOiBJREwuTmF0LFxuICAgICAgICBzZXR0aW5nczogZGVmaW5pdGVfY2FuaXN0ZXJfc2V0dGluZ3MsXG4gICAgICAgIHF1ZXJ5X3N0YXRzOiBJREwuUmVjb3JkKHtcbiAgICAgICAgICAgIHJlc3BvbnNlX3BheWxvYWRfYnl0ZXNfdG90YWw6IElETC5OYXQsXG4gICAgICAgICAgICBudW1faW5zdHJ1Y3Rpb25zX3RvdGFsOiBJREwuTmF0LFxuICAgICAgICAgICAgbnVtX2NhbGxzX3RvdGFsOiBJREwuTmF0LFxuICAgICAgICAgICAgcmVxdWVzdF9wYXlsb2FkX2J5dGVzX3RvdGFsOiBJREwuTmF0LFxuICAgICAgICB9KSxcbiAgICAgICAgaWRsZV9jeWNsZXNfYnVybmVkX3Blcl9kYXk6IElETC5OYXQsXG4gICAgICAgIG1vZHVsZV9oYXNoOiBJREwuT3B0KElETC5WZWMoSURMLk5hdDgpKSxcbiAgICAgICAgcmVzZXJ2ZWRfY3ljbGVzOiBJREwuTmF0LFxuICAgIH0pO1xuICAgIGNvbnN0IGNsZWFyX2NodW5rX3N0b3JlX2FyZ3MgPSBJREwuUmVjb3JkKHsgY2FuaXN0ZXJfaWQ6IGNhbmlzdGVyX2lkIH0pO1xuICAgIGNvbnN0IGNhbmlzdGVyX3NldHRpbmdzID0gSURMLlJlY29yZCh7XG4gICAgICAgIGZyZWV6aW5nX3RocmVzaG9sZDogSURMLk9wdChJREwuTmF0KSxcbiAgICAgICAgY29udHJvbGxlcnM6IElETC5PcHQoSURMLlZlYyhJREwuUHJpbmNpcGFsKSksXG4gICAgICAgIHJlc2VydmVkX2N5Y2xlc19saW1pdDogSURMLk9wdChJREwuTmF0KSxcbiAgICAgICAgbG9nX3Zpc2liaWxpdHk6IElETC5PcHQobG9nX3Zpc2liaWxpdHkpLFxuICAgICAgICB3YXNtX21lbW9yeV9saW1pdDogSURMLk9wdChJREwuTmF0KSxcbiAgICAgICAgbWVtb3J5X2FsbG9jYXRpb246IElETC5PcHQoSURMLk5hdCksXG4gICAgICAgIGNvbXB1dGVfYWxsb2NhdGlvbjogSURMLk9wdChJREwuTmF0KSxcbiAgICB9KTtcbiAgICBjb25zdCBjcmVhdGVfY2FuaXN0ZXJfYXJncyA9IElETC5SZWNvcmQoe1xuICAgICAgICBzZXR0aW5nczogSURMLk9wdChjYW5pc3Rlcl9zZXR0aW5ncyksXG4gICAgICAgIHNlbmRlcl9jYW5pc3Rlcl92ZXJzaW9uOiBJREwuT3B0KElETC5OYXQ2NCksXG4gICAgfSk7XG4gICAgY29uc3QgY3JlYXRlX2NhbmlzdGVyX3Jlc3VsdCA9IElETC5SZWNvcmQoeyBjYW5pc3Rlcl9pZDogY2FuaXN0ZXJfaWQgfSk7XG4gICAgY29uc3QgZGVsZXRlX2NhbmlzdGVyX2FyZ3MgPSBJREwuUmVjb3JkKHsgY2FuaXN0ZXJfaWQ6IGNhbmlzdGVyX2lkIH0pO1xuICAgIGNvbnN0IGRlcG9zaXRfY3ljbGVzX2FyZ3MgPSBJREwuUmVjb3JkKHsgY2FuaXN0ZXJfaWQ6IGNhbmlzdGVyX2lkIH0pO1xuICAgIGNvbnN0IGVjZHNhX2N1cnZlID0gSURMLlZhcmlhbnQoeyBzZWNwMjU2azE6IElETC5OdWxsIH0pO1xuICAgIGNvbnN0IGVjZHNhX3B1YmxpY19rZXlfYXJncyA9IElETC5SZWNvcmQoe1xuICAgICAgICBrZXlfaWQ6IElETC5SZWNvcmQoeyBuYW1lOiBJREwuVGV4dCwgY3VydmU6IGVjZHNhX2N1cnZlIH0pLFxuICAgICAgICBjYW5pc3Rlcl9pZDogSURMLk9wdChjYW5pc3Rlcl9pZCksXG4gICAgICAgIGRlcml2YXRpb25fcGF0aDogSURMLlZlYyhJREwuVmVjKElETC5OYXQ4KSksXG4gICAgfSk7XG4gICAgY29uc3QgZWNkc2FfcHVibGljX2tleV9yZXN1bHQgPSBJREwuUmVjb3JkKHtcbiAgICAgICAgcHVibGljX2tleTogSURMLlZlYyhJREwuTmF0OCksXG4gICAgICAgIGNoYWluX2NvZGU6IElETC5WZWMoSURMLk5hdDgpLFxuICAgIH0pO1xuICAgIGNvbnN0IGZldGNoX2NhbmlzdGVyX2xvZ3NfYXJncyA9IElETC5SZWNvcmQoeyBjYW5pc3Rlcl9pZDogY2FuaXN0ZXJfaWQgfSk7XG4gICAgY29uc3QgY2FuaXN0ZXJfbG9nX3JlY29yZCA9IElETC5SZWNvcmQoe1xuICAgICAgICBpZHg6IElETC5OYXQ2NCxcbiAgICAgICAgdGltZXN0YW1wX25hbm9zOiBJREwuTmF0NjQsXG4gICAgICAgIGNvbnRlbnQ6IElETC5WZWMoSURMLk5hdDgpLFxuICAgIH0pO1xuICAgIGNvbnN0IGZldGNoX2NhbmlzdGVyX2xvZ3NfcmVzdWx0ID0gSURMLlJlY29yZCh7XG4gICAgICAgIGNhbmlzdGVyX2xvZ19yZWNvcmRzOiBJREwuVmVjKGNhbmlzdGVyX2xvZ19yZWNvcmQpLFxuICAgIH0pO1xuICAgIGNvbnN0IGh0dHBfaGVhZGVyID0gSURMLlJlY29yZCh7IHZhbHVlOiBJREwuVGV4dCwgbmFtZTogSURMLlRleHQgfSk7XG4gICAgY29uc3QgaHR0cF9yZXF1ZXN0X3Jlc3VsdCA9IElETC5SZWNvcmQoe1xuICAgICAgICBzdGF0dXM6IElETC5OYXQsXG4gICAgICAgIGJvZHk6IElETC5WZWMoSURMLk5hdDgpLFxuICAgICAgICBoZWFkZXJzOiBJREwuVmVjKGh0dHBfaGVhZGVyKSxcbiAgICB9KTtcbiAgICBjb25zdCBodHRwX3JlcXVlc3RfYXJncyA9IElETC5SZWNvcmQoe1xuICAgICAgICB1cmw6IElETC5UZXh0LFxuICAgICAgICBtZXRob2Q6IElETC5WYXJpYW50KHtcbiAgICAgICAgICAgIGdldDogSURMLk51bGwsXG4gICAgICAgICAgICBoZWFkOiBJREwuTnVsbCxcbiAgICAgICAgICAgIHBvc3Q6IElETC5OdWxsLFxuICAgICAgICB9KSxcbiAgICAgICAgbWF4X3Jlc3BvbnNlX2J5dGVzOiBJREwuT3B0KElETC5OYXQ2NCksXG4gICAgICAgIGJvZHk6IElETC5PcHQoSURMLlZlYyhJREwuTmF0OCkpLFxuICAgICAgICB0cmFuc2Zvcm06IElETC5PcHQoSURMLlJlY29yZCh7XG4gICAgICAgICAgICBmdW5jdGlvbjogSURMLkZ1bmMoW1xuICAgICAgICAgICAgICAgIElETC5SZWNvcmQoe1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0OiBJREwuVmVjKElETC5OYXQ4KSxcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2U6IGh0dHBfcmVxdWVzdF9yZXN1bHQsXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBdLCBbaHR0cF9yZXF1ZXN0X3Jlc3VsdF0sIFsncXVlcnknXSksXG4gICAgICAgICAgICBjb250ZXh0OiBJREwuVmVjKElETC5OYXQ4KSxcbiAgICAgICAgfSkpLFxuICAgICAgICBoZWFkZXJzOiBJREwuVmVjKGh0dHBfaGVhZGVyKSxcbiAgICB9KTtcbiAgICBjb25zdCBjYW5pc3Rlcl9pbnN0YWxsX21vZGUgPSBJREwuVmFyaWFudCh7XG4gICAgICAgIHJlaW5zdGFsbDogSURMLk51bGwsXG4gICAgICAgIHVwZ3JhZGU6IElETC5PcHQoSURMLlJlY29yZCh7XG4gICAgICAgICAgICB3YXNtX21lbW9yeV9wZXJzaXN0ZW5jZTogSURMLk9wdChJREwuVmFyaWFudCh7IGtlZXA6IElETC5OdWxsLCByZXBsYWNlOiBJREwuTnVsbCB9KSksXG4gICAgICAgICAgICBza2lwX3ByZV91cGdyYWRlOiBJREwuT3B0KElETC5Cb29sKSxcbiAgICAgICAgfSkpLFxuICAgICAgICBpbnN0YWxsOiBJREwuTnVsbCxcbiAgICB9KTtcbiAgICBjb25zdCBjaHVua19oYXNoID0gSURMLlJlY29yZCh7IGhhc2g6IElETC5WZWMoSURMLk5hdDgpIH0pO1xuICAgIGNvbnN0IGluc3RhbGxfY2h1bmtlZF9jb2RlX2FyZ3MgPSBJREwuUmVjb3JkKHtcbiAgICAgICAgYXJnOiBJREwuVmVjKElETC5OYXQ4KSxcbiAgICAgICAgd2FzbV9tb2R1bGVfaGFzaDogSURMLlZlYyhJREwuTmF0OCksXG4gICAgICAgIG1vZGU6IGNhbmlzdGVyX2luc3RhbGxfbW9kZSxcbiAgICAgICAgY2h1bmtfaGFzaGVzX2xpc3Q6IElETC5WZWMoY2h1bmtfaGFzaCksXG4gICAgICAgIHRhcmdldF9jYW5pc3RlcjogY2FuaXN0ZXJfaWQsXG4gICAgICAgIHN0b3JlX2NhbmlzdGVyOiBJREwuT3B0KGNhbmlzdGVyX2lkKSxcbiAgICAgICAgc2VuZGVyX2NhbmlzdGVyX3ZlcnNpb246IElETC5PcHQoSURMLk5hdDY0KSxcbiAgICB9KTtcbiAgICBjb25zdCB3YXNtX21vZHVsZSA9IElETC5WZWMoSURMLk5hdDgpO1xuICAgIGNvbnN0IGluc3RhbGxfY29kZV9hcmdzID0gSURMLlJlY29yZCh7XG4gICAgICAgIGFyZzogSURMLlZlYyhJREwuTmF0OCksXG4gICAgICAgIHdhc21fbW9kdWxlOiB3YXNtX21vZHVsZSxcbiAgICAgICAgbW9kZTogY2FuaXN0ZXJfaW5zdGFsbF9tb2RlLFxuICAgICAgICBjYW5pc3Rlcl9pZDogY2FuaXN0ZXJfaWQsXG4gICAgICAgIHNlbmRlcl9jYW5pc3Rlcl92ZXJzaW9uOiBJREwuT3B0KElETC5OYXQ2NCksXG4gICAgfSk7XG4gICAgY29uc3Qgbm9kZV9tZXRyaWNzX2hpc3RvcnlfYXJncyA9IElETC5SZWNvcmQoe1xuICAgICAgICBzdGFydF9hdF90aW1lc3RhbXBfbmFub3M6IElETC5OYXQ2NCxcbiAgICAgICAgc3VibmV0X2lkOiBJREwuUHJpbmNpcGFsLFxuICAgIH0pO1xuICAgIGNvbnN0IG5vZGVfbWV0cmljcyA9IElETC5SZWNvcmQoe1xuICAgICAgICBudW1fYmxvY2tfZmFpbHVyZXNfdG90YWw6IElETC5OYXQ2NCxcbiAgICAgICAgbm9kZV9pZDogSURMLlByaW5jaXBhbCxcbiAgICAgICAgbnVtX2Jsb2Nrc19wcm9wb3NlZF90b3RhbDogSURMLk5hdDY0LFxuICAgIH0pO1xuICAgIGNvbnN0IG5vZGVfbWV0cmljc19oaXN0b3J5X3Jlc3VsdCA9IElETC5WZWMoSURMLlJlY29yZCh7XG4gICAgICAgIHRpbWVzdGFtcF9uYW5vczogSURMLk5hdDY0LFxuICAgICAgICBub2RlX21ldHJpY3M6IElETC5WZWMobm9kZV9tZXRyaWNzKSxcbiAgICB9KSk7XG4gICAgY29uc3QgcHJvdmlzaW9uYWxfY3JlYXRlX2NhbmlzdGVyX3dpdGhfY3ljbGVzX2FyZ3MgPSBJREwuUmVjb3JkKHtcbiAgICAgICAgc2V0dGluZ3M6IElETC5PcHQoY2FuaXN0ZXJfc2V0dGluZ3MpLFxuICAgICAgICBzcGVjaWZpZWRfaWQ6IElETC5PcHQoY2FuaXN0ZXJfaWQpLFxuICAgICAgICBhbW91bnQ6IElETC5PcHQoSURMLk5hdCksXG4gICAgICAgIHNlbmRlcl9jYW5pc3Rlcl92ZXJzaW9uOiBJREwuT3B0KElETC5OYXQ2NCksXG4gICAgfSk7XG4gICAgY29uc3QgcHJvdmlzaW9uYWxfY3JlYXRlX2NhbmlzdGVyX3dpdGhfY3ljbGVzX3Jlc3VsdCA9IElETC5SZWNvcmQoe1xuICAgICAgICBjYW5pc3Rlcl9pZDogY2FuaXN0ZXJfaWQsXG4gICAgfSk7XG4gICAgY29uc3QgcHJvdmlzaW9uYWxfdG9wX3VwX2NhbmlzdGVyX2FyZ3MgPSBJREwuUmVjb3JkKHtcbiAgICAgICAgY2FuaXN0ZXJfaWQ6IGNhbmlzdGVyX2lkLFxuICAgICAgICBhbW91bnQ6IElETC5OYXQsXG4gICAgfSk7XG4gICAgY29uc3QgcmF3X3JhbmRfcmVzdWx0ID0gSURMLlZlYyhJREwuTmF0OCk7XG4gICAgY29uc3Qgc2lnbl93aXRoX2VjZHNhX2FyZ3MgPSBJREwuUmVjb3JkKHtcbiAgICAgICAga2V5X2lkOiBJREwuUmVjb3JkKHsgbmFtZTogSURMLlRleHQsIGN1cnZlOiBlY2RzYV9jdXJ2ZSB9KSxcbiAgICAgICAgZGVyaXZhdGlvbl9wYXRoOiBJREwuVmVjKElETC5WZWMoSURMLk5hdDgpKSxcbiAgICAgICAgbWVzc2FnZV9oYXNoOiBJREwuVmVjKElETC5OYXQ4KSxcbiAgICB9KTtcbiAgICBjb25zdCBzaWduX3dpdGhfZWNkc2FfcmVzdWx0ID0gSURMLlJlY29yZCh7XG4gICAgICAgIHNpZ25hdHVyZTogSURMLlZlYyhJREwuTmF0OCksXG4gICAgfSk7XG4gICAgY29uc3Qgc3RhcnRfY2FuaXN0ZXJfYXJncyA9IElETC5SZWNvcmQoeyBjYW5pc3Rlcl9pZDogY2FuaXN0ZXJfaWQgfSk7XG4gICAgY29uc3Qgc3RvcF9jYW5pc3Rlcl9hcmdzID0gSURMLlJlY29yZCh7IGNhbmlzdGVyX2lkOiBjYW5pc3Rlcl9pZCB9KTtcbiAgICBjb25zdCBzdG9yZWRfY2h1bmtzX2FyZ3MgPSBJREwuUmVjb3JkKHsgY2FuaXN0ZXJfaWQ6IGNhbmlzdGVyX2lkIH0pO1xuICAgIGNvbnN0IHN0b3JlZF9jaHVua3NfcmVzdWx0ID0gSURMLlZlYyhjaHVua19oYXNoKTtcbiAgICBjb25zdCB1bmluc3RhbGxfY29kZV9hcmdzID0gSURMLlJlY29yZCh7XG4gICAgICAgIGNhbmlzdGVyX2lkOiBjYW5pc3Rlcl9pZCxcbiAgICAgICAgc2VuZGVyX2NhbmlzdGVyX3ZlcnNpb246IElETC5PcHQoSURMLk5hdDY0KSxcbiAgICB9KTtcbiAgICBjb25zdCB1cGRhdGVfc2V0dGluZ3NfYXJncyA9IElETC5SZWNvcmQoe1xuICAgICAgICBjYW5pc3Rlcl9pZDogSURMLlByaW5jaXBhbCxcbiAgICAgICAgc2V0dGluZ3M6IGNhbmlzdGVyX3NldHRpbmdzLFxuICAgICAgICBzZW5kZXJfY2FuaXN0ZXJfdmVyc2lvbjogSURMLk9wdChJREwuTmF0NjQpLFxuICAgIH0pO1xuICAgIGNvbnN0IHVwbG9hZF9jaHVua19hcmdzID0gSURMLlJlY29yZCh7XG4gICAgICAgIGNodW5rOiBJREwuVmVjKElETC5OYXQ4KSxcbiAgICAgICAgY2FuaXN0ZXJfaWQ6IElETC5QcmluY2lwYWwsXG4gICAgfSk7XG4gICAgY29uc3QgdXBsb2FkX2NodW5rX3Jlc3VsdCA9IGNodW5rX2hhc2g7XG4gICAgcmV0dXJuIElETC5TZXJ2aWNlKHtcbiAgICAgICAgYml0Y29pbl9nZXRfYmFsYW5jZTogSURMLkZ1bmMoW2JpdGNvaW5fZ2V0X2JhbGFuY2VfYXJnc10sIFtiaXRjb2luX2dldF9iYWxhbmNlX3Jlc3VsdF0sIFtdKSxcbiAgICAgICAgYml0Y29pbl9nZXRfY3VycmVudF9mZWVfcGVyY2VudGlsZXM6IElETC5GdW5jKFtiaXRjb2luX2dldF9jdXJyZW50X2ZlZV9wZXJjZW50aWxlc19hcmdzXSwgW2JpdGNvaW5fZ2V0X2N1cnJlbnRfZmVlX3BlcmNlbnRpbGVzX3Jlc3VsdF0sIFtdKSxcbiAgICAgICAgYml0Y29pbl9nZXRfdXR4b3M6IElETC5GdW5jKFtiaXRjb2luX2dldF91dHhvc19hcmdzXSwgW2JpdGNvaW5fZ2V0X3V0eG9zX3Jlc3VsdF0sIFtdKSxcbiAgICAgICAgYml0Y29pbl9zZW5kX3RyYW5zYWN0aW9uOiBJREwuRnVuYyhbYml0Y29pbl9zZW5kX3RyYW5zYWN0aW9uX2FyZ3NdLCBbXSwgW10pLFxuICAgICAgICBjYW5pc3Rlcl9pbmZvOiBJREwuRnVuYyhbY2FuaXN0ZXJfaW5mb19hcmdzXSwgW2NhbmlzdGVyX2luZm9fcmVzdWx0XSwgW10pLFxuICAgICAgICBjYW5pc3Rlcl9zdGF0dXM6IElETC5GdW5jKFtjYW5pc3Rlcl9zdGF0dXNfYXJnc10sIFtjYW5pc3Rlcl9zdGF0dXNfcmVzdWx0XSwgW10pLFxuICAgICAgICBjbGVhcl9jaHVua19zdG9yZTogSURMLkZ1bmMoW2NsZWFyX2NodW5rX3N0b3JlX2FyZ3NdLCBbXSwgW10pLFxuICAgICAgICBjcmVhdGVfY2FuaXN0ZXI6IElETC5GdW5jKFtjcmVhdGVfY2FuaXN0ZXJfYXJnc10sIFtjcmVhdGVfY2FuaXN0ZXJfcmVzdWx0XSwgW10pLFxuICAgICAgICBkZWxldGVfY2FuaXN0ZXI6IElETC5GdW5jKFtkZWxldGVfY2FuaXN0ZXJfYXJnc10sIFtdLCBbXSksXG4gICAgICAgIGRlcG9zaXRfY3ljbGVzOiBJREwuRnVuYyhbZGVwb3NpdF9jeWNsZXNfYXJnc10sIFtdLCBbXSksXG4gICAgICAgIGVjZHNhX3B1YmxpY19rZXk6IElETC5GdW5jKFtlY2RzYV9wdWJsaWNfa2V5X2FyZ3NdLCBbZWNkc2FfcHVibGljX2tleV9yZXN1bHRdLCBbXSksXG4gICAgICAgIGZldGNoX2NhbmlzdGVyX2xvZ3M6IElETC5GdW5jKFtmZXRjaF9jYW5pc3Rlcl9sb2dzX2FyZ3NdLCBbZmV0Y2hfY2FuaXN0ZXJfbG9nc19yZXN1bHRdLCBbJ3F1ZXJ5J10pLFxuICAgICAgICBodHRwX3JlcXVlc3Q6IElETC5GdW5jKFtodHRwX3JlcXVlc3RfYXJnc10sIFtodHRwX3JlcXVlc3RfcmVzdWx0XSwgW10pLFxuICAgICAgICBpbnN0YWxsX2NodW5rZWRfY29kZTogSURMLkZ1bmMoW2luc3RhbGxfY2h1bmtlZF9jb2RlX2FyZ3NdLCBbXSwgW10pLFxuICAgICAgICBpbnN0YWxsX2NvZGU6IElETC5GdW5jKFtpbnN0YWxsX2NvZGVfYXJnc10sIFtdLCBbXSksXG4gICAgICAgIG5vZGVfbWV0cmljc19oaXN0b3J5OiBJREwuRnVuYyhbbm9kZV9tZXRyaWNzX2hpc3RvcnlfYXJnc10sIFtub2RlX21ldHJpY3NfaGlzdG9yeV9yZXN1bHRdLCBbXSksXG4gICAgICAgIHByb3Zpc2lvbmFsX2NyZWF0ZV9jYW5pc3Rlcl93aXRoX2N5Y2xlczogSURMLkZ1bmMoW3Byb3Zpc2lvbmFsX2NyZWF0ZV9jYW5pc3Rlcl93aXRoX2N5Y2xlc19hcmdzXSwgW3Byb3Zpc2lvbmFsX2NyZWF0ZV9jYW5pc3Rlcl93aXRoX2N5Y2xlc19yZXN1bHRdLCBbXSksXG4gICAgICAgIHByb3Zpc2lvbmFsX3RvcF91cF9jYW5pc3RlcjogSURMLkZ1bmMoW3Byb3Zpc2lvbmFsX3RvcF91cF9jYW5pc3Rlcl9hcmdzXSwgW10sIFtdKSxcbiAgICAgICAgcmF3X3JhbmQ6IElETC5GdW5jKFtdLCBbcmF3X3JhbmRfcmVzdWx0XSwgW10pLFxuICAgICAgICBzaWduX3dpdGhfZWNkc2E6IElETC5GdW5jKFtzaWduX3dpdGhfZWNkc2FfYXJnc10sIFtzaWduX3dpdGhfZWNkc2FfcmVzdWx0XSwgW10pLFxuICAgICAgICBzdGFydF9jYW5pc3RlcjogSURMLkZ1bmMoW3N0YXJ0X2NhbmlzdGVyX2FyZ3NdLCBbXSwgW10pLFxuICAgICAgICBzdG9wX2NhbmlzdGVyOiBJREwuRnVuYyhbc3RvcF9jYW5pc3Rlcl9hcmdzXSwgW10sIFtdKSxcbiAgICAgICAgc3RvcmVkX2NodW5rczogSURMLkZ1bmMoW3N0b3JlZF9jaHVua3NfYXJnc10sIFtzdG9yZWRfY2h1bmtzX3Jlc3VsdF0sIFtdKSxcbiAgICAgICAgdW5pbnN0YWxsX2NvZGU6IElETC5GdW5jKFt1bmluc3RhbGxfY29kZV9hcmdzXSwgW10sIFtdKSxcbiAgICAgICAgdXBkYXRlX3NldHRpbmdzOiBJREwuRnVuYyhbdXBkYXRlX3NldHRpbmdzX2FyZ3NdLCBbXSwgW10pLFxuICAgICAgICB1cGxvYWRfY2h1bms6IElETC5GdW5jKFt1cGxvYWRfY2h1bmtfYXJnc10sIFt1cGxvYWRfY2h1bmtfcmVzdWx0XSwgW10pLFxuICAgIH0pO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1hbmFnZW1lbnRfaWRsLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/@dfinity/agent/lib/esm/canisters/management_idl.js\n"));

/***/ }),

/***/ "./node_modules/@dfinity/agent/lib/esm/certificate.js":
/*!************************************************************!*\
  !*** ./node_modules/@dfinity/agent/lib/esm/certificate.js ***!
  \************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Certificate: function() { return /* binding */ Certificate; },\n/* harmony export */   CertificateVerificationError: function() { return /* binding */ CertificateVerificationError; },\n/* harmony export */   LookupStatus: function() { return /* binding */ LookupStatus; },\n/* harmony export */   NodeType: function() { return /* binding */ NodeType; },\n/* harmony export */   check_canister_ranges: function() { return /* binding */ check_canister_ranges; },\n/* harmony export */   find_label: function() { return /* binding */ find_label; },\n/* harmony export */   flatten_forks: function() { return /* binding */ flatten_forks; },\n/* harmony export */   hashTreeToString: function() { return /* binding */ hashTreeToString; },\n/* harmony export */   lookupResultToBuffer: function() { return /* binding */ lookupResultToBuffer; },\n/* harmony export */   lookup_path: function() { return /* binding */ lookup_path; },\n/* harmony export */   reconstruct: function() { return /* binding */ reconstruct; }\n/* harmony export */ });\n/* harmony import */ var _cbor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./cbor */ \"./node_modules/@dfinity/agent/lib/esm/cbor.js\");\n/* harmony import */ var _errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./errors */ \"./node_modules/@dfinity/agent/lib/esm/errors.js\");\n/* harmony import */ var _request_id__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./request_id */ \"./node_modules/@dfinity/agent/lib/esm/request_id.js\");\n/* harmony import */ var _utils_buffer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/buffer */ \"./node_modules/@dfinity/agent/lib/esm/utils/buffer.js\");\n/* harmony import */ var _dfinity_principal__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dfinity/principal */ \"./node_modules/@dfinity/principal/lib/esm/index.js\");\n/* harmony import */ var _utils_bls__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./utils/bls */ \"./node_modules/@dfinity/agent/lib/esm/utils/bls.js\");\n/* harmony import */ var _utils_leb__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./utils/leb */ \"./node_modules/@dfinity/agent/lib/esm/utils/leb.js\");\n\n\n\n\n\n\n\n/**\n * A certificate may fail verification with respect to the provided public key\n */\nclass CertificateVerificationError extends _errors__WEBPACK_IMPORTED_MODULE_1__.AgentError {\n    constructor(reason) {\n        super(`Invalid certificate: ${reason}`);\n    }\n}\nvar NodeType;\n(function (NodeType) {\n    NodeType[NodeType[\"Empty\"] = 0] = \"Empty\";\n    NodeType[NodeType[\"Fork\"] = 1] = \"Fork\";\n    NodeType[NodeType[\"Labeled\"] = 2] = \"Labeled\";\n    NodeType[NodeType[\"Leaf\"] = 3] = \"Leaf\";\n    NodeType[NodeType[\"Pruned\"] = 4] = \"Pruned\";\n})(NodeType || (NodeType = {}));\n/**\n * Make a human readable string out of a hash tree.\n * @param tree\n */\nfunction hashTreeToString(tree) {\n    const indent = (s) => s\n        .split('\\n')\n        .map(x => '  ' + x)\n        .join('\\n');\n    function labelToString(label) {\n        const decoder = new TextDecoder(undefined, { fatal: true });\n        try {\n            return JSON.stringify(decoder.decode(label));\n        }\n        catch (e) {\n            return `data(...${label.byteLength} bytes)`;\n        }\n    }\n    switch (tree[0]) {\n        case NodeType.Empty:\n            return '()';\n        case NodeType.Fork: {\n            if (tree[1] instanceof Array && tree[2] instanceof ArrayBuffer) {\n                const left = hashTreeToString(tree[1]);\n                const right = hashTreeToString(tree[2]);\n                return `sub(\\n left:\\n${indent(left)}\\n---\\n right:\\n${indent(right)}\\n)`;\n            }\n            else {\n                throw new Error('Invalid tree structure for fork');\n            }\n        }\n        case NodeType.Labeled: {\n            if (tree[1] instanceof ArrayBuffer && tree[2] instanceof ArrayBuffer) {\n                const label = labelToString(tree[1]);\n                const sub = hashTreeToString(tree[2]);\n                return `label(\\n label:\\n${indent(label)}\\n sub:\\n${indent(sub)}\\n)`;\n            }\n            else {\n                throw new Error('Invalid tree structure for labeled');\n            }\n        }\n        case NodeType.Leaf: {\n            if (!tree[1]) {\n                throw new Error('Invalid tree structure for leaf');\n            }\n            else if (Array.isArray(tree[1])) {\n                return JSON.stringify(tree[1]);\n            }\n            return `leaf(...${tree[1].byteLength} bytes)`;\n        }\n        case NodeType.Pruned: {\n            if (!tree[1]) {\n                throw new Error('Invalid tree structure for pruned');\n            }\n            else if (Array.isArray(tree[1])) {\n                return JSON.stringify(tree[1]);\n            }\n            return `pruned(${(0,_utils_buffer__WEBPACK_IMPORTED_MODULE_3__.toHex)(new Uint8Array(tree[1]))}`;\n        }\n        default: {\n            return `unknown(${JSON.stringify(tree[0])})`;\n        }\n    }\n}\nfunction isBufferGreaterThan(a, b) {\n    const a8 = new Uint8Array(a);\n    const b8 = new Uint8Array(b);\n    for (let i = 0; i < a8.length; i++) {\n        if (a8[i] > b8[i]) {\n            return true;\n        }\n    }\n    return false;\n}\nclass Certificate {\n    constructor(certificate, _rootKey, _canisterId, _blsVerify, \n    // Default to 5 minutes\n    _maxAgeInMinutes = 5) {\n        this._rootKey = _rootKey;\n        this._canisterId = _canisterId;\n        this._blsVerify = _blsVerify;\n        this._maxAgeInMinutes = _maxAgeInMinutes;\n        this.cert = _cbor__WEBPACK_IMPORTED_MODULE_0__.decode(new Uint8Array(certificate));\n    }\n    /**\n     * Create a new instance of a certificate, automatically verifying it. Throws a\n     * CertificateVerificationError if the certificate cannot be verified.\n     * @constructs  Certificate\n     * @param {CreateCertificateOptions} options {@link CreateCertificateOptions}\n     * @param {ArrayBuffer} options.certificate The bytes of the certificate\n     * @param {ArrayBuffer} options.rootKey The root key to verify against\n     * @param {Principal} options.canisterId The effective or signing canister ID\n     * @param {number} options.maxAgeInMinutes The maximum age of the certificate in minutes. Default is 5 minutes.\n     * @throws {CertificateVerificationError}\n     */\n    static async create(options) {\n        const cert = Certificate.createUnverified(options);\n        await cert.verify();\n        return cert;\n    }\n    static createUnverified(options) {\n        let blsVerify = options.blsVerify;\n        if (!blsVerify) {\n            blsVerify = _utils_bls__WEBPACK_IMPORTED_MODULE_5__.blsVerify;\n        }\n        return new Certificate(options.certificate, options.rootKey, options.canisterId, blsVerify, options.maxAgeInMinutes);\n    }\n    lookup(path) {\n        // constrain the type of the result, so that empty HashTree is undefined\n        return lookup_path(path, this.cert.tree);\n    }\n    lookup_label(label) {\n        return this.lookup([label]);\n    }\n    async verify() {\n        const rootHash = await reconstruct(this.cert.tree);\n        const derKey = await this._checkDelegationAndGetKey(this.cert.delegation);\n        const sig = this.cert.signature;\n        const key = extractDER(derKey);\n        const msg = (0,_utils_buffer__WEBPACK_IMPORTED_MODULE_3__.concat)(domain_sep('ic-state-root'), rootHash);\n        let sigVer = false;\n        const lookupTime = lookupResultToBuffer(this.lookup(['time']));\n        if (!lookupTime) {\n            // Should never happen - time is always present in IC certificates\n            throw new CertificateVerificationError('Certificate does not contain a time');\n        }\n        const FIVE_MINUTES_IN_MSEC = 5 * 60 * 1000;\n        const MAX_AGE_IN_MSEC = this._maxAgeInMinutes * 60 * 1000;\n        const now = Date.now();\n        const earliestCertificateTime = now - MAX_AGE_IN_MSEC;\n        const fiveMinutesFromNow = now + FIVE_MINUTES_IN_MSEC;\n        const certTime = (0,_utils_leb__WEBPACK_IMPORTED_MODULE_6__.decodeTime)(lookupTime);\n        if (certTime.getTime() < earliestCertificateTime) {\n            throw new CertificateVerificationError(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: ` +\n                certTime.toISOString() +\n                ' Current time: ' +\n                new Date(now).toISOString());\n        }\n        else if (certTime.getTime() > fiveMinutesFromNow) {\n            throw new CertificateVerificationError('Certificate is signed more than 5 minutes in the future. Certificate time: ' +\n                certTime.toISOString() +\n                ' Current time: ' +\n                new Date(now).toISOString());\n        }\n        try {\n            sigVer = await this._blsVerify(new Uint8Array(key), new Uint8Array(sig), new Uint8Array(msg));\n        }\n        catch (err) {\n            sigVer = false;\n        }\n        if (!sigVer) {\n            throw new CertificateVerificationError('Signature verification failed');\n        }\n    }\n    async _checkDelegationAndGetKey(d) {\n        if (!d) {\n            return this._rootKey;\n        }\n        const cert = await Certificate.createUnverified({\n            certificate: d.certificate,\n            rootKey: this._rootKey,\n            canisterId: this._canisterId,\n            blsVerify: this._blsVerify,\n            // Do not check max age for delegation certificates\n            maxAgeInMinutes: Infinity,\n        });\n        if (cert.cert.delegation) {\n            throw new CertificateVerificationError('Delegation certificates cannot be nested');\n        }\n        await cert.verify();\n        const canisterInRange = check_canister_ranges({\n            canisterId: this._canisterId,\n            subnetId: _dfinity_principal__WEBPACK_IMPORTED_MODULE_4__.Principal.fromUint8Array(new Uint8Array(d.subnet_id)),\n            tree: cert.cert.tree,\n        });\n        if (!canisterInRange) {\n            throw new CertificateVerificationError(`Canister ${this._canisterId} not in range of delegations for subnet 0x${(0,_utils_buffer__WEBPACK_IMPORTED_MODULE_3__.toHex)(d.subnet_id)}`);\n        }\n        const publicKeyLookup = lookupResultToBuffer(cert.lookup(['subnet', d.subnet_id, 'public_key']));\n        if (!publicKeyLookup) {\n            throw new Error(`Could not find subnet key for subnet 0x${(0,_utils_buffer__WEBPACK_IMPORTED_MODULE_3__.toHex)(d.subnet_id)}`);\n        }\n        return publicKeyLookup;\n    }\n}\nconst DER_PREFIX = (0,_utils_buffer__WEBPACK_IMPORTED_MODULE_3__.fromHex)('308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100');\nconst KEY_LENGTH = 96;\nfunction extractDER(buf) {\n    const expectedLength = DER_PREFIX.byteLength + KEY_LENGTH;\n    if (buf.byteLength !== expectedLength) {\n        throw new TypeError(`BLS DER-encoded public key must be ${expectedLength} bytes long`);\n    }\n    const prefix = buf.slice(0, DER_PREFIX.byteLength);\n    if (!(0,_utils_buffer__WEBPACK_IMPORTED_MODULE_3__.bufEquals)(prefix, DER_PREFIX)) {\n        throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${DER_PREFIX}, but get ${prefix}`);\n    }\n    return buf.slice(DER_PREFIX.byteLength);\n}\n/**\n * utility function to constrain the type of a path\n * @param {ArrayBuffer | HashTree | undefined} result - the result of a lookup\n * @returns ArrayBuffer or Undefined\n */\nfunction lookupResultToBuffer(result) {\n    if (result.status !== LookupStatus.Found) {\n        return undefined;\n    }\n    if (result.value instanceof ArrayBuffer) {\n        return result.value;\n    }\n    if (result.value instanceof Uint8Array) {\n        return result.value.buffer;\n    }\n    return undefined;\n}\n/**\n * @param t\n */\nasync function reconstruct(t) {\n    switch (t[0]) {\n        case NodeType.Empty:\n            return (0,_request_id__WEBPACK_IMPORTED_MODULE_2__.hash)(domain_sep('ic-hashtree-empty'));\n        case NodeType.Pruned:\n            return t[1];\n        case NodeType.Leaf:\n            return (0,_request_id__WEBPACK_IMPORTED_MODULE_2__.hash)((0,_utils_buffer__WEBPACK_IMPORTED_MODULE_3__.concat)(domain_sep('ic-hashtree-leaf'), t[1]));\n        case NodeType.Labeled:\n            return (0,_request_id__WEBPACK_IMPORTED_MODULE_2__.hash)((0,_utils_buffer__WEBPACK_IMPORTED_MODULE_3__.concat)(domain_sep('ic-hashtree-labeled'), t[1], await reconstruct(t[2])));\n        case NodeType.Fork:\n            return (0,_request_id__WEBPACK_IMPORTED_MODULE_2__.hash)((0,_utils_buffer__WEBPACK_IMPORTED_MODULE_3__.concat)(domain_sep('ic-hashtree-fork'), await reconstruct(t[1]), await reconstruct(t[2])));\n        default:\n            throw new Error('unreachable');\n    }\n}\nfunction domain_sep(s) {\n    const len = new Uint8Array([s.length]);\n    const str = new TextEncoder().encode(s);\n    return (0,_utils_buffer__WEBPACK_IMPORTED_MODULE_3__.concat)(len, str);\n}\nvar LookupStatus;\n(function (LookupStatus) {\n    LookupStatus[\"Unknown\"] = \"unknown\";\n    LookupStatus[\"Absent\"] = \"absent\";\n    LookupStatus[\"Found\"] = \"found\";\n})(LookupStatus || (LookupStatus = {}));\nvar LabelLookupStatus;\n(function (LabelLookupStatus) {\n    LabelLookupStatus[\"Less\"] = \"less\";\n    LabelLookupStatus[\"Greater\"] = \"greater\";\n})(LabelLookupStatus || (LabelLookupStatus = {}));\nfunction lookup_path(path, tree) {\n    if (path.length === 0) {\n        switch (tree[0]) {\n            case NodeType.Leaf: {\n                if (!tree[1]) {\n                    throw new Error('Invalid tree structure for leaf');\n                }\n                if (tree[1] instanceof ArrayBuffer) {\n                    return {\n                        status: LookupStatus.Found,\n                        value: tree[1],\n                    };\n                }\n                if (tree[1] instanceof Uint8Array) {\n                    return {\n                        status: LookupStatus.Found,\n                        value: tree[1].buffer,\n                    };\n                }\n                return {\n                    status: LookupStatus.Found,\n                    value: tree[1],\n                };\n            }\n            default: {\n                return {\n                    status: LookupStatus.Found,\n                    value: tree,\n                };\n            }\n        }\n    }\n    const label = typeof path[0] === 'string' ? new TextEncoder().encode(path[0]) : path[0];\n    const lookupResult = find_label(label, tree);\n    switch (lookupResult.status) {\n        case LookupStatus.Found: {\n            return lookup_path(path.slice(1), lookupResult.value);\n        }\n        case LabelLookupStatus.Greater:\n        case LabelLookupStatus.Less: {\n            return {\n                status: LookupStatus.Absent,\n            };\n        }\n        default: {\n            return lookupResult;\n        }\n    }\n}\n/**\n * If the tree is a fork, flatten it into an array of trees\n * @param t - the tree to flatten\n * @returns HashTree[] - the flattened tree\n */\nfunction flatten_forks(t) {\n    switch (t[0]) {\n        case NodeType.Empty:\n            return [];\n        case NodeType.Fork:\n            return flatten_forks(t[1]).concat(flatten_forks(t[2]));\n        default:\n            return [t];\n    }\n}\nfunction find_label(label, tree) {\n    switch (tree[0]) {\n        // if we have a labelled node, compare the node's label to the one we are\n        // looking for\n        case NodeType.Labeled:\n            // if the label we're searching for is greater than this node's label,\n            // we need to keep searching\n            if (isBufferGreaterThan(label, tree[1])) {\n                return {\n                    status: LabelLookupStatus.Greater,\n                };\n            }\n            // if the label we're searching for is equal this node's label, we can\n            // stop searching and return the found node\n            if ((0,_utils_buffer__WEBPACK_IMPORTED_MODULE_3__.bufEquals)(label, tree[1])) {\n                return {\n                    status: LookupStatus.Found,\n                    value: tree[2],\n                };\n            }\n            // if the label we're searching for is not greater than or equal to this\n            // node's label, then it's less than this node's label, and we can stop\n            // searching because we've looked too far\n            return {\n                status: LabelLookupStatus.Less,\n            };\n        // if we have a fork node, we need to search both sides, starting with the left\n        case NodeType.Fork:\n            // search in the left node\n            const leftLookupResult = find_label(label, tree[1]);\n            switch (leftLookupResult.status) {\n                // if the label we're searching for is greater than the left node lookup,\n                // we need to search the right node\n                case LabelLookupStatus.Greater: {\n                    const rightLookupResult = find_label(label, tree[2]);\n                    // if the label we're searching for is less than the right node lookup,\n                    // then we can stop searching and say that the label is provably Absent\n                    if (rightLookupResult.status === LabelLookupStatus.Less) {\n                        return {\n                            status: LookupStatus.Absent,\n                        };\n                    }\n                    // if the label we're searching for is less than or equal to the right\n                    // node lookup, then we let the caller handle it\n                    return rightLookupResult;\n                }\n                // if the left node returns an uncertain result, we need to search the\n                // right node\n                case LookupStatus.Unknown: {\n                    let rightLookupResult = find_label(label, tree[2]);\n                    // if the label we're searching for is less than the right node lookup,\n                    // then we also need to return an uncertain result\n                    if (rightLookupResult.status === LabelLookupStatus.Less) {\n                        return {\n                            status: LookupStatus.Unknown,\n                        };\n                    }\n                    // if the label we're searching for is less than or equal to the right\n                    // node lookup, then we let the caller handle it\n                    return rightLookupResult;\n                }\n                // if the label we're searching for is not greater than the left node\n                // lookup, or the result is not uncertain, we stop searching and return\n                // whatever the result of the left node lookup was, which can be either\n                // Found or Absent\n                default: {\n                    return leftLookupResult;\n                }\n            }\n        // if we encounter a Pruned node, we can't know for certain if the label\n        // we're searching for is present or not\n        case NodeType.Pruned:\n            return {\n                status: LookupStatus.Unknown,\n            };\n        // if the current node is Empty, or a Leaf, we can stop searching because\n        // we know for sure that the label we're searching for is not present\n        default:\n            return {\n                status: LookupStatus.Absent,\n            };\n    }\n}\n/**\n * Check if a canister falls within a range of canisters\n * @param canisterId Principal\n * @param ranges [Principal, Principal][]\n * @returns\n */\nfunction check_canister_ranges(params) {\n    const { canisterId, subnetId, tree } = params;\n    const rangeLookup = lookup_path(['subnet', subnetId.toUint8Array(), 'canister_ranges'], tree);\n    if (rangeLookup.status !== LookupStatus.Found || !(rangeLookup.value instanceof ArrayBuffer)) {\n        throw new Error(`Could not find canister ranges for subnet ${subnetId}`);\n    }\n    const ranges_arr = _cbor__WEBPACK_IMPORTED_MODULE_0__.decode(rangeLookup.value);\n    const ranges = ranges_arr.map(v => [\n        _dfinity_principal__WEBPACK_IMPORTED_MODULE_4__.Principal.fromUint8Array(v[0]),\n        _dfinity_principal__WEBPACK_IMPORTED_MODULE_4__.Principal.fromUint8Array(v[1]),\n    ]);\n    const canisterInRange = ranges.some(r => r[0].ltEq(canisterId) && r[1].gtEq(canisterId));\n    return canisterInRange;\n}\n//# sourceMappingURL=certificate.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYWdlbnQvbGliL2VzbS9jZXJ0aWZpY2F0ZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0I7QUFDTztBQUNGO0FBQytCO0FBQ3BCO0FBQ1o7QUFDTTtBQUN6QztBQUNBO0FBQ0E7QUFDTywyQ0FBMkMsK0NBQVU7QUFDNUQ7QUFDQSxzQ0FBc0MsT0FBTztBQUM3QztBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDRCQUE0QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxhQUFhO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLGtCQUFrQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsYUFBYSxrQkFBa0IsY0FBYztBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsY0FBYyxXQUFXLFlBQVk7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLG9CQUFvQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLG9EQUFLLDBCQUEwQjtBQUM1RDtBQUNBO0FBQ0EsOEJBQThCLHdCQUF3QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsZUFBZTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHlDQUFXO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDBCQUEwQixTQUFTO0FBQ2xELGVBQWUsYUFBYTtBQUM1QixlQUFlLGFBQWE7QUFDNUIsZUFBZSxXQUFXO0FBQzFCLGVBQWUsUUFBUTtBQUN2QixnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlEQUFhO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixxREFBTTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHNEQUFVO0FBQ25DO0FBQ0Esc0ZBQXNGLHVCQUF1QjtBQUM3RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IseURBQVM7QUFDL0I7QUFDQSxTQUFTO0FBQ1Q7QUFDQSwrREFBK0Qsa0JBQWtCLDJDQUEyQyxvREFBSyxjQUFjO0FBQy9JO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRSxvREFBSyxjQUFjO0FBQ3pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHNEQUFPO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFLGdCQUFnQjtBQUNsRjtBQUNBO0FBQ0EsU0FBUyx3REFBUztBQUNsQixtR0FBbUcsV0FBVyxZQUFZLE9BQU87QUFDakk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsb0NBQW9DO0FBQy9DO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQSxtQkFBbUIsaURBQUk7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGlEQUFJLENBQUMscURBQU07QUFDOUI7QUFDQSxtQkFBbUIsaURBQUksQ0FBQyxxREFBTTtBQUM5QjtBQUNBLG1CQUFtQixpREFBSSxDQUFDLHFEQUFNO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxxREFBTTtBQUNqQjtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLG9DQUFvQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsOENBQThDO0FBQ3hDO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix3REFBUztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCxZQUFZLDZCQUE2QjtBQUN6QztBQUNBO0FBQ0EscUVBQXFFLFNBQVM7QUFDOUU7QUFDQSx1QkFBdUIseUNBQVc7QUFDbEM7QUFDQSxRQUFRLHlEQUFTO0FBQ2pCLFFBQVEseURBQVM7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYWdlbnQvbGliL2VzbS9jZXJ0aWZpY2F0ZS5qcz9iZjc0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGNib3IgZnJvbSAnLi9jYm9yJztcbmltcG9ydCB7IEFnZW50RXJyb3IgfSBmcm9tICcuL2Vycm9ycyc7XG5pbXBvcnQgeyBoYXNoIH0gZnJvbSAnLi9yZXF1ZXN0X2lkJztcbmltcG9ydCB7IGJ1ZkVxdWFscywgY29uY2F0LCBmcm9tSGV4LCB0b0hleCB9IGZyb20gJy4vdXRpbHMvYnVmZmVyJztcbmltcG9ydCB7IFByaW5jaXBhbCB9IGZyb20gJ0BkZmluaXR5L3ByaW5jaXBhbCc7XG5pbXBvcnQgKiBhcyBibHMgZnJvbSAnLi91dGlscy9ibHMnO1xuaW1wb3J0IHsgZGVjb2RlVGltZSB9IGZyb20gJy4vdXRpbHMvbGViJztcbi8qKlxuICogQSBjZXJ0aWZpY2F0ZSBtYXkgZmFpbCB2ZXJpZmljYXRpb24gd2l0aCByZXNwZWN0IHRvIHRoZSBwcm92aWRlZCBwdWJsaWMga2V5XG4gKi9cbmV4cG9ydCBjbGFzcyBDZXJ0aWZpY2F0ZVZlcmlmaWNhdGlvbkVycm9yIGV4dGVuZHMgQWdlbnRFcnJvciB7XG4gICAgY29uc3RydWN0b3IocmVhc29uKSB7XG4gICAgICAgIHN1cGVyKGBJbnZhbGlkIGNlcnRpZmljYXRlOiAke3JlYXNvbn1gKTtcbiAgICB9XG59XG5leHBvcnQgdmFyIE5vZGVUeXBlO1xuKGZ1bmN0aW9uIChOb2RlVHlwZSkge1xuICAgIE5vZGVUeXBlW05vZGVUeXBlW1wiRW1wdHlcIl0gPSAwXSA9IFwiRW1wdHlcIjtcbiAgICBOb2RlVHlwZVtOb2RlVHlwZVtcIkZvcmtcIl0gPSAxXSA9IFwiRm9ya1wiO1xuICAgIE5vZGVUeXBlW05vZGVUeXBlW1wiTGFiZWxlZFwiXSA9IDJdID0gXCJMYWJlbGVkXCI7XG4gICAgTm9kZVR5cGVbTm9kZVR5cGVbXCJMZWFmXCJdID0gM10gPSBcIkxlYWZcIjtcbiAgICBOb2RlVHlwZVtOb2RlVHlwZVtcIlBydW5lZFwiXSA9IDRdID0gXCJQcnVuZWRcIjtcbn0pKE5vZGVUeXBlIHx8IChOb2RlVHlwZSA9IHt9KSk7XG4vKipcbiAqIE1ha2UgYSBodW1hbiByZWFkYWJsZSBzdHJpbmcgb3V0IG9mIGEgaGFzaCB0cmVlLlxuICogQHBhcmFtIHRyZWVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc2hUcmVlVG9TdHJpbmcodHJlZSkge1xuICAgIGNvbnN0IGluZGVudCA9IChzKSA9PiBzXG4gICAgICAgIC5zcGxpdCgnXFxuJylcbiAgICAgICAgLm1hcCh4ID0+ICcgICcgKyB4KVxuICAgICAgICAuam9pbignXFxuJyk7XG4gICAgZnVuY3Rpb24gbGFiZWxUb1N0cmluZyhsYWJlbCkge1xuICAgICAgICBjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKHVuZGVmaW5lZCwgeyBmYXRhbDogdHJ1ZSB9KTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShkZWNvZGVyLmRlY29kZShsYWJlbCkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gYGRhdGEoLi4uJHtsYWJlbC5ieXRlTGVuZ3RofSBieXRlcylgO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN3aXRjaCAodHJlZVswXSkge1xuICAgICAgICBjYXNlIE5vZGVUeXBlLkVtcHR5OlxuICAgICAgICAgICAgcmV0dXJuICcoKSc7XG4gICAgICAgIGNhc2UgTm9kZVR5cGUuRm9yazoge1xuICAgICAgICAgICAgaWYgKHRyZWVbMV0gaW5zdGFuY2VvZiBBcnJheSAmJiB0cmVlWzJdIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsZWZ0ID0gaGFzaFRyZWVUb1N0cmluZyh0cmVlWzFdKTtcbiAgICAgICAgICAgICAgICBjb25zdCByaWdodCA9IGhhc2hUcmVlVG9TdHJpbmcodHJlZVsyXSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBzdWIoXFxuIGxlZnQ6XFxuJHtpbmRlbnQobGVmdCl9XFxuLS0tXFxuIHJpZ2h0OlxcbiR7aW5kZW50KHJpZ2h0KX1cXG4pYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB0cmVlIHN0cnVjdHVyZSBmb3IgZm9yaycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhc2UgTm9kZVR5cGUuTGFiZWxlZDoge1xuICAgICAgICAgICAgaWYgKHRyZWVbMV0gaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciAmJiB0cmVlWzJdIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsYWJlbCA9IGxhYmVsVG9TdHJpbmcodHJlZVsxXSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3ViID0gaGFzaFRyZWVUb1N0cmluZyh0cmVlWzJdKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYGxhYmVsKFxcbiBsYWJlbDpcXG4ke2luZGVudChsYWJlbCl9XFxuIHN1YjpcXG4ke2luZGVudChzdWIpfVxcbilgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHRyZWUgc3RydWN0dXJlIGZvciBsYWJlbGVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBOb2RlVHlwZS5MZWFmOiB7XG4gICAgICAgICAgICBpZiAoIXRyZWVbMV0pIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdHJlZSBzdHJ1Y3R1cmUgZm9yIGxlYWYnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkodHJlZVsxXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodHJlZVsxXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYGxlYWYoLi4uJHt0cmVlWzFdLmJ5dGVMZW5ndGh9IGJ5dGVzKWA7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBOb2RlVHlwZS5QcnVuZWQ6IHtcbiAgICAgICAgICAgIGlmICghdHJlZVsxXSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB0cmVlIHN0cnVjdHVyZSBmb3IgcHJ1bmVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChBcnJheS5pc0FycmF5KHRyZWVbMV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRyZWVbMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGBwcnVuZWQoJHt0b0hleChuZXcgVWludDhBcnJheSh0cmVlWzFdKSl9YDtcbiAgICAgICAgfVxuICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICByZXR1cm4gYHVua25vd24oJHtKU09OLnN0cmluZ2lmeSh0cmVlWzBdKX0pYDtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGlzQnVmZmVyR3JlYXRlclRoYW4oYSwgYikge1xuICAgIGNvbnN0IGE4ID0gbmV3IFVpbnQ4QXJyYXkoYSk7XG4gICAgY29uc3QgYjggPSBuZXcgVWludDhBcnJheShiKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGE4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChhOFtpXSA+IGI4W2ldKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5leHBvcnQgY2xhc3MgQ2VydGlmaWNhdGUge1xuICAgIGNvbnN0cnVjdG9yKGNlcnRpZmljYXRlLCBfcm9vdEtleSwgX2NhbmlzdGVySWQsIF9ibHNWZXJpZnksIFxuICAgIC8vIERlZmF1bHQgdG8gNSBtaW51dGVzXG4gICAgX21heEFnZUluTWludXRlcyA9IDUpIHtcbiAgICAgICAgdGhpcy5fcm9vdEtleSA9IF9yb290S2V5O1xuICAgICAgICB0aGlzLl9jYW5pc3RlcklkID0gX2NhbmlzdGVySWQ7XG4gICAgICAgIHRoaXMuX2Jsc1ZlcmlmeSA9IF9ibHNWZXJpZnk7XG4gICAgICAgIHRoaXMuX21heEFnZUluTWludXRlcyA9IF9tYXhBZ2VJbk1pbnV0ZXM7XG4gICAgICAgIHRoaXMuY2VydCA9IGNib3IuZGVjb2RlKG5ldyBVaW50OEFycmF5KGNlcnRpZmljYXRlKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBpbnN0YW5jZSBvZiBhIGNlcnRpZmljYXRlLCBhdXRvbWF0aWNhbGx5IHZlcmlmeWluZyBpdC4gVGhyb3dzIGFcbiAgICAgKiBDZXJ0aWZpY2F0ZVZlcmlmaWNhdGlvbkVycm9yIGlmIHRoZSBjZXJ0aWZpY2F0ZSBjYW5ub3QgYmUgdmVyaWZpZWQuXG4gICAgICogQGNvbnN0cnVjdHMgIENlcnRpZmljYXRlXG4gICAgICogQHBhcmFtIHtDcmVhdGVDZXJ0aWZpY2F0ZU9wdGlvbnN9IG9wdGlvbnMge0BsaW5rIENyZWF0ZUNlcnRpZmljYXRlT3B0aW9uc31cbiAgICAgKiBAcGFyYW0ge0FycmF5QnVmZmVyfSBvcHRpb25zLmNlcnRpZmljYXRlIFRoZSBieXRlcyBvZiB0aGUgY2VydGlmaWNhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5QnVmZmVyfSBvcHRpb25zLnJvb3RLZXkgVGhlIHJvb3Qga2V5IHRvIHZlcmlmeSBhZ2FpbnN0XG4gICAgICogQHBhcmFtIHtQcmluY2lwYWx9IG9wdGlvbnMuY2FuaXN0ZXJJZCBUaGUgZWZmZWN0aXZlIG9yIHNpZ25pbmcgY2FuaXN0ZXIgSURcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb3B0aW9ucy5tYXhBZ2VJbk1pbnV0ZXMgVGhlIG1heGltdW0gYWdlIG9mIHRoZSBjZXJ0aWZpY2F0ZSBpbiBtaW51dGVzLiBEZWZhdWx0IGlzIDUgbWludXRlcy5cbiAgICAgKiBAdGhyb3dzIHtDZXJ0aWZpY2F0ZVZlcmlmaWNhdGlvbkVycm9yfVxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBjcmVhdGUob3B0aW9ucykge1xuICAgICAgICBjb25zdCBjZXJ0ID0gQ2VydGlmaWNhdGUuY3JlYXRlVW52ZXJpZmllZChvcHRpb25zKTtcbiAgICAgICAgYXdhaXQgY2VydC52ZXJpZnkoKTtcbiAgICAgICAgcmV0dXJuIGNlcnQ7XG4gICAgfVxuICAgIHN0YXRpYyBjcmVhdGVVbnZlcmlmaWVkKG9wdGlvbnMpIHtcbiAgICAgICAgbGV0IGJsc1ZlcmlmeSA9IG9wdGlvbnMuYmxzVmVyaWZ5O1xuICAgICAgICBpZiAoIWJsc1ZlcmlmeSkge1xuICAgICAgICAgICAgYmxzVmVyaWZ5ID0gYmxzLmJsc1ZlcmlmeTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IENlcnRpZmljYXRlKG9wdGlvbnMuY2VydGlmaWNhdGUsIG9wdGlvbnMucm9vdEtleSwgb3B0aW9ucy5jYW5pc3RlcklkLCBibHNWZXJpZnksIG9wdGlvbnMubWF4QWdlSW5NaW51dGVzKTtcbiAgICB9XG4gICAgbG9va3VwKHBhdGgpIHtcbiAgICAgICAgLy8gY29uc3RyYWluIHRoZSB0eXBlIG9mIHRoZSByZXN1bHQsIHNvIHRoYXQgZW1wdHkgSGFzaFRyZWUgaXMgdW5kZWZpbmVkXG4gICAgICAgIHJldHVybiBsb29rdXBfcGF0aChwYXRoLCB0aGlzLmNlcnQudHJlZSk7XG4gICAgfVxuICAgIGxvb2t1cF9sYWJlbChsYWJlbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb29rdXAoW2xhYmVsXSk7XG4gICAgfVxuICAgIGFzeW5jIHZlcmlmeSgpIHtcbiAgICAgICAgY29uc3Qgcm9vdEhhc2ggPSBhd2FpdCByZWNvbnN0cnVjdCh0aGlzLmNlcnQudHJlZSk7XG4gICAgICAgIGNvbnN0IGRlcktleSA9IGF3YWl0IHRoaXMuX2NoZWNrRGVsZWdhdGlvbkFuZEdldEtleSh0aGlzLmNlcnQuZGVsZWdhdGlvbik7XG4gICAgICAgIGNvbnN0IHNpZyA9IHRoaXMuY2VydC5zaWduYXR1cmU7XG4gICAgICAgIGNvbnN0IGtleSA9IGV4dHJhY3RERVIoZGVyS2V5KTtcbiAgICAgICAgY29uc3QgbXNnID0gY29uY2F0KGRvbWFpbl9zZXAoJ2ljLXN0YXRlLXJvb3QnKSwgcm9vdEhhc2gpO1xuICAgICAgICBsZXQgc2lnVmVyID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IGxvb2t1cFRpbWUgPSBsb29rdXBSZXN1bHRUb0J1ZmZlcih0aGlzLmxvb2t1cChbJ3RpbWUnXSkpO1xuICAgICAgICBpZiAoIWxvb2t1cFRpbWUpIHtcbiAgICAgICAgICAgIC8vIFNob3VsZCBuZXZlciBoYXBwZW4gLSB0aW1lIGlzIGFsd2F5cyBwcmVzZW50IGluIElDIGNlcnRpZmljYXRlc1xuICAgICAgICAgICAgdGhyb3cgbmV3IENlcnRpZmljYXRlVmVyaWZpY2F0aW9uRXJyb3IoJ0NlcnRpZmljYXRlIGRvZXMgbm90IGNvbnRhaW4gYSB0aW1lJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgRklWRV9NSU5VVEVTX0lOX01TRUMgPSA1ICogNjAgKiAxMDAwO1xuICAgICAgICBjb25zdCBNQVhfQUdFX0lOX01TRUMgPSB0aGlzLl9tYXhBZ2VJbk1pbnV0ZXMgKiA2MCAqIDEwMDA7XG4gICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgIGNvbnN0IGVhcmxpZXN0Q2VydGlmaWNhdGVUaW1lID0gbm93IC0gTUFYX0FHRV9JTl9NU0VDO1xuICAgICAgICBjb25zdCBmaXZlTWludXRlc0Zyb21Ob3cgPSBub3cgKyBGSVZFX01JTlVURVNfSU5fTVNFQztcbiAgICAgICAgY29uc3QgY2VydFRpbWUgPSBkZWNvZGVUaW1lKGxvb2t1cFRpbWUpO1xuICAgICAgICBpZiAoY2VydFRpbWUuZ2V0VGltZSgpIDwgZWFybGllc3RDZXJ0aWZpY2F0ZVRpbWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBDZXJ0aWZpY2F0ZVZlcmlmaWNhdGlvbkVycm9yKGBDZXJ0aWZpY2F0ZSBpcyBzaWduZWQgbW9yZSB0aGFuICR7dGhpcy5fbWF4QWdlSW5NaW51dGVzfSBtaW51dGVzIGluIHRoZSBwYXN0LiBDZXJ0aWZpY2F0ZSB0aW1lOiBgICtcbiAgICAgICAgICAgICAgICBjZXJ0VGltZS50b0lTT1N0cmluZygpICtcbiAgICAgICAgICAgICAgICAnIEN1cnJlbnQgdGltZTogJyArXG4gICAgICAgICAgICAgICAgbmV3IERhdGUobm93KS50b0lTT1N0cmluZygpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjZXJ0VGltZS5nZXRUaW1lKCkgPiBmaXZlTWludXRlc0Zyb21Ob3cpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBDZXJ0aWZpY2F0ZVZlcmlmaWNhdGlvbkVycm9yKCdDZXJ0aWZpY2F0ZSBpcyBzaWduZWQgbW9yZSB0aGFuIDUgbWludXRlcyBpbiB0aGUgZnV0dXJlLiBDZXJ0aWZpY2F0ZSB0aW1lOiAnICtcbiAgICAgICAgICAgICAgICBjZXJ0VGltZS50b0lTT1N0cmluZygpICtcbiAgICAgICAgICAgICAgICAnIEN1cnJlbnQgdGltZTogJyArXG4gICAgICAgICAgICAgICAgbmV3IERhdGUobm93KS50b0lTT1N0cmluZygpKTtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc2lnVmVyID0gYXdhaXQgdGhpcy5fYmxzVmVyaWZ5KG5ldyBVaW50OEFycmF5KGtleSksIG5ldyBVaW50OEFycmF5KHNpZyksIG5ldyBVaW50OEFycmF5KG1zZykpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHNpZ1ZlciA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc2lnVmVyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQ2VydGlmaWNhdGVWZXJpZmljYXRpb25FcnJvcignU2lnbmF0dXJlIHZlcmlmaWNhdGlvbiBmYWlsZWQnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBfY2hlY2tEZWxlZ2F0aW9uQW5kR2V0S2V5KGQpIHtcbiAgICAgICAgaWYgKCFkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcm9vdEtleTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjZXJ0ID0gYXdhaXQgQ2VydGlmaWNhdGUuY3JlYXRlVW52ZXJpZmllZCh7XG4gICAgICAgICAgICBjZXJ0aWZpY2F0ZTogZC5jZXJ0aWZpY2F0ZSxcbiAgICAgICAgICAgIHJvb3RLZXk6IHRoaXMuX3Jvb3RLZXksXG4gICAgICAgICAgICBjYW5pc3RlcklkOiB0aGlzLl9jYW5pc3RlcklkLFxuICAgICAgICAgICAgYmxzVmVyaWZ5OiB0aGlzLl9ibHNWZXJpZnksXG4gICAgICAgICAgICAvLyBEbyBub3QgY2hlY2sgbWF4IGFnZSBmb3IgZGVsZWdhdGlvbiBjZXJ0aWZpY2F0ZXNcbiAgICAgICAgICAgIG1heEFnZUluTWludXRlczogSW5maW5pdHksXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoY2VydC5jZXJ0LmRlbGVnYXRpb24pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBDZXJ0aWZpY2F0ZVZlcmlmaWNhdGlvbkVycm9yKCdEZWxlZ2F0aW9uIGNlcnRpZmljYXRlcyBjYW5ub3QgYmUgbmVzdGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgY2VydC52ZXJpZnkoKTtcbiAgICAgICAgY29uc3QgY2FuaXN0ZXJJblJhbmdlID0gY2hlY2tfY2FuaXN0ZXJfcmFuZ2VzKHtcbiAgICAgICAgICAgIGNhbmlzdGVySWQ6IHRoaXMuX2NhbmlzdGVySWQsXG4gICAgICAgICAgICBzdWJuZXRJZDogUHJpbmNpcGFsLmZyb21VaW50OEFycmF5KG5ldyBVaW50OEFycmF5KGQuc3VibmV0X2lkKSksXG4gICAgICAgICAgICB0cmVlOiBjZXJ0LmNlcnQudHJlZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghY2FuaXN0ZXJJblJhbmdlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQ2VydGlmaWNhdGVWZXJpZmljYXRpb25FcnJvcihgQ2FuaXN0ZXIgJHt0aGlzLl9jYW5pc3RlcklkfSBub3QgaW4gcmFuZ2Ugb2YgZGVsZWdhdGlvbnMgZm9yIHN1Ym5ldCAweCR7dG9IZXgoZC5zdWJuZXRfaWQpfWApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHB1YmxpY0tleUxvb2t1cCA9IGxvb2t1cFJlc3VsdFRvQnVmZmVyKGNlcnQubG9va3VwKFsnc3VibmV0JywgZC5zdWJuZXRfaWQsICdwdWJsaWNfa2V5J10pKTtcbiAgICAgICAgaWYgKCFwdWJsaWNLZXlMb29rdXApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgc3VibmV0IGtleSBmb3Igc3VibmV0IDB4JHt0b0hleChkLnN1Ym5ldF9pZCl9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHB1YmxpY0tleUxvb2t1cDtcbiAgICB9XG59XG5jb25zdCBERVJfUFJFRklYID0gZnJvbUhleCgnMzA4MTgyMzAxZDA2MGQyYjA2MDEwNDAxODJkYzdjMDUwMzAxMDIwMTA2MGMyYjA2MDEwNDAxODJkYzdjMDUwMzAyMDEwMzYxMDAnKTtcbmNvbnN0IEtFWV9MRU5HVEggPSA5NjtcbmZ1bmN0aW9uIGV4dHJhY3RERVIoYnVmKSB7XG4gICAgY29uc3QgZXhwZWN0ZWRMZW5ndGggPSBERVJfUFJFRklYLmJ5dGVMZW5ndGggKyBLRVlfTEVOR1RIO1xuICAgIGlmIChidWYuYnl0ZUxlbmd0aCAhPT0gZXhwZWN0ZWRMZW5ndGgpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgQkxTIERFUi1lbmNvZGVkIHB1YmxpYyBrZXkgbXVzdCBiZSAke2V4cGVjdGVkTGVuZ3RofSBieXRlcyBsb25nYCk7XG4gICAgfVxuICAgIGNvbnN0IHByZWZpeCA9IGJ1Zi5zbGljZSgwLCBERVJfUFJFRklYLmJ5dGVMZW5ndGgpO1xuICAgIGlmICghYnVmRXF1YWxzKHByZWZpeCwgREVSX1BSRUZJWCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgQkxTIERFUi1lbmNvZGVkIHB1YmxpYyBrZXkgaXMgaW52YWxpZC4gRXhwZWN0IHRoZSBmb2xsb3dpbmcgcHJlZml4OiAke0RFUl9QUkVGSVh9LCBidXQgZ2V0ICR7cHJlZml4fWApO1xuICAgIH1cbiAgICByZXR1cm4gYnVmLnNsaWNlKERFUl9QUkVGSVguYnl0ZUxlbmd0aCk7XG59XG4vKipcbiAqIHV0aWxpdHkgZnVuY3Rpb24gdG8gY29uc3RyYWluIHRoZSB0eXBlIG9mIGEgcGF0aFxuICogQHBhcmFtIHtBcnJheUJ1ZmZlciB8IEhhc2hUcmVlIHwgdW5kZWZpbmVkfSByZXN1bHQgLSB0aGUgcmVzdWx0IG9mIGEgbG9va3VwXG4gKiBAcmV0dXJucyBBcnJheUJ1ZmZlciBvciBVbmRlZmluZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvb2t1cFJlc3VsdFRvQnVmZmVyKHJlc3VsdCkge1xuICAgIGlmIChyZXN1bHQuc3RhdHVzICE9PSBMb29rdXBTdGF0dXMuRm91bmQpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgaWYgKHJlc3VsdC52YWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQudmFsdWU7XG4gICAgfVxuICAgIGlmIChyZXN1bHQudmFsdWUgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgICAgIHJldHVybiByZXN1bHQudmFsdWUuYnVmZmVyO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufVxuLyoqXG4gKiBAcGFyYW0gdFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVjb25zdHJ1Y3QodCkge1xuICAgIHN3aXRjaCAodFswXSkge1xuICAgICAgICBjYXNlIE5vZGVUeXBlLkVtcHR5OlxuICAgICAgICAgICAgcmV0dXJuIGhhc2goZG9tYWluX3NlcCgnaWMtaGFzaHRyZWUtZW1wdHknKSk7XG4gICAgICAgIGNhc2UgTm9kZVR5cGUuUHJ1bmVkOlxuICAgICAgICAgICAgcmV0dXJuIHRbMV07XG4gICAgICAgIGNhc2UgTm9kZVR5cGUuTGVhZjpcbiAgICAgICAgICAgIHJldHVybiBoYXNoKGNvbmNhdChkb21haW5fc2VwKCdpYy1oYXNodHJlZS1sZWFmJyksIHRbMV0pKTtcbiAgICAgICAgY2FzZSBOb2RlVHlwZS5MYWJlbGVkOlxuICAgICAgICAgICAgcmV0dXJuIGhhc2goY29uY2F0KGRvbWFpbl9zZXAoJ2ljLWhhc2h0cmVlLWxhYmVsZWQnKSwgdFsxXSwgYXdhaXQgcmVjb25zdHJ1Y3QodFsyXSkpKTtcbiAgICAgICAgY2FzZSBOb2RlVHlwZS5Gb3JrOlxuICAgICAgICAgICAgcmV0dXJuIGhhc2goY29uY2F0KGRvbWFpbl9zZXAoJ2ljLWhhc2h0cmVlLWZvcmsnKSwgYXdhaXQgcmVjb25zdHJ1Y3QodFsxXSksIGF3YWl0IHJlY29uc3RydWN0KHRbMl0pKSk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3VucmVhY2hhYmxlJyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZG9tYWluX3NlcChzKSB7XG4gICAgY29uc3QgbGVuID0gbmV3IFVpbnQ4QXJyYXkoW3MubGVuZ3RoXSk7XG4gICAgY29uc3Qgc3RyID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHMpO1xuICAgIHJldHVybiBjb25jYXQobGVuLCBzdHIpO1xufVxuZXhwb3J0IHZhciBMb29rdXBTdGF0dXM7XG4oZnVuY3Rpb24gKExvb2t1cFN0YXR1cykge1xuICAgIExvb2t1cFN0YXR1c1tcIlVua25vd25cIl0gPSBcInVua25vd25cIjtcbiAgICBMb29rdXBTdGF0dXNbXCJBYnNlbnRcIl0gPSBcImFic2VudFwiO1xuICAgIExvb2t1cFN0YXR1c1tcIkZvdW5kXCJdID0gXCJmb3VuZFwiO1xufSkoTG9va3VwU3RhdHVzIHx8IChMb29rdXBTdGF0dXMgPSB7fSkpO1xudmFyIExhYmVsTG9va3VwU3RhdHVzO1xuKGZ1bmN0aW9uIChMYWJlbExvb2t1cFN0YXR1cykge1xuICAgIExhYmVsTG9va3VwU3RhdHVzW1wiTGVzc1wiXSA9IFwibGVzc1wiO1xuICAgIExhYmVsTG9va3VwU3RhdHVzW1wiR3JlYXRlclwiXSA9IFwiZ3JlYXRlclwiO1xufSkoTGFiZWxMb29rdXBTdGF0dXMgfHwgKExhYmVsTG9va3VwU3RhdHVzID0ge30pKTtcbmV4cG9ydCBmdW5jdGlvbiBsb29rdXBfcGF0aChwYXRoLCB0cmVlKSB7XG4gICAgaWYgKHBhdGgubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHN3aXRjaCAodHJlZVswXSkge1xuICAgICAgICAgICAgY2FzZSBOb2RlVHlwZS5MZWFmOiB7XG4gICAgICAgICAgICAgICAgaWYgKCF0cmVlWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB0cmVlIHN0cnVjdHVyZSBmb3IgbGVhZicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHJlZVsxXSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IExvb2t1cFN0YXR1cy5Gb3VuZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0cmVlWzFdLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHJlZVsxXSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogTG9va3VwU3RhdHVzLkZvdW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRyZWVbMV0uYnVmZmVyLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IExvb2t1cFN0YXR1cy5Gb3VuZCxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRyZWVbMV0sXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IExvb2t1cFN0YXR1cy5Gb3VuZCxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRyZWUsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBsYWJlbCA9IHR5cGVvZiBwYXRoWzBdID09PSAnc3RyaW5nJyA/IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShwYXRoWzBdKSA6IHBhdGhbMF07XG4gICAgY29uc3QgbG9va3VwUmVzdWx0ID0gZmluZF9sYWJlbChsYWJlbCwgdHJlZSk7XG4gICAgc3dpdGNoIChsb29rdXBSZXN1bHQuc3RhdHVzKSB7XG4gICAgICAgIGNhc2UgTG9va3VwU3RhdHVzLkZvdW5kOiB7XG4gICAgICAgICAgICByZXR1cm4gbG9va3VwX3BhdGgocGF0aC5zbGljZSgxKSwgbG9va3VwUmVzdWx0LnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIExhYmVsTG9va3VwU3RhdHVzLkdyZWF0ZXI6XG4gICAgICAgIGNhc2UgTGFiZWxMb29rdXBTdGF0dXMuTGVzczoge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IExvb2t1cFN0YXR1cy5BYnNlbnQsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgIHJldHVybiBsb29rdXBSZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIElmIHRoZSB0cmVlIGlzIGEgZm9yaywgZmxhdHRlbiBpdCBpbnRvIGFuIGFycmF5IG9mIHRyZWVzXG4gKiBAcGFyYW0gdCAtIHRoZSB0cmVlIHRvIGZsYXR0ZW5cbiAqIEByZXR1cm5zIEhhc2hUcmVlW10gLSB0aGUgZmxhdHRlbmVkIHRyZWVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZsYXR0ZW5fZm9ya3ModCkge1xuICAgIHN3aXRjaCAodFswXSkge1xuICAgICAgICBjYXNlIE5vZGVUeXBlLkVtcHR5OlxuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICBjYXNlIE5vZGVUeXBlLkZvcms6XG4gICAgICAgICAgICByZXR1cm4gZmxhdHRlbl9mb3Jrcyh0WzFdKS5jb25jYXQoZmxhdHRlbl9mb3Jrcyh0WzJdKSk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gW3RdO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBmaW5kX2xhYmVsKGxhYmVsLCB0cmVlKSB7XG4gICAgc3dpdGNoICh0cmVlWzBdKSB7XG4gICAgICAgIC8vIGlmIHdlIGhhdmUgYSBsYWJlbGxlZCBub2RlLCBjb21wYXJlIHRoZSBub2RlJ3MgbGFiZWwgdG8gdGhlIG9uZSB3ZSBhcmVcbiAgICAgICAgLy8gbG9va2luZyBmb3JcbiAgICAgICAgY2FzZSBOb2RlVHlwZS5MYWJlbGVkOlxuICAgICAgICAgICAgLy8gaWYgdGhlIGxhYmVsIHdlJ3JlIHNlYXJjaGluZyBmb3IgaXMgZ3JlYXRlciB0aGFuIHRoaXMgbm9kZSdzIGxhYmVsLFxuICAgICAgICAgICAgLy8gd2UgbmVlZCB0byBrZWVwIHNlYXJjaGluZ1xuICAgICAgICAgICAgaWYgKGlzQnVmZmVyR3JlYXRlclRoYW4obGFiZWwsIHRyZWVbMV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBMYWJlbExvb2t1cFN0YXR1cy5HcmVhdGVyLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiB0aGUgbGFiZWwgd2UncmUgc2VhcmNoaW5nIGZvciBpcyBlcXVhbCB0aGlzIG5vZGUncyBsYWJlbCwgd2UgY2FuXG4gICAgICAgICAgICAvLyBzdG9wIHNlYXJjaGluZyBhbmQgcmV0dXJuIHRoZSBmb3VuZCBub2RlXG4gICAgICAgICAgICBpZiAoYnVmRXF1YWxzKGxhYmVsLCB0cmVlWzFdKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogTG9va3VwU3RhdHVzLkZvdW5kLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdHJlZVsyXSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gaWYgdGhlIGxhYmVsIHdlJ3JlIHNlYXJjaGluZyBmb3IgaXMgbm90IGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byB0aGlzXG4gICAgICAgICAgICAvLyBub2RlJ3MgbGFiZWwsIHRoZW4gaXQncyBsZXNzIHRoYW4gdGhpcyBub2RlJ3MgbGFiZWwsIGFuZCB3ZSBjYW4gc3RvcFxuICAgICAgICAgICAgLy8gc2VhcmNoaW5nIGJlY2F1c2Ugd2UndmUgbG9va2VkIHRvbyBmYXJcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBMYWJlbExvb2t1cFN0YXR1cy5MZXNzLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgLy8gaWYgd2UgaGF2ZSBhIGZvcmsgbm9kZSwgd2UgbmVlZCB0byBzZWFyY2ggYm90aCBzaWRlcywgc3RhcnRpbmcgd2l0aCB0aGUgbGVmdFxuICAgICAgICBjYXNlIE5vZGVUeXBlLkZvcms6XG4gICAgICAgICAgICAvLyBzZWFyY2ggaW4gdGhlIGxlZnQgbm9kZVxuICAgICAgICAgICAgY29uc3QgbGVmdExvb2t1cFJlc3VsdCA9IGZpbmRfbGFiZWwobGFiZWwsIHRyZWVbMV0pO1xuICAgICAgICAgICAgc3dpdGNoIChsZWZ0TG9va3VwUmVzdWx0LnN0YXR1cykge1xuICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBsYWJlbCB3ZSdyZSBzZWFyY2hpbmcgZm9yIGlzIGdyZWF0ZXIgdGhhbiB0aGUgbGVmdCBub2RlIGxvb2t1cCxcbiAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIHNlYXJjaCB0aGUgcmlnaHQgbm9kZVxuICAgICAgICAgICAgICAgIGNhc2UgTGFiZWxMb29rdXBTdGF0dXMuR3JlYXRlcjoge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByaWdodExvb2t1cFJlc3VsdCA9IGZpbmRfbGFiZWwobGFiZWwsIHRyZWVbMl0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgbGFiZWwgd2UncmUgc2VhcmNoaW5nIGZvciBpcyBsZXNzIHRoYW4gdGhlIHJpZ2h0IG5vZGUgbG9va3VwLFxuICAgICAgICAgICAgICAgICAgICAvLyB0aGVuIHdlIGNhbiBzdG9wIHNlYXJjaGluZyBhbmQgc2F5IHRoYXQgdGhlIGxhYmVsIGlzIHByb3ZhYmx5IEFic2VudFxuICAgICAgICAgICAgICAgICAgICBpZiAocmlnaHRMb29rdXBSZXN1bHQuc3RhdHVzID09PSBMYWJlbExvb2t1cFN0YXR1cy5MZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogTG9va3VwU3RhdHVzLkFic2VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIGxhYmVsIHdlJ3JlIHNlYXJjaGluZyBmb3IgaXMgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSByaWdodFxuICAgICAgICAgICAgICAgICAgICAvLyBub2RlIGxvb2t1cCwgdGhlbiB3ZSBsZXQgdGhlIGNhbGxlciBoYW5kbGUgaXRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJpZ2h0TG9va3VwUmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgbGVmdCBub2RlIHJldHVybnMgYW4gdW5jZXJ0YWluIHJlc3VsdCwgd2UgbmVlZCB0byBzZWFyY2ggdGhlXG4gICAgICAgICAgICAgICAgLy8gcmlnaHQgbm9kZVxuICAgICAgICAgICAgICAgIGNhc2UgTG9va3VwU3RhdHVzLlVua25vd246IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJpZ2h0TG9va3VwUmVzdWx0ID0gZmluZF9sYWJlbChsYWJlbCwgdHJlZVsyXSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBsYWJlbCB3ZSdyZSBzZWFyY2hpbmcgZm9yIGlzIGxlc3MgdGhhbiB0aGUgcmlnaHQgbm9kZSBsb29rdXAsXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZW4gd2UgYWxzbyBuZWVkIHRvIHJldHVybiBhbiB1bmNlcnRhaW4gcmVzdWx0XG4gICAgICAgICAgICAgICAgICAgIGlmIChyaWdodExvb2t1cFJlc3VsdC5zdGF0dXMgPT09IExhYmVsTG9va3VwU3RhdHVzLkxlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBMb29rdXBTdGF0dXMuVW5rbm93bixcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIGxhYmVsIHdlJ3JlIHNlYXJjaGluZyBmb3IgaXMgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSByaWdodFxuICAgICAgICAgICAgICAgICAgICAvLyBub2RlIGxvb2t1cCwgdGhlbiB3ZSBsZXQgdGhlIGNhbGxlciBoYW5kbGUgaXRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJpZ2h0TG9va3VwUmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgbGFiZWwgd2UncmUgc2VhcmNoaW5nIGZvciBpcyBub3QgZ3JlYXRlciB0aGFuIHRoZSBsZWZ0IG5vZGVcbiAgICAgICAgICAgICAgICAvLyBsb29rdXAsIG9yIHRoZSByZXN1bHQgaXMgbm90IHVuY2VydGFpbiwgd2Ugc3RvcCBzZWFyY2hpbmcgYW5kIHJldHVyblxuICAgICAgICAgICAgICAgIC8vIHdoYXRldmVyIHRoZSByZXN1bHQgb2YgdGhlIGxlZnQgbm9kZSBsb29rdXAgd2FzLCB3aGljaCBjYW4gYmUgZWl0aGVyXG4gICAgICAgICAgICAgICAgLy8gRm91bmQgb3IgQWJzZW50XG4gICAgICAgICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGVmdExvb2t1cFJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIC8vIGlmIHdlIGVuY291bnRlciBhIFBydW5lZCBub2RlLCB3ZSBjYW4ndCBrbm93IGZvciBjZXJ0YWluIGlmIHRoZSBsYWJlbFxuICAgICAgICAvLyB3ZSdyZSBzZWFyY2hpbmcgZm9yIGlzIHByZXNlbnQgb3Igbm90XG4gICAgICAgIGNhc2UgTm9kZVR5cGUuUHJ1bmVkOlxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IExvb2t1cFN0YXR1cy5Vbmtub3duLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgLy8gaWYgdGhlIGN1cnJlbnQgbm9kZSBpcyBFbXB0eSwgb3IgYSBMZWFmLCB3ZSBjYW4gc3RvcCBzZWFyY2hpbmcgYmVjYXVzZVxuICAgICAgICAvLyB3ZSBrbm93IGZvciBzdXJlIHRoYXQgdGhlIGxhYmVsIHdlJ3JlIHNlYXJjaGluZyBmb3IgaXMgbm90IHByZXNlbnRcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBMb29rdXBTdGF0dXMuQWJzZW50LFxuICAgICAgICAgICAgfTtcbiAgICB9XG59XG4vKipcbiAqIENoZWNrIGlmIGEgY2FuaXN0ZXIgZmFsbHMgd2l0aGluIGEgcmFuZ2Ugb2YgY2FuaXN0ZXJzXG4gKiBAcGFyYW0gY2FuaXN0ZXJJZCBQcmluY2lwYWxcbiAqIEBwYXJhbSByYW5nZXMgW1ByaW5jaXBhbCwgUHJpbmNpcGFsXVtdXG4gKiBAcmV0dXJuc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tfY2FuaXN0ZXJfcmFuZ2VzKHBhcmFtcykge1xuICAgIGNvbnN0IHsgY2FuaXN0ZXJJZCwgc3VibmV0SWQsIHRyZWUgfSA9IHBhcmFtcztcbiAgICBjb25zdCByYW5nZUxvb2t1cCA9IGxvb2t1cF9wYXRoKFsnc3VibmV0Jywgc3VibmV0SWQudG9VaW50OEFycmF5KCksICdjYW5pc3Rlcl9yYW5nZXMnXSwgdHJlZSk7XG4gICAgaWYgKHJhbmdlTG9va3VwLnN0YXR1cyAhPT0gTG9va3VwU3RhdHVzLkZvdW5kIHx8ICEocmFuZ2VMb29rdXAudmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmluZCBjYW5pc3RlciByYW5nZXMgZm9yIHN1Ym5ldCAke3N1Ym5ldElkfWApO1xuICAgIH1cbiAgICBjb25zdCByYW5nZXNfYXJyID0gY2Jvci5kZWNvZGUocmFuZ2VMb29rdXAudmFsdWUpO1xuICAgIGNvbnN0IHJhbmdlcyA9IHJhbmdlc19hcnIubWFwKHYgPT4gW1xuICAgICAgICBQcmluY2lwYWwuZnJvbVVpbnQ4QXJyYXkodlswXSksXG4gICAgICAgIFByaW5jaXBhbC5mcm9tVWludDhBcnJheSh2WzFdKSxcbiAgICBdKTtcbiAgICBjb25zdCBjYW5pc3RlckluUmFuZ2UgPSByYW5nZXMuc29tZShyID0+IHJbMF0ubHRFcShjYW5pc3RlcklkKSAmJiByWzFdLmd0RXEoY2FuaXN0ZXJJZCkpO1xuICAgIHJldHVybiBjYW5pc3RlckluUmFuZ2U7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jZXJ0aWZpY2F0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/@dfinity/agent/lib/esm/certificate.js\n"));

/***/ }),

/***/ "./node_modules/@dfinity/agent/lib/esm/errors.js":
/*!*******************************************************!*\
  !*** ./node_modules/@dfinity/agent/lib/esm/errors.js ***!
  \*******************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AgentError: function() { return /* binding */ AgentError; }\n/* harmony export */ });\n/**\n * An error that happens in the Agent. This is the root of all errors and should be used\n * everywhere in the Agent code (this package).\n *\n * @todo https://github.com/dfinity/agent-js/issues/420\n */\nclass AgentError extends Error {\n    constructor(message) {\n        super(message);\n        this.message = message;\n        Object.setPrototypeOf(this, AgentError.prototype);\n    }\n}\n//# sourceMappingURL=errors.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYWdlbnQvbGliL2VzbS9lcnJvcnMuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL0BkZmluaXR5L2FnZW50L2xpYi9lc20vZXJyb3JzLmpzP2EzYTYiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBbiBlcnJvciB0aGF0IGhhcHBlbnMgaW4gdGhlIEFnZW50LiBUaGlzIGlzIHRoZSByb290IG9mIGFsbCBlcnJvcnMgYW5kIHNob3VsZCBiZSB1c2VkXG4gKiBldmVyeXdoZXJlIGluIHRoZSBBZ2VudCBjb2RlICh0aGlzIHBhY2thZ2UpLlxuICpcbiAqIEB0b2RvIGh0dHBzOi8vZ2l0aHViLmNvbS9kZmluaXR5L2FnZW50LWpzL2lzc3Vlcy80MjBcbiAqL1xuZXhwb3J0IGNsYXNzIEFnZW50RXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSkge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIEFnZW50RXJyb3IucHJvdG90eXBlKTtcbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1lcnJvcnMuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@dfinity/agent/lib/esm/errors.js\n"));

/***/ }),

/***/ "./node_modules/@dfinity/agent/lib/esm/fetch_candid.js":
/*!*************************************************************!*\
  !*** ./node_modules/@dfinity/agent/lib/esm/fetch_candid.js ***!
  \*************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchCandid: function() { return /* binding */ fetchCandid; }\n/* harmony export */ });\n/* harmony import */ var _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dfinity/principal */ \"./node_modules/@dfinity/principal/lib/esm/index.js\");\n/* harmony import */ var _canisterStatus_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./canisterStatus/index */ \"./node_modules/@dfinity/agent/lib/esm/canisterStatus/index.js\");\n/* harmony import */ var _agent_http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./agent/http */ \"./node_modules/@dfinity/agent/lib/esm/agent/http/index.js\");\n/* harmony import */ var _actor__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./actor */ \"./node_modules/@dfinity/agent/lib/esm/actor.js\");\n\n\n\n\n/**\n * Retrieves the Candid interface for the specified canister.\n *\n * @param agent The agent to use for the request (usually an `HttpAgent`)\n * @param canisterId A string corresponding to the canister ID\n * @returns Candid source code\n */\nasync function fetchCandid(canisterId, agent) {\n    if (!agent) {\n        // Create an anonymous `HttpAgent` (adapted from Candid UI)\n        agent = new _agent_http__WEBPACK_IMPORTED_MODULE_2__.HttpAgent();\n        if (agent.isLocal()) {\n            agent.fetchRootKey();\n        }\n    }\n    // Attempt to use canister metadata\n    const status = await _canisterStatus_index__WEBPACK_IMPORTED_MODULE_1__.request({\n        agent,\n        canisterId: _dfinity_principal__WEBPACK_IMPORTED_MODULE_0__.Principal.fromText(canisterId),\n        paths: ['candid'],\n    });\n    const candid = status.get('candid');\n    if (candid) {\n        return candid;\n    }\n    // Use `__get_candid_interface_tmp_hack` for canisters without Candid metadata\n    const tmpHackInterface = ({ IDL }) => IDL.Service({\n        __get_candid_interface_tmp_hack: IDL.Func([], [IDL.Text], ['query']),\n    });\n    const actor = _actor__WEBPACK_IMPORTED_MODULE_3__.Actor.createActor(tmpHackInterface, { agent, canisterId });\n    return (await actor.__get_candid_interface_tmp_hack());\n}\n//# sourceMappingURL=fetch_candid.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYWdlbnQvbGliL2VzbS9mZXRjaF9jYW5kaWQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBK0M7QUFDVTtBQUNoQjtBQUNUO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0Esb0JBQW9CLGtEQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsMERBQXNCO0FBQy9DO0FBQ0Esb0JBQW9CLHlEQUFTO0FBQzdCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsS0FBSztBQUNyQztBQUNBLEtBQUs7QUFDTCxrQkFBa0IseUNBQUssaUNBQWlDLG1CQUFtQjtBQUMzRTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL0BkZmluaXR5L2FnZW50L2xpYi9lc20vZmV0Y2hfY2FuZGlkLmpzP2E3ZTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpbmNpcGFsIH0gZnJvbSAnQGRmaW5pdHkvcHJpbmNpcGFsJztcbmltcG9ydCAqIGFzIENhbmlzdGVyU3RhdHVzIGZyb20gJy4vY2FuaXN0ZXJTdGF0dXMvaW5kZXgnO1xuaW1wb3J0IHsgSHR0cEFnZW50IH0gZnJvbSAnLi9hZ2VudC9odHRwJztcbmltcG9ydCB7IEFjdG9yIH0gZnJvbSAnLi9hY3Rvcic7XG4vKipcbiAqIFJldHJpZXZlcyB0aGUgQ2FuZGlkIGludGVyZmFjZSBmb3IgdGhlIHNwZWNpZmllZCBjYW5pc3Rlci5cbiAqXG4gKiBAcGFyYW0gYWdlbnQgVGhlIGFnZW50IHRvIHVzZSBmb3IgdGhlIHJlcXVlc3QgKHVzdWFsbHkgYW4gYEh0dHBBZ2VudGApXG4gKiBAcGFyYW0gY2FuaXN0ZXJJZCBBIHN0cmluZyBjb3JyZXNwb25kaW5nIHRvIHRoZSBjYW5pc3RlciBJRFxuICogQHJldHVybnMgQ2FuZGlkIHNvdXJjZSBjb2RlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaENhbmRpZChjYW5pc3RlcklkLCBhZ2VudCkge1xuICAgIGlmICghYWdlbnQpIHtcbiAgICAgICAgLy8gQ3JlYXRlIGFuIGFub255bW91cyBgSHR0cEFnZW50YCAoYWRhcHRlZCBmcm9tIENhbmRpZCBVSSlcbiAgICAgICAgYWdlbnQgPSBuZXcgSHR0cEFnZW50KCk7XG4gICAgICAgIGlmIChhZ2VudC5pc0xvY2FsKCkpIHtcbiAgICAgICAgICAgIGFnZW50LmZldGNoUm9vdEtleSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vIEF0dGVtcHQgdG8gdXNlIGNhbmlzdGVyIG1ldGFkYXRhXG4gICAgY29uc3Qgc3RhdHVzID0gYXdhaXQgQ2FuaXN0ZXJTdGF0dXMucmVxdWVzdCh7XG4gICAgICAgIGFnZW50LFxuICAgICAgICBjYW5pc3RlcklkOiBQcmluY2lwYWwuZnJvbVRleHQoY2FuaXN0ZXJJZCksXG4gICAgICAgIHBhdGhzOiBbJ2NhbmRpZCddLFxuICAgIH0pO1xuICAgIGNvbnN0IGNhbmRpZCA9IHN0YXR1cy5nZXQoJ2NhbmRpZCcpO1xuICAgIGlmIChjYW5kaWQpIHtcbiAgICAgICAgcmV0dXJuIGNhbmRpZDtcbiAgICB9XG4gICAgLy8gVXNlIGBfX2dldF9jYW5kaWRfaW50ZXJmYWNlX3RtcF9oYWNrYCBmb3IgY2FuaXN0ZXJzIHdpdGhvdXQgQ2FuZGlkIG1ldGFkYXRhXG4gICAgY29uc3QgdG1wSGFja0ludGVyZmFjZSA9ICh7IElETCB9KSA9PiBJREwuU2VydmljZSh7XG4gICAgICAgIF9fZ2V0X2NhbmRpZF9pbnRlcmZhY2VfdG1wX2hhY2s6IElETC5GdW5jKFtdLCBbSURMLlRleHRdLCBbJ3F1ZXJ5J10pLFxuICAgIH0pO1xuICAgIGNvbnN0IGFjdG9yID0gQWN0b3IuY3JlYXRlQWN0b3IodG1wSGFja0ludGVyZmFjZSwgeyBhZ2VudCwgY2FuaXN0ZXJJZCB9KTtcbiAgICByZXR1cm4gKGF3YWl0IGFjdG9yLl9fZ2V0X2NhbmRpZF9pbnRlcmZhY2VfdG1wX2hhY2soKSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mZXRjaF9jYW5kaWQuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@dfinity/agent/lib/esm/fetch_candid.js\n"));

/***/ }),

/***/ "./node_modules/@dfinity/agent/lib/esm/index.js":
/*!******************************************************!*\
  !*** ./node_modules/@dfinity/agent/lib/esm/index.js ***!
  \******************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CanisterStatus: function() { return /* reexport module object */ _canisterStatus__WEBPACK_IMPORTED_MODULE_15__; },\n/* harmony export */   Cbor: function() { return /* reexport module object */ _cbor__WEBPACK_IMPORTED_MODULE_16__; },\n/* harmony export */   polling: function() { return /* reexport module object */ _polling__WEBPACK_IMPORTED_MODULE_14__; }\n/* harmony export */ });\n/* harmony import */ var _actor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./actor */ \"./node_modules/@dfinity/agent/lib/esm/actor.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _actor__WEBPACK_IMPORTED_MODULE_0__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _actor__WEBPACK_IMPORTED_MODULE_0__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _agent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./agent */ \"./node_modules/@dfinity/agent/lib/esm/agent/index.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _agent__WEBPACK_IMPORTED_MODULE_1__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _agent__WEBPACK_IMPORTED_MODULE_1__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _agent_http_transforms__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./agent/http/transforms */ \"./node_modules/@dfinity/agent/lib/esm/agent/http/transforms.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _agent_http_transforms__WEBPACK_IMPORTED_MODULE_2__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _agent_http_transforms__WEBPACK_IMPORTED_MODULE_2__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _agent_http_types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./agent/http/types */ \"./node_modules/@dfinity/agent/lib/esm/agent/http/types.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _agent_http_types__WEBPACK_IMPORTED_MODULE_3__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _agent_http_types__WEBPACK_IMPORTED_MODULE_3__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./auth */ \"./node_modules/@dfinity/agent/lib/esm/auth.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _auth__WEBPACK_IMPORTED_MODULE_4__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _auth__WEBPACK_IMPORTED_MODULE_4__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _canisters_asset__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./canisters/asset */ \"./node_modules/@dfinity/agent/lib/esm/canisters/asset.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _canisters_asset__WEBPACK_IMPORTED_MODULE_5__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _canisters_asset__WEBPACK_IMPORTED_MODULE_5__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _certificate__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./certificate */ \"./node_modules/@dfinity/agent/lib/esm/certificate.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _certificate__WEBPACK_IMPORTED_MODULE_6__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _certificate__WEBPACK_IMPORTED_MODULE_6__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _der__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./der */ \"./node_modules/@dfinity/agent/lib/esm/der.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _der__WEBPACK_IMPORTED_MODULE_7__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _der__WEBPACK_IMPORTED_MODULE_7__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _fetch_candid__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./fetch_candid */ \"./node_modules/@dfinity/agent/lib/esm/fetch_candid.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _fetch_candid__WEBPACK_IMPORTED_MODULE_8__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _fetch_candid__WEBPACK_IMPORTED_MODULE_8__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _public_key__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./public_key */ \"./node_modules/@dfinity/agent/lib/esm/public_key.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _public_key__WEBPACK_IMPORTED_MODULE_9__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _public_key__WEBPACK_IMPORTED_MODULE_9__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _request_id__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./request_id */ \"./node_modules/@dfinity/agent/lib/esm/request_id.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _request_id__WEBPACK_IMPORTED_MODULE_10__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _request_id__WEBPACK_IMPORTED_MODULE_10__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _utils_bls__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./utils/bls */ \"./node_modules/@dfinity/agent/lib/esm/utils/bls.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _utils_bls__WEBPACK_IMPORTED_MODULE_11__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _utils_bls__WEBPACK_IMPORTED_MODULE_11__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _utils_buffer__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./utils/buffer */ \"./node_modules/@dfinity/agent/lib/esm/utils/buffer.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _utils_buffer__WEBPACK_IMPORTED_MODULE_12__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _utils_buffer__WEBPACK_IMPORTED_MODULE_12__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _utils_random__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./utils/random */ \"./node_modules/@dfinity/agent/lib/esm/utils/random.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _utils_random__WEBPACK_IMPORTED_MODULE_13__) if([\"default\",\"polling\",\"CanisterStatus\",\"Cbor\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _utils_random__WEBPACK_IMPORTED_MODULE_13__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/* harmony import */ var _polling__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./polling */ \"./node_modules/@dfinity/agent/lib/esm/polling/index.js\");\n/* harmony import */ var _canisterStatus__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./canisterStatus */ \"./node_modules/@dfinity/agent/lib/esm/canisterStatus/index.js\");\n/* harmony import */ var _cbor__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./cbor */ \"./node_modules/@dfinity/agent/lib/esm/cbor.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYWdlbnQvbGliL2VzbS9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUF3QjtBQUNBO0FBQ2dCO0FBQ0w7QUFDWjtBQUNXO0FBQ0o7QUFDUjtBQUNTO0FBQ0Y7QUFDQTtBQUNEO0FBQ0c7QUFDQTtBQUNNO0FBQ2M7QUFDcEI7QUFDL0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL0BkZmluaXR5L2FnZW50L2xpYi9lc20vaW5kZXguanM/NzQxNyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgKiBmcm9tICcuL2FjdG9yJztcbmV4cG9ydCAqIGZyb20gJy4vYWdlbnQnO1xuZXhwb3J0ICogZnJvbSAnLi9hZ2VudC9odHRwL3RyYW5zZm9ybXMnO1xuZXhwb3J0ICogZnJvbSAnLi9hZ2VudC9odHRwL3R5cGVzJztcbmV4cG9ydCAqIGZyb20gJy4vYXV0aCc7XG5leHBvcnQgKiBmcm9tICcuL2NhbmlzdGVycy9hc3NldCc7XG5leHBvcnQgKiBmcm9tICcuL2NlcnRpZmljYXRlJztcbmV4cG9ydCAqIGZyb20gJy4vZGVyJztcbmV4cG9ydCAqIGZyb20gJy4vZmV0Y2hfY2FuZGlkJztcbmV4cG9ydCAqIGZyb20gJy4vcHVibGljX2tleSc7XG5leHBvcnQgKiBmcm9tICcuL3JlcXVlc3RfaWQnO1xuZXhwb3J0ICogZnJvbSAnLi91dGlscy9ibHMnO1xuZXhwb3J0ICogZnJvbSAnLi91dGlscy9idWZmZXInO1xuZXhwb3J0ICogZnJvbSAnLi91dGlscy9yYW5kb20nO1xuZXhwb3J0ICogYXMgcG9sbGluZyBmcm9tICcuL3BvbGxpbmcnO1xuZXhwb3J0ICogYXMgQ2FuaXN0ZXJTdGF0dXMgZnJvbSAnLi9jYW5pc3RlclN0YXR1cyc7XG5leHBvcnQgKiBhcyBDYm9yIGZyb20gJy4vY2Jvcic7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/@dfinity/agent/lib/esm/index.js\n"));

/***/ }),

/***/ "./node_modules/@dfinity/agent/lib/esm/polling/index.js":
/*!**************************************************************!*\
  !*** ./node_modules/@dfinity/agent/lib/esm/polling/index.js ***!
  \**************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   defaultStrategy: function() { return /* reexport safe */ _strategy__WEBPACK_IMPORTED_MODULE_3__.defaultStrategy; },\n/* harmony export */   pollForResponse: function() { return /* binding */ pollForResponse; },\n/* harmony export */   strategy: function() { return /* reexport module object */ _strategy__WEBPACK_IMPORTED_MODULE_3__; }\n/* harmony export */ });\n/* harmony import */ var _agent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../agent */ \"./node_modules/@dfinity/agent/lib/esm/agent/index.js\");\n/* harmony import */ var _certificate__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../certificate */ \"./node_modules/@dfinity/agent/lib/esm/certificate.js\");\n/* harmony import */ var _utils_buffer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/buffer */ \"./node_modules/@dfinity/agent/lib/esm/utils/buffer.js\");\n/* harmony import */ var _strategy__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./strategy */ \"./node_modules/@dfinity/agent/lib/esm/polling/strategy.js\");\n\n\n\n\n\n/**\n * Polls the IC to check the status of the given request then\n * returns the response bytes once the request has been processed.\n * @param agent The agent to use to poll read_state.\n * @param canisterId The effective canister ID.\n * @param requestId The Request ID to poll status for.\n * @param strategy A polling strategy.\n * @param request Request for the readState call.\n * @param blsVerify - optional replacement function that verifies the BLS signature of a certificate.\n */\nasync function pollForResponse(agent, canisterId, requestId, strategy, \n// eslint-disable-next-line\nrequest, blsVerify) {\n    var _a;\n    const path = [new TextEncoder().encode('request_status'), requestId];\n    const currentRequest = request !== null && request !== void 0 ? request : (await ((_a = agent.createReadStateRequest) === null || _a === void 0 ? void 0 : _a.call(agent, { paths: [path] })));\n    const state = await agent.readState(canisterId, { paths: [path] }, undefined, currentRequest);\n    if (agent.rootKey == null)\n        throw new Error('Agent root key not initialized before polling');\n    const cert = await _certificate__WEBPACK_IMPORTED_MODULE_1__.Certificate.create({\n        certificate: state.certificate,\n        rootKey: agent.rootKey,\n        canisterId: canisterId,\n        blsVerify,\n    });\n    const maybeBuf = (0,_certificate__WEBPACK_IMPORTED_MODULE_1__.lookupResultToBuffer)(cert.lookup([...path, new TextEncoder().encode('status')]));\n    let status;\n    if (typeof maybeBuf === 'undefined') {\n        // Missing requestId means we need to wait\n        status = _agent__WEBPACK_IMPORTED_MODULE_0__.RequestStatusResponseStatus.Unknown;\n    }\n    else {\n        status = new TextDecoder().decode(maybeBuf);\n    }\n    switch (status) {\n        case _agent__WEBPACK_IMPORTED_MODULE_0__.RequestStatusResponseStatus.Replied: {\n            return (0,_certificate__WEBPACK_IMPORTED_MODULE_1__.lookupResultToBuffer)(cert.lookup([...path, 'reply']));\n        }\n        case _agent__WEBPACK_IMPORTED_MODULE_0__.RequestStatusResponseStatus.Received:\n        case _agent__WEBPACK_IMPORTED_MODULE_0__.RequestStatusResponseStatus.Unknown:\n        case _agent__WEBPACK_IMPORTED_MODULE_0__.RequestStatusResponseStatus.Processing:\n            // Execute the polling strategy, then retry.\n            await strategy(canisterId, requestId, status);\n            return pollForResponse(agent, canisterId, requestId, strategy, currentRequest);\n        case _agent__WEBPACK_IMPORTED_MODULE_0__.RequestStatusResponseStatus.Rejected: {\n            const rejectCode = new Uint8Array((0,_certificate__WEBPACK_IMPORTED_MODULE_1__.lookupResultToBuffer)(cert.lookup([...path, 'reject_code'])))[0];\n            const rejectMessage = new TextDecoder().decode((0,_certificate__WEBPACK_IMPORTED_MODULE_1__.lookupResultToBuffer)(cert.lookup([...path, 'reject_message'])));\n            throw new Error(`Call was rejected:\\n` +\n                `  Request ID: ${(0,_utils_buffer__WEBPACK_IMPORTED_MODULE_2__.toHex)(requestId)}\\n` +\n                `  Reject code: ${rejectCode}\\n` +\n                `  Reject text: ${rejectMessage}\\n`);\n        }\n        case _agent__WEBPACK_IMPORTED_MODULE_0__.RequestStatusResponseStatus.Done:\n            // This is _technically_ not an error, but we still didn't see the `Replied` status so\n            // we don't know the result and cannot decode it.\n            throw new Error(`Call was marked as done but we never saw the reply:\\n` +\n                `  Request ID: ${(0,_utils_buffer__WEBPACK_IMPORTED_MODULE_2__.toHex)(requestId)}\\n`);\n    }\n    throw new Error('unreachable');\n}\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYWdlbnQvbGliL2VzbS9wb2xsaW5nL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBdUQ7QUFDWTtBQUMzQjtBQUNEO0FBQ007QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0xBQWdMLGVBQWU7QUFDL0wsc0RBQXNELGVBQWU7QUFDckU7QUFDQTtBQUNBLHVCQUF1QixxREFBVztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxxQkFBcUIsa0VBQW9CO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiwrREFBMkI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsK0RBQTJCO0FBQ3hDLG1CQUFtQixrRUFBb0I7QUFDdkM7QUFDQSxhQUFhLCtEQUEyQjtBQUN4QyxhQUFhLCtEQUEyQjtBQUN4QyxhQUFhLCtEQUEyQjtBQUN4QztBQUNBO0FBQ0E7QUFDQSxhQUFhLCtEQUEyQjtBQUN4Qyw4Q0FBOEMsa0VBQW9CO0FBQ2xFLDJEQUEyRCxrRUFBb0I7QUFDL0U7QUFDQSxpQ0FBaUMsb0RBQUssWUFBWTtBQUNsRCxrQ0FBa0MsV0FBVztBQUM3QyxrQ0FBa0MsY0FBYztBQUNoRDtBQUNBLGFBQWEsK0RBQTJCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxvREFBSyxZQUFZO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9AZGZpbml0eS9hZ2VudC9saWIvZXNtL3BvbGxpbmcvaW5kZXguanM/MmEyYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXF1ZXN0U3RhdHVzUmVzcG9uc2VTdGF0dXMgfSBmcm9tICcuLi9hZ2VudCc7XG5pbXBvcnQgeyBDZXJ0aWZpY2F0ZSwgbG9va3VwUmVzdWx0VG9CdWZmZXIgfSBmcm9tICcuLi9jZXJ0aWZpY2F0ZSc7XG5pbXBvcnQgeyB0b0hleCB9IGZyb20gJy4uL3V0aWxzL2J1ZmZlcic7XG5leHBvcnQgKiBhcyBzdHJhdGVneSBmcm9tICcuL3N0cmF0ZWd5JztcbmV4cG9ydCB7IGRlZmF1bHRTdHJhdGVneSB9IGZyb20gJy4vc3RyYXRlZ3knO1xuLyoqXG4gKiBQb2xscyB0aGUgSUMgdG8gY2hlY2sgdGhlIHN0YXR1cyBvZiB0aGUgZ2l2ZW4gcmVxdWVzdCB0aGVuXG4gKiByZXR1cm5zIHRoZSByZXNwb25zZSBieXRlcyBvbmNlIHRoZSByZXF1ZXN0IGhhcyBiZWVuIHByb2Nlc3NlZC5cbiAqIEBwYXJhbSBhZ2VudCBUaGUgYWdlbnQgdG8gdXNlIHRvIHBvbGwgcmVhZF9zdGF0ZS5cbiAqIEBwYXJhbSBjYW5pc3RlcklkIFRoZSBlZmZlY3RpdmUgY2FuaXN0ZXIgSUQuXG4gKiBAcGFyYW0gcmVxdWVzdElkIFRoZSBSZXF1ZXN0IElEIHRvIHBvbGwgc3RhdHVzIGZvci5cbiAqIEBwYXJhbSBzdHJhdGVneSBBIHBvbGxpbmcgc3RyYXRlZ3kuXG4gKiBAcGFyYW0gcmVxdWVzdCBSZXF1ZXN0IGZvciB0aGUgcmVhZFN0YXRlIGNhbGwuXG4gKiBAcGFyYW0gYmxzVmVyaWZ5IC0gb3B0aW9uYWwgcmVwbGFjZW1lbnQgZnVuY3Rpb24gdGhhdCB2ZXJpZmllcyB0aGUgQkxTIHNpZ25hdHVyZSBvZiBhIGNlcnRpZmljYXRlLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcG9sbEZvclJlc3BvbnNlKGFnZW50LCBjYW5pc3RlcklkLCByZXF1ZXN0SWQsIHN0cmF0ZWd5LCBcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxucmVxdWVzdCwgYmxzVmVyaWZ5KSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IHBhdGggPSBbbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKCdyZXF1ZXN0X3N0YXR1cycpLCByZXF1ZXN0SWRdO1xuICAgIGNvbnN0IGN1cnJlbnRSZXF1ZXN0ID0gcmVxdWVzdCAhPT0gbnVsbCAmJiByZXF1ZXN0ICE9PSB2b2lkIDAgPyByZXF1ZXN0IDogKGF3YWl0ICgoX2EgPSBhZ2VudC5jcmVhdGVSZWFkU3RhdGVSZXF1ZXN0KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2FsbChhZ2VudCwgeyBwYXRoczogW3BhdGhdIH0pKSk7XG4gICAgY29uc3Qgc3RhdGUgPSBhd2FpdCBhZ2VudC5yZWFkU3RhdGUoY2FuaXN0ZXJJZCwgeyBwYXRoczogW3BhdGhdIH0sIHVuZGVmaW5lZCwgY3VycmVudFJlcXVlc3QpO1xuICAgIGlmIChhZ2VudC5yb290S2V5ID09IG51bGwpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQWdlbnQgcm9vdCBrZXkgbm90IGluaXRpYWxpemVkIGJlZm9yZSBwb2xsaW5nJyk7XG4gICAgY29uc3QgY2VydCA9IGF3YWl0IENlcnRpZmljYXRlLmNyZWF0ZSh7XG4gICAgICAgIGNlcnRpZmljYXRlOiBzdGF0ZS5jZXJ0aWZpY2F0ZSxcbiAgICAgICAgcm9vdEtleTogYWdlbnQucm9vdEtleSxcbiAgICAgICAgY2FuaXN0ZXJJZDogY2FuaXN0ZXJJZCxcbiAgICAgICAgYmxzVmVyaWZ5LFxuICAgIH0pO1xuICAgIGNvbnN0IG1heWJlQnVmID0gbG9va3VwUmVzdWx0VG9CdWZmZXIoY2VydC5sb29rdXAoWy4uLnBhdGgsIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZSgnc3RhdHVzJyldKSk7XG4gICAgbGV0IHN0YXR1cztcbiAgICBpZiAodHlwZW9mIG1heWJlQnVmID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAvLyBNaXNzaW5nIHJlcXVlc3RJZCBtZWFucyB3ZSBuZWVkIHRvIHdhaXRcbiAgICAgICAgc3RhdHVzID0gUmVxdWVzdFN0YXR1c1Jlc3BvbnNlU3RhdHVzLlVua25vd247XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzdGF0dXMgPSBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUobWF5YmVCdWYpO1xuICAgIH1cbiAgICBzd2l0Y2ggKHN0YXR1cykge1xuICAgICAgICBjYXNlIFJlcXVlc3RTdGF0dXNSZXNwb25zZVN0YXR1cy5SZXBsaWVkOiB7XG4gICAgICAgICAgICByZXR1cm4gbG9va3VwUmVzdWx0VG9CdWZmZXIoY2VydC5sb29rdXAoWy4uLnBhdGgsICdyZXBseSddKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBSZXF1ZXN0U3RhdHVzUmVzcG9uc2VTdGF0dXMuUmVjZWl2ZWQ6XG4gICAgICAgIGNhc2UgUmVxdWVzdFN0YXR1c1Jlc3BvbnNlU3RhdHVzLlVua25vd246XG4gICAgICAgIGNhc2UgUmVxdWVzdFN0YXR1c1Jlc3BvbnNlU3RhdHVzLlByb2Nlc3Npbmc6XG4gICAgICAgICAgICAvLyBFeGVjdXRlIHRoZSBwb2xsaW5nIHN0cmF0ZWd5LCB0aGVuIHJldHJ5LlxuICAgICAgICAgICAgYXdhaXQgc3RyYXRlZ3koY2FuaXN0ZXJJZCwgcmVxdWVzdElkLCBzdGF0dXMpO1xuICAgICAgICAgICAgcmV0dXJuIHBvbGxGb3JSZXNwb25zZShhZ2VudCwgY2FuaXN0ZXJJZCwgcmVxdWVzdElkLCBzdHJhdGVneSwgY3VycmVudFJlcXVlc3QpO1xuICAgICAgICBjYXNlIFJlcXVlc3RTdGF0dXNSZXNwb25zZVN0YXR1cy5SZWplY3RlZDoge1xuICAgICAgICAgICAgY29uc3QgcmVqZWN0Q29kZSA9IG5ldyBVaW50OEFycmF5KGxvb2t1cFJlc3VsdFRvQnVmZmVyKGNlcnQubG9va3VwKFsuLi5wYXRoLCAncmVqZWN0X2NvZGUnXSkpKVswXTtcbiAgICAgICAgICAgIGNvbnN0IHJlamVjdE1lc3NhZ2UgPSBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUobG9va3VwUmVzdWx0VG9CdWZmZXIoY2VydC5sb29rdXAoWy4uLnBhdGgsICdyZWplY3RfbWVzc2FnZSddKSkpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYWxsIHdhcyByZWplY3RlZDpcXG5gICtcbiAgICAgICAgICAgICAgICBgICBSZXF1ZXN0IElEOiAke3RvSGV4KHJlcXVlc3RJZCl9XFxuYCArXG4gICAgICAgICAgICAgICAgYCAgUmVqZWN0IGNvZGU6ICR7cmVqZWN0Q29kZX1cXG5gICtcbiAgICAgICAgICAgICAgICBgICBSZWplY3QgdGV4dDogJHtyZWplY3RNZXNzYWdlfVxcbmApO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgUmVxdWVzdFN0YXR1c1Jlc3BvbnNlU3RhdHVzLkRvbmU6XG4gICAgICAgICAgICAvLyBUaGlzIGlzIF90ZWNobmljYWxseV8gbm90IGFuIGVycm9yLCBidXQgd2Ugc3RpbGwgZGlkbid0IHNlZSB0aGUgYFJlcGxpZWRgIHN0YXR1cyBzb1xuICAgICAgICAgICAgLy8gd2UgZG9uJ3Qga25vdyB0aGUgcmVzdWx0IGFuZCBjYW5ub3QgZGVjb2RlIGl0LlxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYWxsIHdhcyBtYXJrZWQgYXMgZG9uZSBidXQgd2UgbmV2ZXIgc2F3IHRoZSByZXBseTpcXG5gICtcbiAgICAgICAgICAgICAgICBgICBSZXF1ZXN0IElEOiAke3RvSGV4KHJlcXVlc3RJZCl9XFxuYCk7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcigndW5yZWFjaGFibGUnKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/@dfinity/agent/lib/esm/polling/index.js\n"));

/***/ }),

/***/ "./node_modules/@dfinity/auth-client/lib/esm/db.js":
/*!*********************************************************!*\
  !*** ./node_modules/@dfinity/auth-client/lib/esm/db.js ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   IdbKeyVal: function() { return /* binding */ IdbKeyVal; }\n/* harmony export */ });\n/* harmony import */ var idb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! idb */ \"./node_modules/idb/build/index.js\");\n/* harmony import */ var _storage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./storage */ \"./node_modules/@dfinity/auth-client/lib/esm/storage.js\");\n\n\nconst AUTH_DB_NAME = 'auth-client-db';\nconst OBJECT_STORE_NAME = 'ic-keyval';\nconst _openDbStore = async (dbName = AUTH_DB_NAME, storeName = OBJECT_STORE_NAME, version) => {\n    // Clear legacy stored delegations\n    if (_storage__WEBPACK_IMPORTED_MODULE_1__.isBrowser && (localStorage === null || localStorage === void 0 ? void 0 : localStorage.getItem(_storage__WEBPACK_IMPORTED_MODULE_1__.KEY_STORAGE_DELEGATION))) {\n        localStorage.removeItem(_storage__WEBPACK_IMPORTED_MODULE_1__.KEY_STORAGE_DELEGATION);\n        localStorage.removeItem(_storage__WEBPACK_IMPORTED_MODULE_1__.KEY_STORAGE_KEY);\n    }\n    return await (0,idb__WEBPACK_IMPORTED_MODULE_0__.openDB)(dbName, version, {\n        upgrade: database => {\n            database.objectStoreNames;\n            if (database.objectStoreNames.contains(storeName)) {\n                database.clear(storeName);\n            }\n            database.createObjectStore(storeName);\n        },\n    });\n};\nasync function _getValue(db, storeName, key) {\n    return await db.get(storeName, key);\n}\nasync function _setValue(db, storeName, key, value) {\n    return await db.put(storeName, value, key);\n}\nasync function _removeValue(db, storeName, key) {\n    return await db.delete(storeName, key);\n}\n/**\n * Simple Key Value store\n * Defaults to `'auth-client-db'` with an object store of `'ic-keyval'`\n */\nclass IdbKeyVal {\n    // Do not use - instead prefer create\n    constructor(_db, _storeName) {\n        this._db = _db;\n        this._storeName = _storeName;\n    }\n    /**\n     * @param {DBCreateOptions} options - DBCreateOptions\n     * @param {DBCreateOptions['dbName']} options.dbName name for the indexeddb database\n     * @default\n     * @param {DBCreateOptions['storeName']} options.storeName name for the indexeddb Data Store\n     * @default\n     * @param {DBCreateOptions['version']} options.version version of the database. Increment to safely upgrade\n     * @constructs an {@link IdbKeyVal}\n     */\n    static async create(options) {\n        const { dbName = AUTH_DB_NAME, storeName = OBJECT_STORE_NAME, version = _storage__WEBPACK_IMPORTED_MODULE_1__.DB_VERSION } = options !== null && options !== void 0 ? options : {};\n        const db = await _openDbStore(dbName, storeName, version);\n        return new IdbKeyVal(db, storeName);\n    }\n    /**\n     * Basic setter\n     * @param {IDBValidKey} key string | number | Date | BufferSource | IDBValidKey[]\n     * @param value value to set\n     * @returns void\n     */\n    async set(key, value) {\n        return await _setValue(this._db, this._storeName, key, value);\n    }\n    /**\n     * Basic getter\n     * Pass in a type T for type safety if you know the type the value will have if it is found\n     * @param {IDBValidKey} key string | number | Date | BufferSource | IDBValidKey[]\n     * @returns `Promise<T | null>`\n     * @example\n     * await get<string>('exampleKey') -> 'exampleValue'\n     */\n    async get(key) {\n        var _a;\n        return (_a = (await _getValue(this._db, this._storeName, key))) !== null && _a !== void 0 ? _a : null;\n    }\n    /**\n     * Remove a key\n     * @param key {@link IDBValidKey}\n     * @returns void\n     */\n    async remove(key) {\n        return await _removeValue(this._db, this._storeName, key);\n    }\n}\n//# sourceMappingURL=db.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYXV0aC1jbGllbnQvbGliL2VzbS9kYi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBNkI7QUFDOEQ7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLCtDQUFTLHNGQUFzRiw0REFBc0I7QUFDN0gsZ0NBQWdDLDREQUFzQjtBQUN0RCxnQ0FBZ0MscURBQWU7QUFDL0M7QUFDQSxpQkFBaUIsMkNBQU07QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGlCQUFpQjtBQUNoQyxlQUFlLDJCQUEyQjtBQUMxQztBQUNBLGVBQWUsOEJBQThCO0FBQzdDO0FBQ0EsZUFBZSw0QkFBNEI7QUFDM0MsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQSxnQkFBZ0IsZ0VBQWdFLGdEQUFVLEdBQUc7QUFDN0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsYUFBYTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGFBQWE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL0BkZmluaXR5L2F1dGgtY2xpZW50L2xpYi9lc20vZGIuanM/NTc3YyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBvcGVuREIgfSBmcm9tICdpZGInO1xuaW1wb3J0IHsgREJfVkVSU0lPTiwgaXNCcm93c2VyLCBLRVlfU1RPUkFHRV9ERUxFR0FUSU9OLCBLRVlfU1RPUkFHRV9LRVkgfSBmcm9tICcuL3N0b3JhZ2UnO1xuY29uc3QgQVVUSF9EQl9OQU1FID0gJ2F1dGgtY2xpZW50LWRiJztcbmNvbnN0IE9CSkVDVF9TVE9SRV9OQU1FID0gJ2ljLWtleXZhbCc7XG5jb25zdCBfb3BlbkRiU3RvcmUgPSBhc3luYyAoZGJOYW1lID0gQVVUSF9EQl9OQU1FLCBzdG9yZU5hbWUgPSBPQkpFQ1RfU1RPUkVfTkFNRSwgdmVyc2lvbikgPT4ge1xuICAgIC8vIENsZWFyIGxlZ2FjeSBzdG9yZWQgZGVsZWdhdGlvbnNcbiAgICBpZiAoaXNCcm93c2VyICYmIChsb2NhbFN0b3JhZ2UgPT09IG51bGwgfHwgbG9jYWxTdG9yYWdlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShLRVlfU1RPUkFHRV9ERUxFR0FUSU9OKSkpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oS0VZX1NUT1JBR0VfREVMRUdBVElPTik7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKEtFWV9TVE9SQUdFX0tFWSk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCBvcGVuREIoZGJOYW1lLCB2ZXJzaW9uLCB7XG4gICAgICAgIHVwZ3JhZGU6IGRhdGFiYXNlID0+IHtcbiAgICAgICAgICAgIGRhdGFiYXNlLm9iamVjdFN0b3JlTmFtZXM7XG4gICAgICAgICAgICBpZiAoZGF0YWJhc2Uub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhzdG9yZU5hbWUpKSB7XG4gICAgICAgICAgICAgICAgZGF0YWJhc2UuY2xlYXIoc3RvcmVOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRhdGFiYXNlLmNyZWF0ZU9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XG4gICAgICAgIH0sXG4gICAgfSk7XG59O1xuYXN5bmMgZnVuY3Rpb24gX2dldFZhbHVlKGRiLCBzdG9yZU5hbWUsIGtleSkge1xuICAgIHJldHVybiBhd2FpdCBkYi5nZXQoc3RvcmVOYW1lLCBrZXkpO1xufVxuYXN5bmMgZnVuY3Rpb24gX3NldFZhbHVlKGRiLCBzdG9yZU5hbWUsIGtleSwgdmFsdWUpIHtcbiAgICByZXR1cm4gYXdhaXQgZGIucHV0KHN0b3JlTmFtZSwgdmFsdWUsIGtleSk7XG59XG5hc3luYyBmdW5jdGlvbiBfcmVtb3ZlVmFsdWUoZGIsIHN0b3JlTmFtZSwga2V5KSB7XG4gICAgcmV0dXJuIGF3YWl0IGRiLmRlbGV0ZShzdG9yZU5hbWUsIGtleSk7XG59XG4vKipcbiAqIFNpbXBsZSBLZXkgVmFsdWUgc3RvcmVcbiAqIERlZmF1bHRzIHRvIGAnYXV0aC1jbGllbnQtZGInYCB3aXRoIGFuIG9iamVjdCBzdG9yZSBvZiBgJ2ljLWtleXZhbCdgXG4gKi9cbmV4cG9ydCBjbGFzcyBJZGJLZXlWYWwge1xuICAgIC8vIERvIG5vdCB1c2UgLSBpbnN0ZWFkIHByZWZlciBjcmVhdGVcbiAgICBjb25zdHJ1Y3RvcihfZGIsIF9zdG9yZU5hbWUpIHtcbiAgICAgICAgdGhpcy5fZGIgPSBfZGI7XG4gICAgICAgIHRoaXMuX3N0b3JlTmFtZSA9IF9zdG9yZU5hbWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7REJDcmVhdGVPcHRpb25zfSBvcHRpb25zIC0gREJDcmVhdGVPcHRpb25zXG4gICAgICogQHBhcmFtIHtEQkNyZWF0ZU9wdGlvbnNbJ2RiTmFtZSddfSBvcHRpb25zLmRiTmFtZSBuYW1lIGZvciB0aGUgaW5kZXhlZGRiIGRhdGFiYXNlXG4gICAgICogQGRlZmF1bHRcbiAgICAgKiBAcGFyYW0ge0RCQ3JlYXRlT3B0aW9uc1snc3RvcmVOYW1lJ119IG9wdGlvbnMuc3RvcmVOYW1lIG5hbWUgZm9yIHRoZSBpbmRleGVkZGIgRGF0YSBTdG9yZVxuICAgICAqIEBkZWZhdWx0XG4gICAgICogQHBhcmFtIHtEQkNyZWF0ZU9wdGlvbnNbJ3ZlcnNpb24nXX0gb3B0aW9ucy52ZXJzaW9uIHZlcnNpb24gb2YgdGhlIGRhdGFiYXNlLiBJbmNyZW1lbnQgdG8gc2FmZWx5IHVwZ3JhZGVcbiAgICAgKiBAY29uc3RydWN0cyBhbiB7QGxpbmsgSWRiS2V5VmFsfVxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBjcmVhdGUob3B0aW9ucykge1xuICAgICAgICBjb25zdCB7IGRiTmFtZSA9IEFVVEhfREJfTkFNRSwgc3RvcmVOYW1lID0gT0JKRUNUX1NUT1JFX05BTUUsIHZlcnNpb24gPSBEQl9WRVJTSU9OIH0gPSBvcHRpb25zICE9PSBudWxsICYmIG9wdGlvbnMgIT09IHZvaWQgMCA/IG9wdGlvbnMgOiB7fTtcbiAgICAgICAgY29uc3QgZGIgPSBhd2FpdCBfb3BlbkRiU3RvcmUoZGJOYW1lLCBzdG9yZU5hbWUsIHZlcnNpb24pO1xuICAgICAgICByZXR1cm4gbmV3IElkYktleVZhbChkYiwgc3RvcmVOYW1lKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQmFzaWMgc2V0dGVyXG4gICAgICogQHBhcmFtIHtJREJWYWxpZEtleX0ga2V5IHN0cmluZyB8IG51bWJlciB8IERhdGUgfCBCdWZmZXJTb3VyY2UgfCBJREJWYWxpZEtleVtdXG4gICAgICogQHBhcmFtIHZhbHVlIHZhbHVlIHRvIHNldFxuICAgICAqIEByZXR1cm5zIHZvaWRcbiAgICAgKi9cbiAgICBhc3luYyBzZXQoa2V5LCB2YWx1ZSkge1xuICAgICAgICByZXR1cm4gYXdhaXQgX3NldFZhbHVlKHRoaXMuX2RiLCB0aGlzLl9zdG9yZU5hbWUsIGtleSwgdmFsdWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBCYXNpYyBnZXR0ZXJcbiAgICAgKiBQYXNzIGluIGEgdHlwZSBUIGZvciB0eXBlIHNhZmV0eSBpZiB5b3Uga25vdyB0aGUgdHlwZSB0aGUgdmFsdWUgd2lsbCBoYXZlIGlmIGl0IGlzIGZvdW5kXG4gICAgICogQHBhcmFtIHtJREJWYWxpZEtleX0ga2V5IHN0cmluZyB8IG51bWJlciB8IERhdGUgfCBCdWZmZXJTb3VyY2UgfCBJREJWYWxpZEtleVtdXG4gICAgICogQHJldHVybnMgYFByb21pc2U8VCB8IG51bGw+YFxuICAgICAqIEBleGFtcGxlXG4gICAgICogYXdhaXQgZ2V0PHN0cmluZz4oJ2V4YW1wbGVLZXknKSAtPiAnZXhhbXBsZVZhbHVlJ1xuICAgICAqL1xuICAgIGFzeW5jIGdldChrZXkpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gKF9hID0gKGF3YWl0IF9nZXRWYWx1ZSh0aGlzLl9kYiwgdGhpcy5fc3RvcmVOYW1lLCBrZXkpKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGEga2V5XG4gICAgICogQHBhcmFtIGtleSB7QGxpbmsgSURCVmFsaWRLZXl9XG4gICAgICogQHJldHVybnMgdm9pZFxuICAgICAqL1xuICAgIGFzeW5jIHJlbW92ZShrZXkpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IF9yZW1vdmVWYWx1ZSh0aGlzLl9kYiwgdGhpcy5fc3RvcmVOYW1lLCBrZXkpO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRiLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/@dfinity/auth-client/lib/esm/db.js\n"));

/***/ }),

/***/ "./node_modules/@dfinity/auth-client/lib/esm/idleManager.js":
/*!******************************************************************!*\
  !*** ./node_modules/@dfinity/auth-client/lib/esm/idleManager.js ***!
  \******************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   IdleManager: function() { return /* binding */ IdleManager; }\n/* harmony export */ });\nconst events = ['mousedown', 'mousemove', 'keydown', 'touchstart', 'wheel'];\n/**\n * Detects if the user has been idle for a duration of `idleTimeout` ms, and calls `onIdle` and registered callbacks.\n * By default, the IdleManager will log a user out after 10 minutes of inactivity.\n * To override these defaults, you can pass an `onIdle` callback, or configure a custom `idleTimeout` in milliseconds\n */\nclass IdleManager {\n    /**\n     * @protected\n     * @param options {@link IdleManagerOptions}\n     */\n    constructor(options = {}) {\n        var _a;\n        this.callbacks = [];\n        this.idleTimeout = 10 * 60 * 1000;\n        this.timeoutID = undefined;\n        const { onIdle, idleTimeout = 10 * 60 * 1000 } = options || {};\n        this.callbacks = onIdle ? [onIdle] : [];\n        this.idleTimeout = idleTimeout;\n        const _resetTimer = this._resetTimer.bind(this);\n        window.addEventListener('load', _resetTimer, true);\n        events.forEach(function (name) {\n            document.addEventListener(name, _resetTimer, true);\n        });\n        // eslint-disable-next-line @typescript-eslint/ban-types\n        const debounce = (func, wait) => {\n            let timeout;\n            return (...args) => {\n                // eslint-disable-next-line @typescript-eslint/no-this-alias\n                const context = this;\n                const later = function () {\n                    timeout = undefined;\n                    func.apply(context, args);\n                };\n                clearTimeout(timeout);\n                timeout = window.setTimeout(later, wait);\n            };\n        };\n        if (options === null || options === void 0 ? void 0 : options.captureScroll) {\n            // debounce scroll events\n            const scroll = debounce(_resetTimer, (_a = options === null || options === void 0 ? void 0 : options.scrollDebounce) !== null && _a !== void 0 ? _a : 100);\n            window.addEventListener('scroll', scroll, true);\n        }\n        _resetTimer();\n    }\n    /**\n     * Creates an {@link IdleManager}\n     * @param {IdleManagerOptions} options Optional configuration\n     * @see {@link IdleManagerOptions}\n     * @param options.onIdle Callback once user has been idle. Use to prompt for fresh login, and use `Actor.agentOf(your_actor).invalidateIdentity()` to protect the user\n     * @param options.idleTimeout timeout in ms\n     * @param options.captureScroll capture scroll events\n     * @param options.scrollDebounce scroll debounce time in ms\n     */\n    static create(options = {}) {\n        return new this(options);\n    }\n    /**\n     * @param {IdleCB} callback function to be called when user goes idle\n     */\n    registerCallback(callback) {\n        this.callbacks.push(callback);\n    }\n    /**\n     * Cleans up the idle manager and its listeners\n     */\n    exit() {\n        clearTimeout(this.timeoutID);\n        window.removeEventListener('load', this._resetTimer, true);\n        const _resetTimer = this._resetTimer.bind(this);\n        events.forEach(function (name) {\n            document.removeEventListener(name, _resetTimer, true);\n        });\n        this.callbacks.forEach(cb => cb());\n    }\n    /**\n     * Resets the timeouts during cleanup\n     */\n    _resetTimer() {\n        const exit = this.exit.bind(this);\n        window.clearTimeout(this.timeoutID);\n        this.timeoutID = window.setTimeout(exit, this.idleTimeout);\n    }\n}\n//# sourceMappingURL=idleManager.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYXV0aC1jbGllbnQvbGliL2VzbS9pZGxlTWFuYWdlci5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHVDQUF1QztBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkIsZUFBZSxvQkFBb0I7QUFDbkMsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYXV0aC1jbGllbnQvbGliL2VzbS9pZGxlTWFuYWdlci5qcz9iMGExIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV2ZW50cyA9IFsnbW91c2Vkb3duJywgJ21vdXNlbW92ZScsICdrZXlkb3duJywgJ3RvdWNoc3RhcnQnLCAnd2hlZWwnXTtcbi8qKlxuICogRGV0ZWN0cyBpZiB0aGUgdXNlciBoYXMgYmVlbiBpZGxlIGZvciBhIGR1cmF0aW9uIG9mIGBpZGxlVGltZW91dGAgbXMsIGFuZCBjYWxscyBgb25JZGxlYCBhbmQgcmVnaXN0ZXJlZCBjYWxsYmFja3MuXG4gKiBCeSBkZWZhdWx0LCB0aGUgSWRsZU1hbmFnZXIgd2lsbCBsb2cgYSB1c2VyIG91dCBhZnRlciAxMCBtaW51dGVzIG9mIGluYWN0aXZpdHkuXG4gKiBUbyBvdmVycmlkZSB0aGVzZSBkZWZhdWx0cywgeW91IGNhbiBwYXNzIGFuIGBvbklkbGVgIGNhbGxiYWNrLCBvciBjb25maWd1cmUgYSBjdXN0b20gYGlkbGVUaW1lb3V0YCBpbiBtaWxsaXNlY29uZHNcbiAqL1xuZXhwb3J0IGNsYXNzIElkbGVNYW5hZ2VyIHtcbiAgICAvKipcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICogQHBhcmFtIG9wdGlvbnMge0BsaW5rIElkbGVNYW5hZ2VyT3B0aW9uc31cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB0aGlzLmNhbGxiYWNrcyA9IFtdO1xuICAgICAgICB0aGlzLmlkbGVUaW1lb3V0ID0gMTAgKiA2MCAqIDEwMDA7XG4gICAgICAgIHRoaXMudGltZW91dElEID0gdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCB7IG9uSWRsZSwgaWRsZVRpbWVvdXQgPSAxMCAqIDYwICogMTAwMCB9ID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgdGhpcy5jYWxsYmFja3MgPSBvbklkbGUgPyBbb25JZGxlXSA6IFtdO1xuICAgICAgICB0aGlzLmlkbGVUaW1lb3V0ID0gaWRsZVRpbWVvdXQ7XG4gICAgICAgIGNvbnN0IF9yZXNldFRpbWVyID0gdGhpcy5fcmVzZXRUaW1lci5iaW5kKHRoaXMpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIF9yZXNldFRpbWVyLCB0cnVlKTtcbiAgICAgICAgZXZlbnRzLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgX3Jlc2V0VGltZXIsIHRydWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXNcbiAgICAgICAgY29uc3QgZGVib3VuY2UgPSAoZnVuYywgd2FpdCkgPT4ge1xuICAgICAgICAgICAgbGV0IHRpbWVvdXQ7XG4gICAgICAgICAgICByZXR1cm4gKC4uLmFyZ3MpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXNcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcztcbiAgICAgICAgICAgICAgICBjb25zdCBsYXRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGltZW91dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICAgICAgICB0aW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQobGF0ZXIsIHdhaXQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5jYXB0dXJlU2Nyb2xsKSB7XG4gICAgICAgICAgICAvLyBkZWJvdW5jZSBzY3JvbGwgZXZlbnRzXG4gICAgICAgICAgICBjb25zdCBzY3JvbGwgPSBkZWJvdW5jZShfcmVzZXRUaW1lciwgKF9hID0gb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLnNjcm9sbERlYm91bmNlKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAxMDApO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHNjcm9sbCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgX3Jlc2V0VGltZXIoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiB7QGxpbmsgSWRsZU1hbmFnZXJ9XG4gICAgICogQHBhcmFtIHtJZGxlTWFuYWdlck9wdGlvbnN9IG9wdGlvbnMgT3B0aW9uYWwgY29uZmlndXJhdGlvblxuICAgICAqIEBzZWUge0BsaW5rIElkbGVNYW5hZ2VyT3B0aW9uc31cbiAgICAgKiBAcGFyYW0gb3B0aW9ucy5vbklkbGUgQ2FsbGJhY2sgb25jZSB1c2VyIGhhcyBiZWVuIGlkbGUuIFVzZSB0byBwcm9tcHQgZm9yIGZyZXNoIGxvZ2luLCBhbmQgdXNlIGBBY3Rvci5hZ2VudE9mKHlvdXJfYWN0b3IpLmludmFsaWRhdGVJZGVudGl0eSgpYCB0byBwcm90ZWN0IHRoZSB1c2VyXG4gICAgICogQHBhcmFtIG9wdGlvbnMuaWRsZVRpbWVvdXQgdGltZW91dCBpbiBtc1xuICAgICAqIEBwYXJhbSBvcHRpb25zLmNhcHR1cmVTY3JvbGwgY2FwdHVyZSBzY3JvbGwgZXZlbnRzXG4gICAgICogQHBhcmFtIG9wdGlvbnMuc2Nyb2xsRGVib3VuY2Ugc2Nyb2xsIGRlYm91bmNlIHRpbWUgaW4gbXNcbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlKG9wdGlvbnMgPSB7fSkge1xuICAgICAgICByZXR1cm4gbmV3IHRoaXMob3B0aW9ucyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7SWRsZUNCfSBjYWxsYmFjayBmdW5jdGlvbiB0byBiZSBjYWxsZWQgd2hlbiB1c2VyIGdvZXMgaWRsZVxuICAgICAqL1xuICAgIHJlZ2lzdGVyQ2FsbGJhY2soY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5jYWxsYmFja3MucHVzaChjYWxsYmFjayk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFucyB1cCB0aGUgaWRsZSBtYW5hZ2VyIGFuZCBpdHMgbGlzdGVuZXJzXG4gICAgICovXG4gICAgZXhpdCgpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dElEKTtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2xvYWQnLCB0aGlzLl9yZXNldFRpbWVyLCB0cnVlKTtcbiAgICAgICAgY29uc3QgX3Jlc2V0VGltZXIgPSB0aGlzLl9yZXNldFRpbWVyLmJpbmQodGhpcyk7XG4gICAgICAgIGV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsIF9yZXNldFRpbWVyLCB0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY2FsbGJhY2tzLmZvckVhY2goY2IgPT4gY2IoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlc2V0cyB0aGUgdGltZW91dHMgZHVyaW5nIGNsZWFudXBcbiAgICAgKi9cbiAgICBfcmVzZXRUaW1lcigpIHtcbiAgICAgICAgY29uc3QgZXhpdCA9IHRoaXMuZXhpdC5iaW5kKHRoaXMpO1xuICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dElEKTtcbiAgICAgICAgdGhpcy50aW1lb3V0SUQgPSB3aW5kb3cuc2V0VGltZW91dChleGl0LCB0aGlzLmlkbGVUaW1lb3V0KTtcbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pZGxlTWFuYWdlci5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/@dfinity/auth-client/lib/esm/idleManager.js\n"));

/***/ }),

/***/ "./node_modules/@dfinity/auth-client/lib/esm/index.js":
/*!************************************************************!*\
  !*** ./node_modules/@dfinity/auth-client/lib/esm/index.js ***!
  \************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AuthClient: function() { return /* binding */ AuthClient; },\n/* harmony export */   ERROR_USER_INTERRUPT: function() { return /* binding */ ERROR_USER_INTERRUPT; },\n/* harmony export */   IdbKeyVal: function() { return /* reexport safe */ _db__WEBPACK_IMPORTED_MODULE_4__.IdbKeyVal; },\n/* harmony export */   IdbStorage: function() { return /* reexport safe */ _storage__WEBPACK_IMPORTED_MODULE_3__.IdbStorage; },\n/* harmony export */   KEY_STORAGE_DELEGATION: function() { return /* reexport safe */ _storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_DELEGATION; },\n/* harmony export */   KEY_STORAGE_KEY: function() { return /* reexport safe */ _storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_KEY; },\n/* harmony export */   LocalStorage: function() { return /* reexport safe */ _storage__WEBPACK_IMPORTED_MODULE_3__.LocalStorage; }\n/* harmony export */ });\n/* harmony import */ var _dfinity_agent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dfinity/agent */ \"./node_modules/@dfinity/agent/lib/esm/index.js\");\n/* harmony import */ var _dfinity_identity__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dfinity/identity */ \"./node_modules/@dfinity/identity/lib/esm/index.js\");\n/* harmony import */ var _idleManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./idleManager */ \"./node_modules/@dfinity/auth-client/lib/esm/idleManager.js\");\n/* harmony import */ var _storage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./storage */ \"./node_modules/@dfinity/auth-client/lib/esm/storage.js\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./db */ \"./node_modules/@dfinity/auth-client/lib/esm/db.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _idleManager__WEBPACK_IMPORTED_MODULE_2__) if([\"default\",\"IdbStorage\",\"LocalStorage\",\"KEY_STORAGE_DELEGATION\",\"KEY_STORAGE_KEY\",\"IdbKeyVal\",\"ERROR_USER_INTERRUPT\",\"AuthClient\"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _idleManager__WEBPACK_IMPORTED_MODULE_2__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n/** @module AuthClient */\n\n\n\n\n\n\nconst IDENTITY_PROVIDER_DEFAULT = 'https://identity.ic0.app';\nconst IDENTITY_PROVIDER_ENDPOINT = '#authorize';\nconst ECDSA_KEY_LABEL = 'ECDSA';\nconst ED25519_KEY_LABEL = 'Ed25519';\nconst INTERRUPT_CHECK_INTERVAL = 500;\nconst ERROR_USER_INTERRUPT = 'UserInterrupt';\n\n/**\n * Tool to manage authentication and identity\n * @see {@link AuthClient}\n */\nclass AuthClient {\n    constructor(_identity, _key, _chain, _storage, idleManager, _createOptions, \n    // A handle on the IdP window.\n    _idpWindow, \n    // The event handler for processing events from the IdP.\n    _eventHandler) {\n        this._identity = _identity;\n        this._key = _key;\n        this._chain = _chain;\n        this._storage = _storage;\n        this.idleManager = idleManager;\n        this._createOptions = _createOptions;\n        this._idpWindow = _idpWindow;\n        this._eventHandler = _eventHandler;\n        this._registerDefaultIdleCallback();\n    }\n    /**\n     * Create an AuthClient to manage authentication and identity\n     * @constructs\n     * @param {AuthClientCreateOptions} options - Options for creating an {@link AuthClient}\n     * @see {@link AuthClientCreateOptions}\n     * @param options.identity Optional Identity to use as the base\n     * @see {@link SignIdentity}\n     * @param options.storage Storage mechanism for delegration credentials\n     * @see {@link AuthClientStorage}\n     * @param options.keyType Type of key to use for the base key\n     * @param {IdleOptions} options.idleOptions Configures an {@link IdleManager}\n     * @see {@link IdleOptions}\n     * Default behavior is to clear stored identity and reload the page when a user goes idle, unless you set the disableDefaultIdleCallback flag or pass in a custom idle callback.\n     * @example\n     * const authClient = await AuthClient.create({\n     *   idleOptions: {\n     *     disableIdle: true\n     *   }\n     * })\n     */\n    static async create(options = {}) {\n        var _a, _b, _c;\n        const storage = (_a = options.storage) !== null && _a !== void 0 ? _a : new _storage__WEBPACK_IMPORTED_MODULE_3__.IdbStorage();\n        const keyType = (_b = options.keyType) !== null && _b !== void 0 ? _b : ECDSA_KEY_LABEL;\n        let key = null;\n        if (options.identity) {\n            key = options.identity;\n        }\n        else {\n            let maybeIdentityStorage = await storage.get(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_KEY);\n            if (!maybeIdentityStorage && _storage__WEBPACK_IMPORTED_MODULE_3__.isBrowser) {\n                // Attempt to migrate from localstorage\n                try {\n                    const fallbackLocalStorage = new _storage__WEBPACK_IMPORTED_MODULE_3__.LocalStorage();\n                    const localChain = await fallbackLocalStorage.get(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_DELEGATION);\n                    const localKey = await fallbackLocalStorage.get(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_KEY);\n                    // not relevant for Ed25519\n                    if (localChain && localKey && keyType === ECDSA_KEY_LABEL) {\n                        console.log('Discovered an identity stored in localstorage. Migrating to IndexedDB');\n                        await storage.set(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_DELEGATION, localChain);\n                        await storage.set(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_KEY, localKey);\n                        maybeIdentityStorage = localChain;\n                        // clean up\n                        await fallbackLocalStorage.remove(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_DELEGATION);\n                        await fallbackLocalStorage.remove(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_KEY);\n                    }\n                }\n                catch (error) {\n                    console.error('error while attempting to recover localstorage: ' + error);\n                }\n            }\n            if (maybeIdentityStorage) {\n                try {\n                    if (typeof maybeIdentityStorage === 'object') {\n                        if (keyType === ED25519_KEY_LABEL && typeof maybeIdentityStorage === 'string') {\n                            key = await _dfinity_identity__WEBPACK_IMPORTED_MODULE_1__.Ed25519KeyIdentity.fromJSON(maybeIdentityStorage);\n                        }\n                        else {\n                            key = await _dfinity_identity__WEBPACK_IMPORTED_MODULE_1__.ECDSAKeyIdentity.fromKeyPair(maybeIdentityStorage);\n                        }\n                    }\n                    else if (typeof maybeIdentityStorage === 'string') {\n                        // This is a legacy identity, which is a serialized Ed25519KeyIdentity.\n                        key = _dfinity_identity__WEBPACK_IMPORTED_MODULE_1__.Ed25519KeyIdentity.fromJSON(maybeIdentityStorage);\n                    }\n                }\n                catch (e) {\n                    // Ignore this, this means that the localStorage value isn't a valid Ed25519KeyIdentity or ECDSAKeyIdentity\n                    // serialization.\n                }\n            }\n        }\n        let identity = new _dfinity_agent__WEBPACK_IMPORTED_MODULE_0__.AnonymousIdentity();\n        let chain = null;\n        if (key) {\n            try {\n                const chainStorage = await storage.get(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_DELEGATION);\n                if (typeof chainStorage === 'object' && chainStorage !== null) {\n                    throw new Error('Delegation chain is incorrectly stored. A delegation chain should be stored as a string.');\n                }\n                if (options.identity) {\n                    identity = options.identity;\n                }\n                else if (chainStorage) {\n                    chain = _dfinity_identity__WEBPACK_IMPORTED_MODULE_1__.DelegationChain.fromJSON(chainStorage);\n                    // Verify that the delegation isn't expired.\n                    if (!(0,_dfinity_identity__WEBPACK_IMPORTED_MODULE_1__.isDelegationValid)(chain)) {\n                        await _deleteStorage(storage);\n                        key = null;\n                    }\n                    else {\n                        // If the key is a public key, then we create a PartialDelegationIdentity.\n                        if ('toDer' in key) {\n                            identity = _dfinity_identity__WEBPACK_IMPORTED_MODULE_1__.PartialDelegationIdentity.fromDelegation(key, chain);\n                            // otherwise, we create a DelegationIdentity.\n                        }\n                        else {\n                            identity = _dfinity_identity__WEBPACK_IMPORTED_MODULE_1__.DelegationIdentity.fromDelegation(key, chain);\n                        }\n                    }\n                }\n            }\n            catch (e) {\n                console.error(e);\n                // If there was a problem loading the chain, delete the key.\n                await _deleteStorage(storage);\n                key = null;\n            }\n        }\n        let idleManager = undefined;\n        if ((_c = options.idleOptions) === null || _c === void 0 ? void 0 : _c.disableIdle) {\n            idleManager = undefined;\n        }\n        // if there is a delegation chain or provided identity, setup idleManager\n        else if (chain || options.identity) {\n            idleManager = _idleManager__WEBPACK_IMPORTED_MODULE_2__.IdleManager.create(options.idleOptions);\n        }\n        if (!key) {\n            // Create a new key (whether or not one was in storage).\n            if (keyType === ED25519_KEY_LABEL) {\n                key = await _dfinity_identity__WEBPACK_IMPORTED_MODULE_1__.Ed25519KeyIdentity.generate();\n                await storage.set(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_KEY, JSON.stringify(key.toJSON()));\n            }\n            else {\n                if (options.storage && keyType === ECDSA_KEY_LABEL) {\n                    console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${ED25519_KEY_LABEL}' as the key type, as it can serialize to a string`);\n                }\n                key = await _dfinity_identity__WEBPACK_IMPORTED_MODULE_1__.ECDSAKeyIdentity.generate();\n                await storage.set(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_KEY, key.getKeyPair());\n            }\n        }\n        return new this(identity, key, chain, storage, idleManager, options);\n    }\n    _registerDefaultIdleCallback() {\n        var _a, _b;\n        const idleOptions = (_a = this._createOptions) === null || _a === void 0 ? void 0 : _a.idleOptions;\n        /**\n         * Default behavior is to clear stored identity and reload the page.\n         * By either setting the disableDefaultIdleCallback flag or passing in a custom idle callback, we will ignore this config\n         */\n        if (!(idleOptions === null || idleOptions === void 0 ? void 0 : idleOptions.onIdle) && !(idleOptions === null || idleOptions === void 0 ? void 0 : idleOptions.disableDefaultIdleCallback)) {\n            (_b = this.idleManager) === null || _b === void 0 ? void 0 : _b.registerCallback(() => {\n                this.logout();\n                location.reload();\n            });\n        }\n    }\n    async _handleSuccess(message, onSuccess) {\n        var _a, _b;\n        const delegations = message.delegations.map(signedDelegation => {\n            return {\n                delegation: new _dfinity_identity__WEBPACK_IMPORTED_MODULE_1__.Delegation(signedDelegation.delegation.pubkey, signedDelegation.delegation.expiration, signedDelegation.delegation.targets),\n                signature: signedDelegation.signature.buffer,\n            };\n        });\n        const delegationChain = _dfinity_identity__WEBPACK_IMPORTED_MODULE_1__.DelegationChain.fromDelegations(delegations, message.userPublicKey.buffer);\n        const key = this._key;\n        if (!key) {\n            return;\n        }\n        this._chain = delegationChain;\n        if ('toDer' in key) {\n            this._identity = _dfinity_identity__WEBPACK_IMPORTED_MODULE_1__.PartialDelegationIdentity.fromDelegation(key, this._chain);\n        }\n        else {\n            this._identity = _dfinity_identity__WEBPACK_IMPORTED_MODULE_1__.DelegationIdentity.fromDelegation(key, this._chain);\n        }\n        (_a = this._idpWindow) === null || _a === void 0 ? void 0 : _a.close();\n        const idleOptions = (_b = this._createOptions) === null || _b === void 0 ? void 0 : _b.idleOptions;\n        // create the idle manager on a successful login if we haven't disabled it\n        // and it doesn't already exist.\n        if (!this.idleManager && !(idleOptions === null || idleOptions === void 0 ? void 0 : idleOptions.disableIdle)) {\n            this.idleManager = _idleManager__WEBPACK_IMPORTED_MODULE_2__.IdleManager.create(idleOptions);\n            this._registerDefaultIdleCallback();\n        }\n        this._removeEventListener();\n        delete this._idpWindow;\n        if (this._chain) {\n            await this._storage.set(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_DELEGATION, JSON.stringify(this._chain.toJSON()));\n        }\n        // onSuccess should be the last thing to do to avoid consumers\n        // interfering by navigating or refreshing the page\n        onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess(message);\n    }\n    getIdentity() {\n        return this._identity;\n    }\n    async isAuthenticated() {\n        return !this.getIdentity().getPrincipal().isAnonymous() && this._chain !== null;\n    }\n    /**\n     * AuthClient Login -\n     * Opens up a new window to authenticate with Internet Identity\n     * @param {AuthClientLoginOptions} options - Options for logging in\n     * @param options.identityProvider Identity provider\n     * @param options.maxTimeToLive Expiration of the authentication in nanoseconds\n     * @param options.allowPinAuthentication If present, indicates whether or not the Identity Provider should allow the user to authenticate and/or register using a temporary key/PIN identity. Authenticating dapps may want to prevent users from using Temporary keys/PIN identities because Temporary keys/PIN identities are less secure than Passkeys (webauthn credentials) and because Temporary keys/PIN identities generally only live in a browser database (which may get cleared by the browser/OS).\n     * @param options.derivationOrigin Origin for Identity Provider to use while generating the delegated identity\n     * @param options.windowOpenerFeatures Configures the opened authentication window\n     * @param options.onSuccess Callback once login has completed\n     * @param options.onError Callback in case authentication fails\n     * @example\n     * const authClient = await AuthClient.create();\n     * authClient.login({\n     *  identityProvider: 'http://<canisterID>.127.0.0.1:8000',\n     *  maxTimeToLive: BigInt (7) * BigInt(24) * BigInt(3_600_000_000_000), // 1 week\n     *  windowOpenerFeatures: \"toolbar=0,location=0,menubar=0,width=500,height=500,left=100,top=100\",\n     *  onSuccess: () => {\n     *    console.log('Login Successful!');\n     *  },\n     *  onError: (error) => {\n     *    console.error('Login Failed: ', error);\n     *  }\n     * });\n     */\n    async login(options) {\n        var _a, _b, _c, _d;\n        // Set default maxTimeToLive to 8 hours\n        const defaultTimeToLive = /* hours */ BigInt(8) * /* nanoseconds */ BigInt(3600000000000);\n        // Create the URL of the IDP. (e.g. https://XXXX/#authorize)\n        const identityProviderUrl = new URL(((_a = options === null || options === void 0 ? void 0 : options.identityProvider) === null || _a === void 0 ? void 0 : _a.toString()) || IDENTITY_PROVIDER_DEFAULT);\n        // Set the correct hash if it isn't already set.\n        identityProviderUrl.hash = IDENTITY_PROVIDER_ENDPOINT;\n        // If `login` has been called previously, then close/remove any previous windows\n        // and event listeners.\n        (_b = this._idpWindow) === null || _b === void 0 ? void 0 : _b.close();\n        this._removeEventListener();\n        // Add an event listener to handle responses.\n        this._eventHandler = this._getEventHandler(identityProviderUrl, Object.assign({ maxTimeToLive: (_c = options === null || options === void 0 ? void 0 : options.maxTimeToLive) !== null && _c !== void 0 ? _c : defaultTimeToLive }, options));\n        window.addEventListener('message', this._eventHandler);\n        // Open a new window with the IDP provider.\n        this._idpWindow =\n            (_d = window.open(identityProviderUrl.toString(), 'idpWindow', options === null || options === void 0 ? void 0 : options.windowOpenerFeatures)) !== null && _d !== void 0 ? _d : undefined;\n        // Check if the _idpWindow is closed by user.\n        const checkInterruption = () => {\n            // The _idpWindow is opened and not yet closed by the client\n            if (this._idpWindow) {\n                if (this._idpWindow.closed) {\n                    this._handleFailure(ERROR_USER_INTERRUPT, options === null || options === void 0 ? void 0 : options.onError);\n                }\n                else {\n                    setTimeout(checkInterruption, INTERRUPT_CHECK_INTERVAL);\n                }\n            }\n        };\n        checkInterruption();\n    }\n    _getEventHandler(identityProviderUrl, options) {\n        return async (event) => {\n            var _a, _b, _c;\n            if (event.origin !== identityProviderUrl.origin) {\n                console.warn(`WARNING: expected origin '${identityProviderUrl.origin}', got '${event.origin}' (ignoring)`);\n                return;\n            }\n            const message = event.data;\n            switch (message.kind) {\n                case 'authorize-ready': {\n                    // IDP is ready. Send a message to request authorization.\n                    const request = Object.assign({ kind: 'authorize-client', sessionPublicKey: new Uint8Array((_a = this._key) === null || _a === void 0 ? void 0 : _a.getPublicKey().toDer()), maxTimeToLive: options === null || options === void 0 ? void 0 : options.maxTimeToLive, allowPinAuthentication: options === null || options === void 0 ? void 0 : options.allowPinAuthentication, derivationOrigin: (_b = options === null || options === void 0 ? void 0 : options.derivationOrigin) === null || _b === void 0 ? void 0 : _b.toString() }, options === null || options === void 0 ? void 0 : options.customValues);\n                    (_c = this._idpWindow) === null || _c === void 0 ? void 0 : _c.postMessage(request, identityProviderUrl.origin);\n                    break;\n                }\n                case 'authorize-client-success':\n                    // Create the delegation chain and store it.\n                    try {\n                        await this._handleSuccess(message, options === null || options === void 0 ? void 0 : options.onSuccess);\n                    }\n                    catch (err) {\n                        this._handleFailure(err.message, options === null || options === void 0 ? void 0 : options.onError);\n                    }\n                    break;\n                case 'authorize-client-failure':\n                    this._handleFailure(message.text, options === null || options === void 0 ? void 0 : options.onError);\n                    break;\n                default:\n                    break;\n            }\n        };\n    }\n    _handleFailure(errorMessage, onError) {\n        var _a;\n        (_a = this._idpWindow) === null || _a === void 0 ? void 0 : _a.close();\n        onError === null || onError === void 0 ? void 0 : onError(errorMessage);\n        this._removeEventListener();\n        delete this._idpWindow;\n    }\n    _removeEventListener() {\n        if (this._eventHandler) {\n            window.removeEventListener('message', this._eventHandler);\n        }\n        this._eventHandler = undefined;\n    }\n    async logout(options = {}) {\n        await _deleteStorage(this._storage);\n        // Reset this auth client to a non-authenticated state.\n        this._identity = new _dfinity_agent__WEBPACK_IMPORTED_MODULE_0__.AnonymousIdentity();\n        this._chain = null;\n        if (options.returnTo) {\n            try {\n                window.history.pushState({}, '', options.returnTo);\n            }\n            catch (e) {\n                window.location.href = options.returnTo;\n            }\n        }\n    }\n}\nasync function _deleteStorage(storage) {\n    await storage.remove(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_KEY);\n    await storage.remove(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_STORAGE_DELEGATION);\n    await storage.remove(_storage__WEBPACK_IMPORTED_MODULE_3__.KEY_VECTOR);\n}\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGRmaW5pdHkvYXV0aC1jbGllbnQvbGliL2VzbS9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNvRDtBQUNxSDtBQUM3SDtBQUMwRTtBQUN4QjtBQUM3RDtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDdUI7QUFDOUI7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx5QkFBeUIsbUNBQW1DO0FBQzNFLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBLGVBQWUsYUFBYSxtQ0FBbUM7QUFDL0QsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLG9DQUFvQztBQUNwQztBQUNBLG9GQUFvRixnREFBVTtBQUM5RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQscURBQWU7QUFDeEUseUNBQXlDLCtDQUFTO0FBQ2xEO0FBQ0E7QUFDQSxxREFBcUQsa0RBQVk7QUFDakUsc0VBQXNFLDREQUFzQjtBQUM1RixvRUFBb0UscURBQWU7QUFDbkY7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLDREQUFzQjtBQUNoRSwwQ0FBMEMscURBQWU7QUFDekQ7QUFDQTtBQUNBLDBEQUEwRCw0REFBc0I7QUFDaEYsMERBQTBELHFEQUFlO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLGlFQUFrQjtBQUMxRDtBQUNBO0FBQ0Esd0NBQXdDLCtEQUFnQjtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixpRUFBa0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiw2REFBaUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsdURBQXVELDREQUFzQjtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qiw4REFBZTtBQUMzQztBQUNBLHlCQUF5QixvRUFBaUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLHdFQUF5QjtBQUNoRTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsaUVBQWtCO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIscURBQVc7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsaUVBQWtCO0FBQzlDLGtDQUFrQyxxREFBZTtBQUNqRDtBQUNBO0FBQ0E7QUFDQSx3TkFBd04sa0JBQWtCO0FBQzFPO0FBQ0EsNEJBQTRCLCtEQUFnQjtBQUM1QyxrQ0FBa0MscURBQWU7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyx5REFBVTtBQUMxQztBQUNBO0FBQ0EsU0FBUztBQUNULGdDQUFnQyw4REFBZTtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsd0VBQXlCO0FBQ3REO0FBQ0E7QUFDQSw2QkFBNkIsaUVBQWtCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixxREFBVztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLDREQUFzQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx3QkFBd0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0ZBQXdGLGtKQUFrSjtBQUMxTztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCwyQkFBMkIsVUFBVSxhQUFhO0FBQzVHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCx1ZUFBdWU7QUFDM2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0EsNkJBQTZCLDZEQUFpQjtBQUM5QztBQUNBO0FBQ0E7QUFDQSwyQ0FBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixxREFBZTtBQUN4Qyx5QkFBeUIsNERBQXNCO0FBQy9DLHlCQUF5QixnREFBVTtBQUNuQztBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9AZGZpbml0eS9hdXRoLWNsaWVudC9saWIvZXNtL2luZGV4LmpzPzA3N2YiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqIEBtb2R1bGUgQXV0aENsaWVudCAqL1xuaW1wb3J0IHsgQW5vbnltb3VzSWRlbnRpdHksIH0gZnJvbSAnQGRmaW5pdHkvYWdlbnQnO1xuaW1wb3J0IHsgRGVsZWdhdGlvbiwgRGVsZWdhdGlvbkNoYWluLCBpc0RlbGVnYXRpb25WYWxpZCwgRGVsZWdhdGlvbklkZW50aXR5LCBFZDI1NTE5S2V5SWRlbnRpdHksIEVDRFNBS2V5SWRlbnRpdHksIFBhcnRpYWxEZWxlZ2F0aW9uSWRlbnRpdHksIH0gZnJvbSAnQGRmaW5pdHkvaWRlbnRpdHknO1xuaW1wb3J0IHsgSWRsZU1hbmFnZXIgfSBmcm9tICcuL2lkbGVNYW5hZ2VyJztcbmltcG9ydCB7IElkYlN0b3JhZ2UsIGlzQnJvd3NlciwgS0VZX1NUT1JBR0VfREVMRUdBVElPTiwgS0VZX1NUT1JBR0VfS0VZLCBLRVlfVkVDVE9SLCBMb2NhbFN0b3JhZ2UsIH0gZnJvbSAnLi9zdG9yYWdlJztcbmV4cG9ydCB7IElkYlN0b3JhZ2UsIExvY2FsU3RvcmFnZSwgS0VZX1NUT1JBR0VfREVMRUdBVElPTiwgS0VZX1NUT1JBR0VfS0VZIH0gZnJvbSAnLi9zdG9yYWdlJztcbmV4cG9ydCB7IElkYktleVZhbCB9IGZyb20gJy4vZGInO1xuY29uc3QgSURFTlRJVFlfUFJPVklERVJfREVGQVVMVCA9ICdodHRwczovL2lkZW50aXR5LmljMC5hcHAnO1xuY29uc3QgSURFTlRJVFlfUFJPVklERVJfRU5EUE9JTlQgPSAnI2F1dGhvcml6ZSc7XG5jb25zdCBFQ0RTQV9LRVlfTEFCRUwgPSAnRUNEU0EnO1xuY29uc3QgRUQyNTUxOV9LRVlfTEFCRUwgPSAnRWQyNTUxOSc7XG5jb25zdCBJTlRFUlJVUFRfQ0hFQ0tfSU5URVJWQUwgPSA1MDA7XG5leHBvcnQgY29uc3QgRVJST1JfVVNFUl9JTlRFUlJVUFQgPSAnVXNlckludGVycnVwdCc7XG5leHBvcnQgKiBmcm9tICcuL2lkbGVNYW5hZ2VyJztcbi8qKlxuICogVG9vbCB0byBtYW5hZ2UgYXV0aGVudGljYXRpb24gYW5kIGlkZW50aXR5XG4gKiBAc2VlIHtAbGluayBBdXRoQ2xpZW50fVxuICovXG5leHBvcnQgY2xhc3MgQXV0aENsaWVudCB7XG4gICAgY29uc3RydWN0b3IoX2lkZW50aXR5LCBfa2V5LCBfY2hhaW4sIF9zdG9yYWdlLCBpZGxlTWFuYWdlciwgX2NyZWF0ZU9wdGlvbnMsIFxuICAgIC8vIEEgaGFuZGxlIG9uIHRoZSBJZFAgd2luZG93LlxuICAgIF9pZHBXaW5kb3csIFxuICAgIC8vIFRoZSBldmVudCBoYW5kbGVyIGZvciBwcm9jZXNzaW5nIGV2ZW50cyBmcm9tIHRoZSBJZFAuXG4gICAgX2V2ZW50SGFuZGxlcikge1xuICAgICAgICB0aGlzLl9pZGVudGl0eSA9IF9pZGVudGl0eTtcbiAgICAgICAgdGhpcy5fa2V5ID0gX2tleTtcbiAgICAgICAgdGhpcy5fY2hhaW4gPSBfY2hhaW47XG4gICAgICAgIHRoaXMuX3N0b3JhZ2UgPSBfc3RvcmFnZTtcbiAgICAgICAgdGhpcy5pZGxlTWFuYWdlciA9IGlkbGVNYW5hZ2VyO1xuICAgICAgICB0aGlzLl9jcmVhdGVPcHRpb25zID0gX2NyZWF0ZU9wdGlvbnM7XG4gICAgICAgIHRoaXMuX2lkcFdpbmRvdyA9IF9pZHBXaW5kb3c7XG4gICAgICAgIHRoaXMuX2V2ZW50SGFuZGxlciA9IF9ldmVudEhhbmRsZXI7XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyRGVmYXVsdElkbGVDYWxsYmFjaygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYW4gQXV0aENsaWVudCB0byBtYW5hZ2UgYXV0aGVudGljYXRpb24gYW5kIGlkZW50aXR5XG4gICAgICogQGNvbnN0cnVjdHNcbiAgICAgKiBAcGFyYW0ge0F1dGhDbGllbnRDcmVhdGVPcHRpb25zfSBvcHRpb25zIC0gT3B0aW9ucyBmb3IgY3JlYXRpbmcgYW4ge0BsaW5rIEF1dGhDbGllbnR9XG4gICAgICogQHNlZSB7QGxpbmsgQXV0aENsaWVudENyZWF0ZU9wdGlvbnN9XG4gICAgICogQHBhcmFtIG9wdGlvbnMuaWRlbnRpdHkgT3B0aW9uYWwgSWRlbnRpdHkgdG8gdXNlIGFzIHRoZSBiYXNlXG4gICAgICogQHNlZSB7QGxpbmsgU2lnbklkZW50aXR5fVxuICAgICAqIEBwYXJhbSBvcHRpb25zLnN0b3JhZ2UgU3RvcmFnZSBtZWNoYW5pc20gZm9yIGRlbGVncmF0aW9uIGNyZWRlbnRpYWxzXG4gICAgICogQHNlZSB7QGxpbmsgQXV0aENsaWVudFN0b3JhZ2V9XG4gICAgICogQHBhcmFtIG9wdGlvbnMua2V5VHlwZSBUeXBlIG9mIGtleSB0byB1c2UgZm9yIHRoZSBiYXNlIGtleVxuICAgICAqIEBwYXJhbSB7SWRsZU9wdGlvbnN9IG9wdGlvbnMuaWRsZU9wdGlvbnMgQ29uZmlndXJlcyBhbiB7QGxpbmsgSWRsZU1hbmFnZXJ9XG4gICAgICogQHNlZSB7QGxpbmsgSWRsZU9wdGlvbnN9XG4gICAgICogRGVmYXVsdCBiZWhhdmlvciBpcyB0byBjbGVhciBzdG9yZWQgaWRlbnRpdHkgYW5kIHJlbG9hZCB0aGUgcGFnZSB3aGVuIGEgdXNlciBnb2VzIGlkbGUsIHVubGVzcyB5b3Ugc2V0IHRoZSBkaXNhYmxlRGVmYXVsdElkbGVDYWxsYmFjayBmbGFnIG9yIHBhc3MgaW4gYSBjdXN0b20gaWRsZSBjYWxsYmFjay5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IGF1dGhDbGllbnQgPSBhd2FpdCBBdXRoQ2xpZW50LmNyZWF0ZSh7XG4gICAgICogICBpZGxlT3B0aW9uczoge1xuICAgICAqICAgICBkaXNhYmxlSWRsZTogdHJ1ZVxuICAgICAqICAgfVxuICAgICAqIH0pXG4gICAgICovXG4gICAgc3RhdGljIGFzeW5jIGNyZWF0ZShvcHRpb25zID0ge30pIHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgICAgIGNvbnN0IHN0b3JhZ2UgPSAoX2EgPSBvcHRpb25zLnN0b3JhZ2UpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IG5ldyBJZGJTdG9yYWdlKCk7XG4gICAgICAgIGNvbnN0IGtleVR5cGUgPSAoX2IgPSBvcHRpb25zLmtleVR5cGUpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IEVDRFNBX0tFWV9MQUJFTDtcbiAgICAgICAgbGV0IGtleSA9IG51bGw7XG4gICAgICAgIGlmIChvcHRpb25zLmlkZW50aXR5KSB7XG4gICAgICAgICAgICBrZXkgPSBvcHRpb25zLmlkZW50aXR5O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGV0IG1heWJlSWRlbnRpdHlTdG9yYWdlID0gYXdhaXQgc3RvcmFnZS5nZXQoS0VZX1NUT1JBR0VfS0VZKTtcbiAgICAgICAgICAgIGlmICghbWF5YmVJZGVudGl0eVN0b3JhZ2UgJiYgaXNCcm93c2VyKSB7XG4gICAgICAgICAgICAgICAgLy8gQXR0ZW1wdCB0byBtaWdyYXRlIGZyb20gbG9jYWxzdG9yYWdlXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmFsbGJhY2tMb2NhbFN0b3JhZ2UgPSBuZXcgTG9jYWxTdG9yYWdlKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxvY2FsQ2hhaW4gPSBhd2FpdCBmYWxsYmFja0xvY2FsU3RvcmFnZS5nZXQoS0VZX1NUT1JBR0VfREVMRUdBVElPTik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxvY2FsS2V5ID0gYXdhaXQgZmFsbGJhY2tMb2NhbFN0b3JhZ2UuZ2V0KEtFWV9TVE9SQUdFX0tFWSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vdCByZWxldmFudCBmb3IgRWQyNTUxOVxuICAgICAgICAgICAgICAgICAgICBpZiAobG9jYWxDaGFpbiAmJiBsb2NhbEtleSAmJiBrZXlUeXBlID09PSBFQ0RTQV9LRVlfTEFCRUwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEaXNjb3ZlcmVkIGFuIGlkZW50aXR5IHN0b3JlZCBpbiBsb2NhbHN0b3JhZ2UuIE1pZ3JhdGluZyB0byBJbmRleGVkREInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHN0b3JhZ2Uuc2V0KEtFWV9TVE9SQUdFX0RFTEVHQVRJT04sIGxvY2FsQ2hhaW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc3RvcmFnZS5zZXQoS0VZX1NUT1JBR0VfS0VZLCBsb2NhbEtleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXliZUlkZW50aXR5U3RvcmFnZSA9IGxvY2FsQ2hhaW47XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjbGVhbiB1cFxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmFsbGJhY2tMb2NhbFN0b3JhZ2UucmVtb3ZlKEtFWV9TVE9SQUdFX0RFTEVHQVRJT04pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmFsbGJhY2tMb2NhbFN0b3JhZ2UucmVtb3ZlKEtFWV9TVE9SQUdFX0tFWSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2Vycm9yIHdoaWxlIGF0dGVtcHRpbmcgdG8gcmVjb3ZlciBsb2NhbHN0b3JhZ2U6ICcgKyBlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG1heWJlSWRlbnRpdHlTdG9yYWdlKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtYXliZUlkZW50aXR5U3RvcmFnZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXlUeXBlID09PSBFRDI1NTE5X0tFWV9MQUJFTCAmJiB0eXBlb2YgbWF5YmVJZGVudGl0eVN0b3JhZ2UgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5ID0gYXdhaXQgRWQyNTUxOUtleUlkZW50aXR5LmZyb21KU09OKG1heWJlSWRlbnRpdHlTdG9yYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleSA9IGF3YWl0IEVDRFNBS2V5SWRlbnRpdHkuZnJvbUtleVBhaXIobWF5YmVJZGVudGl0eVN0b3JhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBtYXliZUlkZW50aXR5U3RvcmFnZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBsZWdhY3kgaWRlbnRpdHksIHdoaWNoIGlzIGEgc2VyaWFsaXplZCBFZDI1NTE5S2V5SWRlbnRpdHkuXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSBFZDI1NTE5S2V5SWRlbnRpdHkuZnJvbUpTT04obWF5YmVJZGVudGl0eVN0b3JhZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElnbm9yZSB0aGlzLCB0aGlzIG1lYW5zIHRoYXQgdGhlIGxvY2FsU3RvcmFnZSB2YWx1ZSBpc24ndCBhIHZhbGlkIEVkMjU1MTlLZXlJZGVudGl0eSBvciBFQ0RTQUtleUlkZW50aXR5XG4gICAgICAgICAgICAgICAgICAgIC8vIHNlcmlhbGl6YXRpb24uXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGxldCBpZGVudGl0eSA9IG5ldyBBbm9ueW1vdXNJZGVudGl0eSgpO1xuICAgICAgICBsZXQgY2hhaW4gPSBudWxsO1xuICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoYWluU3RvcmFnZSA9IGF3YWl0IHN0b3JhZ2UuZ2V0KEtFWV9TVE9SQUdFX0RFTEVHQVRJT04pO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY2hhaW5TdG9yYWdlID09PSAnb2JqZWN0JyAmJiBjaGFpblN0b3JhZ2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEZWxlZ2F0aW9uIGNoYWluIGlzIGluY29ycmVjdGx5IHN0b3JlZC4gQSBkZWxlZ2F0aW9uIGNoYWluIHNob3VsZCBiZSBzdG9yZWQgYXMgYSBzdHJpbmcuJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmlkZW50aXR5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlkZW50aXR5ID0gb3B0aW9ucy5pZGVudGl0eTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY2hhaW5TdG9yYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYWluID0gRGVsZWdhdGlvbkNoYWluLmZyb21KU09OKGNoYWluU3RvcmFnZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFZlcmlmeSB0aGF0IHRoZSBkZWxlZ2F0aW9uIGlzbid0IGV4cGlyZWQuXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNEZWxlZ2F0aW9uVmFsaWQoY2hhaW4pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBfZGVsZXRlU3RvcmFnZShzdG9yYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUga2V5IGlzIGEgcHVibGljIGtleSwgdGhlbiB3ZSBjcmVhdGUgYSBQYXJ0aWFsRGVsZWdhdGlvbklkZW50aXR5LlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCd0b0RlcicgaW4ga2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRlbnRpdHkgPSBQYXJ0aWFsRGVsZWdhdGlvbklkZW50aXR5LmZyb21EZWxlZ2F0aW9uKGtleSwgY2hhaW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSwgd2UgY3JlYXRlIGEgRGVsZWdhdGlvbklkZW50aXR5LlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRlbnRpdHkgPSBEZWxlZ2F0aW9uSWRlbnRpdHkuZnJvbURlbGVnYXRpb24oa2V5LCBjaGFpbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgd2FzIGEgcHJvYmxlbSBsb2FkaW5nIHRoZSBjaGFpbiwgZGVsZXRlIHRoZSBrZXkuXG4gICAgICAgICAgICAgICAgYXdhaXQgX2RlbGV0ZVN0b3JhZ2Uoc3RvcmFnZSk7XG4gICAgICAgICAgICAgICAga2V5ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsZXQgaWRsZU1hbmFnZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmICgoX2MgPSBvcHRpb25zLmlkbGVPcHRpb25zKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MuZGlzYWJsZUlkbGUpIHtcbiAgICAgICAgICAgIGlkbGVNYW5hZ2VyID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmIHRoZXJlIGlzIGEgZGVsZWdhdGlvbiBjaGFpbiBvciBwcm92aWRlZCBpZGVudGl0eSwgc2V0dXAgaWRsZU1hbmFnZXJcbiAgICAgICAgZWxzZSBpZiAoY2hhaW4gfHwgb3B0aW9ucy5pZGVudGl0eSkge1xuICAgICAgICAgICAgaWRsZU1hbmFnZXIgPSBJZGxlTWFuYWdlci5jcmVhdGUob3B0aW9ucy5pZGxlT3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFrZXkpIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSBhIG5ldyBrZXkgKHdoZXRoZXIgb3Igbm90IG9uZSB3YXMgaW4gc3RvcmFnZSkuXG4gICAgICAgICAgICBpZiAoa2V5VHlwZSA9PT0gRUQyNTUxOV9LRVlfTEFCRUwpIHtcbiAgICAgICAgICAgICAgICBrZXkgPSBhd2FpdCBFZDI1NTE5S2V5SWRlbnRpdHkuZ2VuZXJhdGUoKTtcbiAgICAgICAgICAgICAgICBhd2FpdCBzdG9yYWdlLnNldChLRVlfU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KGtleS50b0pTT04oKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3RvcmFnZSAmJiBrZXlUeXBlID09PSBFQ0RTQV9LRVlfTEFCRUwpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBZb3UgYXJlIHVzaW5nIGEgY3VzdG9tIHN0b3JhZ2UgcHJvdmlkZXIgdGhhdCBtYXkgbm90IHN1cHBvcnQgQ3J5cHRvS2V5IHN0b3JhZ2UuIElmIHlvdSBhcmUgdXNpbmcgYSBjdXN0b20gc3RvcmFnZSBwcm92aWRlciB0aGF0IGRvZXMgbm90IHN1cHBvcnQgQ3J5cHRvS2V5IHN0b3JhZ2UsIHlvdSBzaG91bGQgdXNlICcke0VEMjU1MTlfS0VZX0xBQkVMfScgYXMgdGhlIGtleSB0eXBlLCBhcyBpdCBjYW4gc2VyaWFsaXplIHRvIGEgc3RyaW5nYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGtleSA9IGF3YWl0IEVDRFNBS2V5SWRlbnRpdHkuZ2VuZXJhdGUoKTtcbiAgICAgICAgICAgICAgICBhd2FpdCBzdG9yYWdlLnNldChLRVlfU1RPUkFHRV9LRVksIGtleS5nZXRLZXlQYWlyKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgdGhpcyhpZGVudGl0eSwga2V5LCBjaGFpbiwgc3RvcmFnZSwgaWRsZU1hbmFnZXIsIG9wdGlvbnMpO1xuICAgIH1cbiAgICBfcmVnaXN0ZXJEZWZhdWx0SWRsZUNhbGxiYWNrKCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICBjb25zdCBpZGxlT3B0aW9ucyA9IChfYSA9IHRoaXMuX2NyZWF0ZU9wdGlvbnMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pZGxlT3B0aW9ucztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIERlZmF1bHQgYmVoYXZpb3IgaXMgdG8gY2xlYXIgc3RvcmVkIGlkZW50aXR5IGFuZCByZWxvYWQgdGhlIHBhZ2UuXG4gICAgICAgICAqIEJ5IGVpdGhlciBzZXR0aW5nIHRoZSBkaXNhYmxlRGVmYXVsdElkbGVDYWxsYmFjayBmbGFnIG9yIHBhc3NpbmcgaW4gYSBjdXN0b20gaWRsZSBjYWxsYmFjaywgd2Ugd2lsbCBpZ25vcmUgdGhpcyBjb25maWdcbiAgICAgICAgICovXG4gICAgICAgIGlmICghKGlkbGVPcHRpb25zID09PSBudWxsIHx8IGlkbGVPcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpZGxlT3B0aW9ucy5vbklkbGUpICYmICEoaWRsZU9wdGlvbnMgPT09IG51bGwgfHwgaWRsZU9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGlkbGVPcHRpb25zLmRpc2FibGVEZWZhdWx0SWRsZUNhbGxiYWNrKSkge1xuICAgICAgICAgICAgKF9iID0gdGhpcy5pZGxlTWFuYWdlcikgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnJlZ2lzdGVyQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nb3V0KCk7XG4gICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBfaGFuZGxlU3VjY2VzcyhtZXNzYWdlLCBvblN1Y2Nlc3MpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgY29uc3QgZGVsZWdhdGlvbnMgPSBtZXNzYWdlLmRlbGVnYXRpb25zLm1hcChzaWduZWREZWxlZ2F0aW9uID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZGVsZWdhdGlvbjogbmV3IERlbGVnYXRpb24oc2lnbmVkRGVsZWdhdGlvbi5kZWxlZ2F0aW9uLnB1YmtleSwgc2lnbmVkRGVsZWdhdGlvbi5kZWxlZ2F0aW9uLmV4cGlyYXRpb24sIHNpZ25lZERlbGVnYXRpb24uZGVsZWdhdGlvbi50YXJnZXRzKSxcbiAgICAgICAgICAgICAgICBzaWduYXR1cmU6IHNpZ25lZERlbGVnYXRpb24uc2lnbmF0dXJlLmJ1ZmZlcixcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBkZWxlZ2F0aW9uQ2hhaW4gPSBEZWxlZ2F0aW9uQ2hhaW4uZnJvbURlbGVnYXRpb25zKGRlbGVnYXRpb25zLCBtZXNzYWdlLnVzZXJQdWJsaWNLZXkuYnVmZmVyKTtcbiAgICAgICAgY29uc3Qga2V5ID0gdGhpcy5fa2V5O1xuICAgICAgICBpZiAoIWtleSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2NoYWluID0gZGVsZWdhdGlvbkNoYWluO1xuICAgICAgICBpZiAoJ3RvRGVyJyBpbiBrZXkpIHtcbiAgICAgICAgICAgIHRoaXMuX2lkZW50aXR5ID0gUGFydGlhbERlbGVnYXRpb25JZGVudGl0eS5mcm9tRGVsZWdhdGlvbihrZXksIHRoaXMuX2NoYWluKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2lkZW50aXR5ID0gRGVsZWdhdGlvbklkZW50aXR5LmZyb21EZWxlZ2F0aW9uKGtleSwgdGhpcy5fY2hhaW4pO1xuICAgICAgICB9XG4gICAgICAgIChfYSA9IHRoaXMuX2lkcFdpbmRvdykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNsb3NlKCk7XG4gICAgICAgIGNvbnN0IGlkbGVPcHRpb25zID0gKF9iID0gdGhpcy5fY3JlYXRlT3B0aW9ucykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmlkbGVPcHRpb25zO1xuICAgICAgICAvLyBjcmVhdGUgdGhlIGlkbGUgbWFuYWdlciBvbiBhIHN1Y2Nlc3NmdWwgbG9naW4gaWYgd2UgaGF2ZW4ndCBkaXNhYmxlZCBpdFxuICAgICAgICAvLyBhbmQgaXQgZG9lc24ndCBhbHJlYWR5IGV4aXN0LlxuICAgICAgICBpZiAoIXRoaXMuaWRsZU1hbmFnZXIgJiYgIShpZGxlT3B0aW9ucyA9PT0gbnVsbCB8fCBpZGxlT3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogaWRsZU9wdGlvbnMuZGlzYWJsZUlkbGUpKSB7XG4gICAgICAgICAgICB0aGlzLmlkbGVNYW5hZ2VyID0gSWRsZU1hbmFnZXIuY3JlYXRlKGlkbGVPcHRpb25zKTtcbiAgICAgICAgICAgIHRoaXMuX3JlZ2lzdGVyRGVmYXVsdElkbGVDYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXIoKTtcbiAgICAgICAgZGVsZXRlIHRoaXMuX2lkcFdpbmRvdztcbiAgICAgICAgaWYgKHRoaXMuX2NoYWluKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLl9zdG9yYWdlLnNldChLRVlfU1RPUkFHRV9ERUxFR0FUSU9OLCBKU09OLnN0cmluZ2lmeSh0aGlzLl9jaGFpbi50b0pTT04oKSkpO1xuICAgICAgICB9XG4gICAgICAgIC8vIG9uU3VjY2VzcyBzaG91bGQgYmUgdGhlIGxhc3QgdGhpbmcgdG8gZG8gdG8gYXZvaWQgY29uc3VtZXJzXG4gICAgICAgIC8vIGludGVyZmVyaW5nIGJ5IG5hdmlnYXRpbmcgb3IgcmVmcmVzaGluZyB0aGUgcGFnZVxuICAgICAgICBvblN1Y2Nlc3MgPT09IG51bGwgfHwgb25TdWNjZXNzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvblN1Y2Nlc3MobWVzc2FnZSk7XG4gICAgfVxuICAgIGdldElkZW50aXR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faWRlbnRpdHk7XG4gICAgfVxuICAgIGFzeW5jIGlzQXV0aGVudGljYXRlZCgpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLmdldElkZW50aXR5KCkuZ2V0UHJpbmNpcGFsKCkuaXNBbm9ueW1vdXMoKSAmJiB0aGlzLl9jaGFpbiAhPT0gbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXV0aENsaWVudCBMb2dpbiAtXG4gICAgICogT3BlbnMgdXAgYSBuZXcgd2luZG93IHRvIGF1dGhlbnRpY2F0ZSB3aXRoIEludGVybmV0IElkZW50aXR5XG4gICAgICogQHBhcmFtIHtBdXRoQ2xpZW50TG9naW5PcHRpb25zfSBvcHRpb25zIC0gT3B0aW9ucyBmb3IgbG9nZ2luZyBpblxuICAgICAqIEBwYXJhbSBvcHRpb25zLmlkZW50aXR5UHJvdmlkZXIgSWRlbnRpdHkgcHJvdmlkZXJcbiAgICAgKiBAcGFyYW0gb3B0aW9ucy5tYXhUaW1lVG9MaXZlIEV4cGlyYXRpb24gb2YgdGhlIGF1dGhlbnRpY2F0aW9uIGluIG5hbm9zZWNvbmRzXG4gICAgICogQHBhcmFtIG9wdGlvbnMuYWxsb3dQaW5BdXRoZW50aWNhdGlvbiBJZiBwcmVzZW50LCBpbmRpY2F0ZXMgd2hldGhlciBvciBub3QgdGhlIElkZW50aXR5IFByb3ZpZGVyIHNob3VsZCBhbGxvdyB0aGUgdXNlciB0byBhdXRoZW50aWNhdGUgYW5kL29yIHJlZ2lzdGVyIHVzaW5nIGEgdGVtcG9yYXJ5IGtleS9QSU4gaWRlbnRpdHkuIEF1dGhlbnRpY2F0aW5nIGRhcHBzIG1heSB3YW50IHRvIHByZXZlbnQgdXNlcnMgZnJvbSB1c2luZyBUZW1wb3Jhcnkga2V5cy9QSU4gaWRlbnRpdGllcyBiZWNhdXNlIFRlbXBvcmFyeSBrZXlzL1BJTiBpZGVudGl0aWVzIGFyZSBsZXNzIHNlY3VyZSB0aGFuIFBhc3NrZXlzICh3ZWJhdXRobiBjcmVkZW50aWFscykgYW5kIGJlY2F1c2UgVGVtcG9yYXJ5IGtleXMvUElOIGlkZW50aXRpZXMgZ2VuZXJhbGx5IG9ubHkgbGl2ZSBpbiBhIGJyb3dzZXIgZGF0YWJhc2UgKHdoaWNoIG1heSBnZXQgY2xlYXJlZCBieSB0aGUgYnJvd3Nlci9PUykuXG4gICAgICogQHBhcmFtIG9wdGlvbnMuZGVyaXZhdGlvbk9yaWdpbiBPcmlnaW4gZm9yIElkZW50aXR5IFByb3ZpZGVyIHRvIHVzZSB3aGlsZSBnZW5lcmF0aW5nIHRoZSBkZWxlZ2F0ZWQgaWRlbnRpdHlcbiAgICAgKiBAcGFyYW0gb3B0aW9ucy53aW5kb3dPcGVuZXJGZWF0dXJlcyBDb25maWd1cmVzIHRoZSBvcGVuZWQgYXV0aGVudGljYXRpb24gd2luZG93XG4gICAgICogQHBhcmFtIG9wdGlvbnMub25TdWNjZXNzIENhbGxiYWNrIG9uY2UgbG9naW4gaGFzIGNvbXBsZXRlZFxuICAgICAqIEBwYXJhbSBvcHRpb25zLm9uRXJyb3IgQ2FsbGJhY2sgaW4gY2FzZSBhdXRoZW50aWNhdGlvbiBmYWlsc1xuICAgICAqIEBleGFtcGxlXG4gICAgICogY29uc3QgYXV0aENsaWVudCA9IGF3YWl0IEF1dGhDbGllbnQuY3JlYXRlKCk7XG4gICAgICogYXV0aENsaWVudC5sb2dpbih7XG4gICAgICogIGlkZW50aXR5UHJvdmlkZXI6ICdodHRwOi8vPGNhbmlzdGVySUQ+LjEyNy4wLjAuMTo4MDAwJyxcbiAgICAgKiAgbWF4VGltZVRvTGl2ZTogQmlnSW50ICg3KSAqIEJpZ0ludCgyNCkgKiBCaWdJbnQoM182MDBfMDAwXzAwMF8wMDApLCAvLyAxIHdlZWtcbiAgICAgKiAgd2luZG93T3BlbmVyRmVhdHVyZXM6IFwidG9vbGJhcj0wLGxvY2F0aW9uPTAsbWVudWJhcj0wLHdpZHRoPTUwMCxoZWlnaHQ9NTAwLGxlZnQ9MTAwLHRvcD0xMDBcIixcbiAgICAgKiAgb25TdWNjZXNzOiAoKSA9PiB7XG4gICAgICogICAgY29uc29sZS5sb2coJ0xvZ2luIFN1Y2Nlc3NmdWwhJyk7XG4gICAgICogIH0sXG4gICAgICogIG9uRXJyb3I6IChlcnJvcikgPT4ge1xuICAgICAqICAgIGNvbnNvbGUuZXJyb3IoJ0xvZ2luIEZhaWxlZDogJywgZXJyb3IpO1xuICAgICAqICB9XG4gICAgICogfSk7XG4gICAgICovXG4gICAgYXN5bmMgbG9naW4ob3B0aW9ucykge1xuICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgICAgIC8vIFNldCBkZWZhdWx0IG1heFRpbWVUb0xpdmUgdG8gOCBob3Vyc1xuICAgICAgICBjb25zdCBkZWZhdWx0VGltZVRvTGl2ZSA9IC8qIGhvdXJzICovIEJpZ0ludCg4KSAqIC8qIG5hbm9zZWNvbmRzICovIEJpZ0ludCgzNjAwMDAwMDAwMDAwKTtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBVUkwgb2YgdGhlIElEUC4gKGUuZy4gaHR0cHM6Ly9YWFhYLyNhdXRob3JpemUpXG4gICAgICAgIGNvbnN0IGlkZW50aXR5UHJvdmlkZXJVcmwgPSBuZXcgVVJMKCgoX2EgPSBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMuaWRlbnRpdHlQcm92aWRlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnRvU3RyaW5nKCkpIHx8IElERU5USVRZX1BST1ZJREVSX0RFRkFVTFQpO1xuICAgICAgICAvLyBTZXQgdGhlIGNvcnJlY3QgaGFzaCBpZiBpdCBpc24ndCBhbHJlYWR5IHNldC5cbiAgICAgICAgaWRlbnRpdHlQcm92aWRlclVybC5oYXNoID0gSURFTlRJVFlfUFJPVklERVJfRU5EUE9JTlQ7XG4gICAgICAgIC8vIElmIGBsb2dpbmAgaGFzIGJlZW4gY2FsbGVkIHByZXZpb3VzbHksIHRoZW4gY2xvc2UvcmVtb3ZlIGFueSBwcmV2aW91cyB3aW5kb3dzXG4gICAgICAgIC8vIGFuZCBldmVudCBsaXN0ZW5lcnMuXG4gICAgICAgIChfYiA9IHRoaXMuX2lkcFdpbmRvdykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmNsb3NlKCk7XG4gICAgICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXIoKTtcbiAgICAgICAgLy8gQWRkIGFuIGV2ZW50IGxpc3RlbmVyIHRvIGhhbmRsZSByZXNwb25zZXMuXG4gICAgICAgIHRoaXMuX2V2ZW50SGFuZGxlciA9IHRoaXMuX2dldEV2ZW50SGFuZGxlcihpZGVudGl0eVByb3ZpZGVyVXJsLCBPYmplY3QuYXNzaWduKHsgbWF4VGltZVRvTGl2ZTogKF9jID0gb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLm1heFRpbWVUb0xpdmUpICE9PSBudWxsICYmIF9jICE9PSB2b2lkIDAgPyBfYyA6IGRlZmF1bHRUaW1lVG9MaXZlIH0sIG9wdGlvbnMpKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLl9ldmVudEhhbmRsZXIpO1xuICAgICAgICAvLyBPcGVuIGEgbmV3IHdpbmRvdyB3aXRoIHRoZSBJRFAgcHJvdmlkZXIuXG4gICAgICAgIHRoaXMuX2lkcFdpbmRvdyA9XG4gICAgICAgICAgICAoX2QgPSB3aW5kb3cub3BlbihpZGVudGl0eVByb3ZpZGVyVXJsLnRvU3RyaW5nKCksICdpZHBXaW5kb3cnLCBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMud2luZG93T3BlbmVyRmVhdHVyZXMpKSAhPT0gbnVsbCAmJiBfZCAhPT0gdm9pZCAwID8gX2QgOiB1bmRlZmluZWQ7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBfaWRwV2luZG93IGlzIGNsb3NlZCBieSB1c2VyLlxuICAgICAgICBjb25zdCBjaGVja0ludGVycnVwdGlvbiA9ICgpID0+IHtcbiAgICAgICAgICAgIC8vIFRoZSBfaWRwV2luZG93IGlzIG9wZW5lZCBhbmQgbm90IHlldCBjbG9zZWQgYnkgdGhlIGNsaWVudFxuICAgICAgICAgICAgaWYgKHRoaXMuX2lkcFdpbmRvdykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pZHBXaW5kb3cuY2xvc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZhaWx1cmUoRVJST1JfVVNFUl9JTlRFUlJVUFQsIG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5vbkVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoY2hlY2tJbnRlcnJ1cHRpb24sIElOVEVSUlVQVF9DSEVDS19JTlRFUlZBTCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjaGVja0ludGVycnVwdGlvbigpO1xuICAgIH1cbiAgICBfZ2V0RXZlbnRIYW5kbGVyKGlkZW50aXR5UHJvdmlkZXJVcmwsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIChldmVudCkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgICAgICAgICBpZiAoZXZlbnQub3JpZ2luICE9PSBpZGVudGl0eVByb3ZpZGVyVXJsLm9yaWdpbikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgV0FSTklORzogZXhwZWN0ZWQgb3JpZ2luICcke2lkZW50aXR5UHJvdmlkZXJVcmwub3JpZ2lufScsIGdvdCAnJHtldmVudC5vcmlnaW59JyAoaWdub3JpbmcpYCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGV2ZW50LmRhdGE7XG4gICAgICAgICAgICBzd2l0Y2ggKG1lc3NhZ2Uua2luZCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2F1dGhvcml6ZS1yZWFkeSc6IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSURQIGlzIHJlYWR5LiBTZW5kIGEgbWVzc2FnZSB0byByZXF1ZXN0IGF1dGhvcml6YXRpb24uXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSBPYmplY3QuYXNzaWduKHsga2luZDogJ2F1dGhvcml6ZS1jbGllbnQnLCBzZXNzaW9uUHVibGljS2V5OiBuZXcgVWludDhBcnJheSgoX2EgPSB0aGlzLl9rZXkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5nZXRQdWJsaWNLZXkoKS50b0RlcigpKSwgbWF4VGltZVRvTGl2ZTogb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLm1heFRpbWVUb0xpdmUsIGFsbG93UGluQXV0aGVudGljYXRpb246IG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5hbGxvd1BpbkF1dGhlbnRpY2F0aW9uLCBkZXJpdmF0aW9uT3JpZ2luOiAoX2IgPSBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMuZGVyaXZhdGlvbk9yaWdpbikgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnRvU3RyaW5nKCkgfSwgb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLmN1c3RvbVZhbHVlcyk7XG4gICAgICAgICAgICAgICAgICAgIChfYyA9IHRoaXMuX2lkcFdpbmRvdykgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLnBvc3RNZXNzYWdlKHJlcXVlc3QsIGlkZW50aXR5UHJvdmlkZXJVcmwub3JpZ2luKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgJ2F1dGhvcml6ZS1jbGllbnQtc3VjY2Vzcyc6XG4gICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgZGVsZWdhdGlvbiBjaGFpbiBhbmQgc3RvcmUgaXQuXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLl9oYW5kbGVTdWNjZXNzKG1lc3NhZ2UsIG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5vblN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZhaWx1cmUoZXJyLm1lc3NhZ2UsIG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5vbkVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhdXRob3JpemUtY2xpZW50LWZhaWx1cmUnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVGYWlsdXJlKG1lc3NhZ2UudGV4dCwgb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLm9uRXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgX2hhbmRsZUZhaWx1cmUoZXJyb3JNZXNzYWdlLCBvbkVycm9yKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgKF9hID0gdGhpcy5faWRwV2luZG93KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2xvc2UoKTtcbiAgICAgICAgb25FcnJvciA9PT0gbnVsbCB8fCBvbkVycm9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvbkVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXIoKTtcbiAgICAgICAgZGVsZXRlIHRoaXMuX2lkcFdpbmRvdztcbiAgICB9XG4gICAgX3JlbW92ZUV2ZW50TGlzdGVuZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLl9ldmVudEhhbmRsZXIpIHtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5fZXZlbnRIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9ldmVudEhhbmRsZXIgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGFzeW5jIGxvZ291dChvcHRpb25zID0ge30pIHtcbiAgICAgICAgYXdhaXQgX2RlbGV0ZVN0b3JhZ2UodGhpcy5fc3RvcmFnZSk7XG4gICAgICAgIC8vIFJlc2V0IHRoaXMgYXV0aCBjbGllbnQgdG8gYSBub24tYXV0aGVudGljYXRlZCBzdGF0ZS5cbiAgICAgICAgdGhpcy5faWRlbnRpdHkgPSBuZXcgQW5vbnltb3VzSWRlbnRpdHkoKTtcbiAgICAgICAgdGhpcy5fY2hhaW4gPSBudWxsO1xuICAgICAgICBpZiAob3B0aW9ucy5yZXR1cm5Ubykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUoe30sICcnLCBvcHRpb25zLnJldHVyblRvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBvcHRpb25zLnJldHVyblRvO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuYXN5bmMgZnVuY3Rpb24gX2RlbGV0ZVN0b3JhZ2Uoc3RvcmFnZSkge1xuICAgIGF3YWl0IHN0b3JhZ2UucmVtb3ZlKEtFWV9TVE9SQUdFX0tFWSk7XG4gICAgYXdhaXQgc3RvcmFnZS5yZW1vdmUoS0VZX1NUT1JBR0VfREVMRUdBVElPTik7XG4gICAgYXdhaXQgc3RvcmFnZS5yZW1vdmUoS0VZX1ZFQ1RPUik7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/@dfinity/auth-client/lib/esm/index.js\n"));

/***/ })

});