(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{528:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return r(9133)}])},9133:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return D}});var a=r(5893),s=r(7294),n=r(1163),i=r(6291),l=r(3195),o=r(512),d=r(8388);function c(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,d.m6)((0,o.W)(t))}let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:c("rounded-xl border border-zinc-200 bg-white text-zinc-950 shadow dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50",r),...s})});u.displayName="Card";let m=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:c("flex flex-col space-y-1.5 p-6",r),...s})});m.displayName="CardHeader";let f=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:c("font-semibold leading-none tracking-tight",r),...s})});f.displayName="CardTitle",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:c("text-sm text-zinc-500 dark:text-zinc-400",r),...s})}).displayName="CardDescription";let x=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:c("p-6 pt-0",r),...s})});x.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:c("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter";var h=r(8426);let p=(0,r(5139).j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-zinc-950 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 dark:focus-visible:ring-zinc-300",{variants:{variant:{default:"bg-zinc-900 text-zinc-50 shadow hover:bg-zinc-900/90 dark:bg-zinc-50 dark:text-zinc-900 dark:hover:bg-zinc-50/90",destructive:"bg-red-500 text-zinc-50 shadow-sm hover:bg-red-500/90 dark:bg-red-900 dark:text-zinc-50 dark:hover:bg-red-900/90",outline:"border border-zinc-200 bg-white shadow-sm hover:bg-zinc-100 hover:text-zinc-900 dark:border-zinc-800 dark:bg-zinc-950 dark:hover:bg-zinc-800 dark:hover:text-zinc-50",secondary:"bg-zinc-100 text-zinc-900 shadow-sm hover:bg-zinc-100/80 dark:bg-zinc-800 dark:text-zinc-50 dark:hover:bg-zinc-800/80",ghost:"hover:bg-zinc-100 hover:text-zinc-900 dark:hover:bg-zinc-800 dark:hover:text-zinc-50",link:"text-zinc-900 underline-offset-4 hover:underline dark:text-zinc-50"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),g=s.forwardRef((e,t)=>{let{className:r,variant:s,size:n,asChild:i=!1,...l}=e,o=i?h.g7:"button";return(0,a.jsx)(o,{className:c(p({variant:s,size:n,className:r})),ref:t,...l})});g.displayName="Button";let b=s.forwardRef((e,t)=>{let{className:r,type:s,...n}=e;return(0,a.jsx)("input",{type:s,className:c("flex h-9 w-full rounded-md border border-zinc-200 bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-zinc-950 placeholder:text-zinc-500 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-zinc-950 disabled:cursor-not-allowed disabled:opacity-50 dark:border-zinc-800 dark:file:text-zinc-50 dark:placeholder:text-zinc-400 dark:focus-visible:ring-zinc-300",r),ref:t,...n})});b.displayName="Input";var y=r(4697),w=r(1568),v=r(4098),N=r(3785);let j=y.fC;y.ZA;let z=y.B4,k=s.forwardRef((e,t)=>{let{className:r,children:s,...n}=e;return(0,a.jsxs)(y.xz,{ref:t,className:c("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-zinc-200 bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-white placeholder:text-zinc-500 focus:outline-none focus:ring-1 focus:ring-zinc-950 disabled:cursor-not-allowed disabled:opacity-50 dark:border-zinc-800 dark:ring-offset-zinc-950 dark:placeholder:text-zinc-400 dark:focus:ring-zinc-300 [&>span]:line-clamp-1",r),...n,children:[s,(0,a.jsx)(y.JO,{asChild:!0,children:(0,a.jsx)(w.Z,{className:"h-4 w-4 opacity-50"})})]})});k.displayName=y.xz.displayName;let _=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(y.u_,{ref:t,className:c("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(v.Z,{className:"h-4 w-4"})})});_.displayName=y.u_.displayName;let E=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(y.$G,{ref:t,className:c("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(w.Z,{className:"h-4 w-4"})})});E.displayName=y.$G.displayName;let S=s.forwardRef((e,t)=>{let{className:r,children:s,position:n="popper",...i}=e;return(0,a.jsx)(y.h_,{children:(0,a.jsxs)(y.VY,{ref:t,className:c("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-zinc-200 bg-white text-zinc-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:n,...i,children:[(0,a.jsx)(_,{}),(0,a.jsx)(y.l_,{className:c("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,a.jsx)(E,{})]})})});S.displayName=y.VY.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(y.__,{ref:t,className:c("px-2 py-1.5 text-sm font-semibold",r),...s})}).displayName=y.__.displayName;let R=s.forwardRef((e,t)=>{let{className:r,children:s,...n}=e;return(0,a.jsxs)(y.ck,{ref:t,className:c("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-zinc-100 focus:text-zinc-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-zinc-800 dark:focus:text-zinc-50",r),...n,children:[(0,a.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(y.wU,{children:(0,a.jsx)(N.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(y.eT,{children:s})]})});R.displayName=y.ck.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(y.Z0,{ref:t,className:c("-mx-1 my-1 h-px bg-zinc-100 dark:bg-zinc-800",r),...s})}).displayName=y.Z0.displayName;var C=r(9976),T=r(7749),Z=r(7963),q=r(3594),I=r(63),A=r(5197),U=r(2770),F=r(3552);let O=e=>{let{IDL:t}=e,r=t.Variant({Ok:t.Null,Err:t.Text}),a=t.Variant({Ok:t.Text,Err:t.Text}),s=t.Variant({Ok:t.Vec(t.Nat8),Err:t.Text});return t.Service({delete_model:t.Func([t.Text],[r],[]),get_model_config:t.Func([t.Text],[a],["query"]),get_model_names:t.Func([],[t.Vec(t.Text)],["query"]),get_model_weights:t.Func([t.Text],[s],["query"]),store_model:t.Func([t.Text,t.Vec(t.Nat8),t.Text],[r],[])})};var P=r(7075),V=e=>{let{authClient:t,identity:r}=e,[n,i]=(0,s.useState)([]),[o,d]=(0,s.useState)(""),[c,h]=(0,s.useState)(null),[p,y]=(0,s.useState)(!1),[w,v]=(0,s.useState)(null),[N,_]=(0,s.useState)(null),[E,V]=(0,s.useState)(!1),D=(0,s.useCallback)(async()=>{try{let e=P.R.fromText("kjtnb-vg5m7-zzbdk-v44p2-m6q3l-vqqhp-kxwhm-ji6ue-jadvn-bflay-tae"),t="http://localhost:4943",r="be2us-64aaa-aaaaa-qaabq-cai";if(!t||!r)throw Error("Missing environment variables");console.log("Initializing actor with dfx principal:",e.toString());let a=new l.i7({host:t,identity:{getPrincipal:()=>e,transformRequest:async t=>{var r,a,s,n,i,l,o;return"query"===t.method?{...t,body:{content:(null===(i=t.body)||void 0===i?void 0:i.content)||null,sender:e,nonce:Array.from(new Uint8Array((null===(l=t.body)||void 0===l?void 0:l.nonce)||0)),ingress_expiry:(null===(o=t.body)||void 0===o?void 0:o.ingress_expiry)||0}}:{...t,body:{content:(null===(r=t.body)||void 0===r?void 0:r.content)||null,sender_pubkey:(null===(a=t.body)||void 0===a?void 0:a.sender_pubkey)||null,sender_sig:(null===(s=t.body)||void 0===s?void 0:s.sender_sig)||null,nonce:(null===(n=t.body)||void 0===n?void 0:n.nonce)||null}}}}});await a.fetchRootKey().catch(e=>{throw console.error("Failed to fetch root key:",e),Error("Failed to fetch root key. Is the local replica running?")});let s=P.R.fromText(r);return l.vt.createActor(O,{agent:a,canisterId:s,effectiveCanisterId:s})}catch(e){throw console.error("Actor initialization failed:",e),e}},[]),L=(0,s.useCallback)(()=>!!E||(v("Please authenticate with Internet Identity first"),!1),[E]),M=async()=>{if(L()&&c)try{y(!0),v(null);let e=await D(),t=await c.arrayBuffer(),r=new Uint8Array(t),a={name:c.name,size:c.size,type:c.type,uploadDate:new Date().toISOString()};console.log("Sending upload request:",{method:"store_model",fileName:c.name,fileSize:c.size,metadataSize:JSON.stringify(a).length,dataSize:r.length});let s=await e.store_model(c.name,Array.from(r),JSON.stringify(a));if(console.log("Upload response:",s),"Err"in s)throw Error("string"==typeof s.Err?s.Err:"Upload failed");await J(),h(null)}catch(e){console.error("Upload error:",e),v(e instanceof Error?e.message:"Failed to upload model")}finally{y(!1)}},B=async e=>{if(L())try{y(!0),v(null);let t=await D(),r=await t.get_model_weights(e);if("Ok"in r){let t=new Blob([new Uint8Array(r.Ok)]),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}else throw Error("string"==typeof r.Err?r.Err:"Download failed")}catch(e){v(e instanceof Error?e.message:"Failed to download model"),console.error("Download error:",e)}finally{y(!1)}};(0,s.useEffect)(()=>{if(!r){console.error("No identity available"),v("Not authenticated");return}console.log("Current principal:",r.getPrincipal().toString())},[r]),(0,s.useEffect)(()=>{r?(V(!0),console.log("II Identity authenticated:",r.getPrincipal().toString())):V(!1)},[r]),(0,s.useEffect)(()=>{(async()=>{if(r)try{console.log("Environment check:",{host:"http://localhost:4943",canisterId:"be2us-64aaa-aaaaa-qaabq-cai",network:"local",principal:r.getPrincipal().toString()});let e=new l.i7({host:"http://localhost:4943",identity:r});await e.fetchRootKey(),console.log("Agent setup successful")}catch(e){console.error("Setup check failed:",e)}})()},[r]);let J=(0,s.useCallback)(async()=>{try{console.log("Fetching model names...");let e=await D(),t=await e.get_model_names();console.log("Raw response:",t),i(t),v(null)}catch(e){console.error("Error fetching model names:",e),v(e instanceof Error?e.message:"Failed to fetch model names")}},[D]);return(0,s.useEffect)(()=>{r&&_(r.getPrincipal().toString())},[r]),(0,s.useEffect)(()=>{r&&J()},[r,J]),(0,s.useEffect)(()=>{if(r){let e=r.getPrincipal().toString();console.log("Frontend identity principal:",e),console.log("Canister controllers:",{canisterId:"be2us-64aaa-aaaaa-qaabq-cai",myPrincipal:e})}},[r]),(0,s.useEffect)(()=>{(async()=>{t&&(console.log("Is authenticated:",await t.isAuthenticated()),r&&console.log("Principal:",r.getPrincipal().toString()))})()},[t,r]),(0,a.jsxs)("div",{className:"mx-auto max-w-7xl space-y-6 bg-background p-6 text-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"LLM Marketplace"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(C.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:N?"Principal: ".concat(N.slice(0,10),"..."):"Not connected"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(u,{className:"bg-card transition-colors hover:bg-accent/10",children:[(0,a.jsxs)(m,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(f,{className:"text-sm font-medium text-card-foreground",children:"Total Revenue"}),(0,a.jsx)(T.Z,{className:"h-4 w-4 text-primary"})]}),(0,a.jsxs)(x,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-card-foreground",children:["$",45231.89]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"+20.1% from last month"})]})]}),(0,a.jsxs)(u,{className:"bg-card transition-colors hover:bg-accent/10",children:[(0,a.jsxs)(m,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(f,{className:"text-sm font-medium text-card-foreground",children:"Subscriptions"}),(0,a.jsx)(Z.Z,{className:"h-4 w-4 text-primary"})]}),(0,a.jsxs)(x,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-card-foreground",children:["+",2350]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"+180.1% from last month"})]})]}),(0,a.jsxs)(u,{className:"bg-card transition-colors hover:bg-accent/10",children:[(0,a.jsxs)(m,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(f,{className:"text-sm font-medium text-card-foreground",children:"Sales"}),(0,a.jsx)(q.Z,{className:"h-4 w-4 text-primary"})]}),(0,a.jsxs)(x,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-card-foreground",children:["+",12234]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"+19% from last month"})]})]}),(0,a.jsxs)(u,{className:"bg-card transition-colors hover:bg-accent/10",children:[(0,a.jsxs)(m,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(f,{className:"text-sm font-medium text-card-foreground",children:"Active Now"}),(0,a.jsx)(I.Z,{className:"h-4 w-4 text-primary"})]}),(0,a.jsxs)(x,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-card-foreground",children:["+",573]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"+201 since last hour"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,a.jsxs)(u,{className:"bg-card",children:[(0,a.jsx)(m,{children:(0,a.jsx)(f,{className:"text-card-foreground",children:"Upload Model"})}),(0,a.jsx)(x,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(b,{type:"file",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&(h(r),v(null))},disabled:p,className:"text-input-foreground bg-input"}),(0,a.jsxs)(g,{className:"w-full bg-primary text-primary-foreground hover:bg-primary/90",disabled:!c||p,onClick:M,children:[p?(0,a.jsx)(A.Z,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(U.Z,{className:"mr-2 h-4 w-4"}),"Upload Model"]})]})})]}),(0,a.jsxs)(u,{className:"bg-card",children:[(0,a.jsx)(m,{children:(0,a.jsx)(f,{className:"text-card-foreground",children:"Download Model"})}),(0,a.jsx)(x,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(j,{value:o,onValueChange:d,children:[(0,a.jsx)(k,{className:"text-input-foreground bg-input",children:(0,a.jsx)(z,{placeholder:"Select a model"})}),(0,a.jsx)(S,{className:"bg-popover text-popover-foreground",children:n.map(e=>(0,a.jsx)(R,{value:e,className:"hover:bg-accent hover:text-accent-foreground",children:e},e))})]}),(0,a.jsxs)(g,{className:"w-full bg-primary text-primary-foreground hover:bg-primary/90",disabled:!o||p,onClick:()=>B(o),children:[p?(0,a.jsx)(A.Z,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(F.Z,{className:"mr-2 h-4 w-4"}),"Download Model"]})]})})]})]})]})},D=()=>{let e=(0,n.useRouter)(),[t,r]=(0,s.useState)(!1),[l,o]=(0,s.useState)(null),[d,c]=(0,s.useState)(null);return((0,s.useEffect)(()=>{(async()=>{try{let t=await i.LY.create();o(t);let a=await t.isAuthenticated();if(console.log("Dashboard auth check:",a),!a){console.log("User not authenticated, redirecting to login..."),e.push("/");return}r(!0),c(t.getIdentity())}catch(t){console.error("Auth check failed:",t),e.push("/")}})()},[e]),t&&l&&d)?(0,a.jsx)(V,{authClient:l,identity:d}):(0,a.jsx)("div",{children:"Loading..."})}}},function(e){e.O(0,[655,888,774,179],function(){return e(e.s=528)}),_N_E=e.O()}]);